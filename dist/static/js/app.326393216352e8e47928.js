webpackJsonp([1],{NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("7+uW"),a=i("fZjL"),r=i.n(a),n=i("mvHQ"),o=i.n(n),c=i("//Fk"),d=i.n(c),u=i("jTa1"),l=i.n(u),_=void 0,v=void 0,m=void 0,h=void 0,p=void 0,f=void 0,b=void 0,g=!1,C=void 0;function y(t){var e=m.getBoundingClientRect().left,i=m.offsetWidth,s=t.clientX;s<e+100?(f&&(clearInterval(f),f=void 0),!b&&m.scrollLeft&&(b=setInterval(function(){m.scrollBy({left:-100,behavior:"smooth"}),m.scrollLeft||j()},100),m.style.cursor="w-resize")):e+i-s<100?(b&&(clearInterval(b),b=void 0),!f&&m.scrollLeft+m.offsetWidth<_.offsetWidth&&(f=setInterval(function(){m.scrollBy({left:100,behavior:"smooth"}),m.scrollLeft+m.offsetWidth===_.offsetWidth&&j()},100),m.style.cursor="e-resize")):(b&&(clearInterval(b),b=void 0,m.style.cursor="auto"),f&&(clearInterval(f),f=void 0,m.style.cursor="auto"))}function j(){b&&(clearInterval(b),b=void 0,m.style.cursor="auto"),f&&(clearInterval(f),f=void 0,m.style.cursor="auto")}function E(){var t=_.getBoundingClientRect().top;t>0?h.style.display="none":(h.style.display="table",h.style.marginTop=-t+"px")}function x(){if(p){var t=m.scrollLeft;t?(p.style.display="table",p.style.marginLeft=t+"px"):p.style.display="none"}}function w(){v.querySelectorAll("th").forEach(function(t,e){var i=e+1,s=t.offsetWidth+"px";h.querySelector("th:nth-child("+i+")").style.minWidth=s,h.querySelector("th:nth-child("+i+")").style.maxWidth=s})}function $(){var t=document.querySelector("[data-fixed_column]");t&&m.removeChild(t),(p=h.cloneNode(!1)).style.top="10px",p.style.marginTop="0px",p.style.borderRight="1px solid darkgray",p.dataset.fixed_column="fixed_column",p.style.zIndex=10;var e=_.querySelector("tbody");if(e){e=e.cloneNode();var i=h.querySelector("thead").cloneNode(),s=h.querySelector("tr").cloneNode(),a=h.querySelector("th").cloneNode(!0),r=_.querySelector("th");p.style.width=r.offsetWidth+"px";var n=r.offsetHeight+"px";a.style.height=n,a.style.minHeight=n,a.style.maxHeight=n,s.appendChild(a),i.appendChild(s),p.appendChild(i).cloneNode(),_.querySelectorAll("tbody>tr").forEach(function(t,i){var s=i+1,a=t.cloneNode(),r=t.querySelector("td").cloneNode(!0),n=_.querySelector("tbody>tr:nth-child("+s+")>td").offsetHeight+"px";r.style.height=n,r.style.minHeight=n,r.style.maxHeight=n,a.appendChild(r),e.appendChild(a)}),p.appendChild(e),m.appendChild(p)}}function S(){if(_=document.querySelector("table:not([data-fixed_table])"),m=document.querySelector(".table"),C&&C.disconnect(),_&&m){var t=m.querySelector("table[data-fixed_table=fixed_table]");t&&m.removeChild(t),v=_.querySelector("thead"),(h=document.createElement("table")).style.position="absolute",h.style.backgroundColor="white",h.style.display="none",h.style.top="0px",h.style.left="0px",h.style.zIndex=11,h.dataset.fixed_table="fixed_table",h.appendChild(v.cloneNode(!0)),w(),$(),_.style.position="relative",m.removeEventListener("mouseout",j),m.removeEventListener("mousemove",y),window.removeEventListener("scroll",E),window.removeEventListener("resize",E),m.removeEventListener("scroll",x),g||(m.addEventListener("mousemove",y),m.addEventListener("mouseout",j)),window.addEventListener("scroll",E),window.addEventListener("resize",E),m.addEventListener("scroll",x),m.appendChild(h);var e={attributes:!1,childList:!0,subtree:!0};(C=new MutationObserver(function(){C.disconnect(),w(),$(),C.observe(m,e)})).observe(m,e)}}window.addEventListener("touchstart",function t(){g=!0,window.removeEventListener("touchstart",t)});var k={name:"App",data:function(){var t=JSON.parse(localStorage.getItem("token")),e="https://conselho-api.infomec.net.br/";-1!==location.href.indexOf("localhost")&&(e="http://localhost/conselho-server/");var i={resources:["council","council_grade","council_topic","evaluation","grade","grade_subject","grade_observation","medical_report","medical_report_subject","permission","role","role_type","role_type_permission","school","student","student_observation","student_grade","subject","teacher","teacher_request","topic","topic_option","user"],token:t,user:{},current_council:{},notification:{},new_topic_options:[{default:1}],updated_evaluations:"",logged_in:t&&new Date(t.expires_at)>new Date,current_grade_id:"",current_subject_id:"",loading:!0,hide_evaluated_students:!1,db:new l.a("conselho"),api_url:e,current_user_id:void 0};return i.resources.forEach(function(t){i[t+"s"]=[]}),i.db.version(1).stores({councils:"id",council_grades:"id",council_topics:"id",evaluations:"id, [council_id+grade_id], [council_id+grade_id+subject_id]",grades:"id",grade_subjects:"id",grade_observations:"id",medical_reports:"id",medical_report_subjects:"id",permissions:"id",roles:"id",role_types:"id",role_type_permissions:"id",schools:"id",students:"id",student_observations:"id",student_grades:"id",subjects:"id",teachers:"id",teacher_requests:"id",topics:"id",topic_options:"id",users:"id"}),i.db.open().catch(function(t){console.error("Open failed: "+t.stack)}),i},methods:{orderedTopicOptions:function(t){return this.topic_options.filter(function(e){return e.topic_id===t}).sort(function(t,e){return(t=parseInt(t.value))>(e=parseInt(e.value))?-1:t<e?1:0})},activeCouncil:function(t){var e=this.councils.find(function(e){return e.id===t});return new Date(e.start_date)<=new Date&&new Date(e.end_date)>=new Date},role_type:function(t){var e=this.roles.find(function(e){return e.user_id===t&&parseInt(e.approved)});return e?this.role_types.find(function(t){return t.id===e.role_type_id}):{}},userHasPermission:function(t,e){e||(e=this.user.id);var i=this.role_type(e);if(void 0===i.id)return!1;var s=this.permissions.find(function(e){return e.reference===t});return!!this.role_type_permissions.find(function(t){return t.permission_id===s.id&&t.role_type_id===i.id})},reportStudentTopic:function(t,e){var i=this.orderedTopicOptions(e),s=this.evaluations.filter(function(e){return e.student_id===t&&void 0!==i.find(function(t){return t.id===e.topic_option_id})});if(!s.length)return"-";var a=s.map(function(t){return parseInt(i.find(function(e){return e.id===t.topic_option_id}).value)}),r=a.reduce(function(t,e){return t+e}),n=parseInt(r/a.length),o=i.map(function(t){return t.value}),c=parseInt(o.reduce(function(t,e){return Math.abs(e-n)<Math.abs(t-n)?e:t}));return i.find(function(t){return parseInt(t.value)===c}).name+" ("+n+"%)"},studentGrade:function(t){var e=this;return this.student_grades.find(function(i){return parseInt(i.grade_id)===parseInt(e.current_grade_id)&&parseInt(i.student_id)===parseInt(t)})},studentHasEvaluation:function(t){return!!this.evaluations.find(function(e){return e.student_id===t&&e.id})},logout:function(){localStorage.removeItem("token"),localStorage.removeItem("has_loaded_data");var t=this;t.token=void 0,t.logged_in=!1,t.loading=!0;var e=[];t.resources.forEach(function(i){e.push(t.db[i+"s"].clear())}),d.a.all(e).then(function(){t.$router.push("/login"),t.loading=!1}).catch(function(){t.$router.push("/login"),t.loading=!1})},seed:function(){var t=[],e={},i=this;return i.resources.forEach(function(s){if(window.localStorage.getItem("has_loaded_data"))t.push(i.db[s+"s"].toArray().then(function(t){e[s+"s"]=t}));else{var a=i.get_resource(s).then(function(t){return e[s+"s"]=t,i.db[s+"s"].bulkPut(i.parseObjects(t))});t.push(a)}}),d.a.all(t).then(function(){window.localStorage.setItem("has_loaded_data","1");var t=i.$data;if(i.resources.forEach(function(i){t[i+"s"]=e[i+"s"]}),t.user=t.users.find(function(t){return parseInt(t.id)===i.token.user_id}),document.location.pathname.endsWith("evaluate.html")||document.location.pathname.endsWith("report.html")){var s=parseInt(new URL(document.location.href).searchParams.get("id"));t.current_council=t.councils.find(function(t){return t.id===s})}t.loading=!1,i.$data=t})},get_resource:function(t){var e=this;return e.api_fetch(t).then(function(t){return t.json()}).then(function(i){var s=i.results,a=parseInt(i.max_results_per_page),r=parseInt(i.total_results),n=Math.floor(r/a);if(r===a||!n)return s;for(var o=[],c=1;c<=n;c++)o.push(e.api_fetch(t,"GET",{page:c+1}).then(function(t){return t.json()}));return d.a.all(o).then(function(t){return t.forEach(function(t){s=s.concat(t.results)}),s})})},api_fetch:function(t,e,i,s){void 0===e&&(e="GET"),i?i.school_id=1:i={school_id:1},"GET"===e||"DELETE"===e?void 0!==i&&(t+="?"+function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e.join("&")}(i),i=void 0):i=o()(this.parseObject(i)),void 0===s&&(s={}),(s=new Headers(s)).set("Timezone","-03:00"),s.set("Accept","application/json; charset=UTF-8"),s.set("Content-Type","application/json"),!s.has("Token")&&this.token&&this.token.value&&s.set("Token",this.token.value);var a=this.api_url+t;return fetch(a,{headers:s,method:e,mode:"cors",body:i}).then(function(t){if(!t.ok)throw t;return t})},delete_resource:function(t,e,i,s){document.location.hash="",void 0===i&&(i=!0),void 0===s&&(s=!0),this.loading=!0;var a=this;return this.api_fetch(t+"/"+e,"DELETE").then(function(){if(s){var i=a[t+"s"].findIndex(function(t){return parseInt(t.id)===parseInt(e)});a[t+"s"].splice(i,1)}return a.db[t+"s"].delete(e)}).then(function(){i&&(a.loading=!1,a.notify("Sucesso!","Excluído com sucesso","success"))}).catch(function(){i&&(a.loading=!1,a.notify("Erro!","Não foi possível excluir","danger"))})},save_resource:function(t,e,i,s,a){void 0===i&&(i=!0),i&&void 0===s&&(s=!0);var r=t,n="POST";e.id?(r+="/"+e.id,n="PATCH"):delete e.id;var o=this;return this.api_fetch(r,n,e,a).then(function(t){return t.json()}).then(function(a){if(a.id&&(e.id=parseInt(a.id)),a.created_at&&(e.created_at=a.created_at),a.updated_at&&(e.updated_evaluations=a.updated_at),s&&"POST"===n)o[t+"s"].push(e);else if(s&&"PATCH"===n){var r=o[t+"s"].findIndex(function(t){return parseInt(t.id)===parseInt(e.id)});void 0!==r?o[t+"s"][r]=e:o[t+"s"].push(e)}if(i)return o.db[t+"s"].put(e)}).then(function(){return e})},load_from_api:function(){this.loading=!0;var t=[],e={},i=this;return i.resources.forEach(function(s){var a=i.get_resource(s).then(function(t){return e[s+"s"]=t,i.db[s+"s"].bulkPut(i.parseObjects(t))});t.push(a)}),d.a.all(t).then(function(){window.localStorage.setItem("has_loaded_data",!0);var t=i.$data;i.resources.forEach(function(i){"evaluation"!==i&&(t[i+"s"]=e[i+"s"])}),t.user=t.users.find(function(t){return parseInt(t.id)===i.token.user_id}),i.$data=t}).catch(function(t){i.notify("Erro!","Ocorreu um erro durante a atualização. Tente novamente!","danger"),console.log("Error:",t)}).finally(function(){i.loading=!1})},notify:function(t,e,i,s){void 0===s&&(s=5e3),void 0===i&&(i="info");var a=void 0;"success"===i?a="check":"danger"===i?a="close":"warning"===i?a="warning":"info"!==i&&"primary"!==i||(a="info");var n=Date.now().toString();document.getElementById("no-notification").checked=!0;var o=this,c=r()(o.notification).length>0?500:0;setTimeout(function(){o.notification={style:i,icon:a,title:t,message:e,timestamp:n},document.getElementById("notification-shown").checked=!0,setTimeout(function(){o.notification.timestamp===n&&(document.getElementById("no-notification").checked=!0,setTimeout(function(){o.notification.timestamp===n&&(o.notification={})},500))},s)},c)},parseObject:function(t){return r()(t).forEach(function(e){null!==t[e]&&void 0!==t[e]&&(t[e].toString()===parseInt(t[e]).toString()?t[e]=parseInt(t[e]):t[e].toString()===parseFloat(t[e]).toString()?t[e]=parseFloat(t[e]):t[e]===!!t[e]&&(t[e]=t[e]?1:0))}),t},parseObjects:function(t){var e=this;return t.map(function(t){return e.parseObject(t)})},filter_evaluations:function(){var t=this,e="Evaluation"===t.$route.name;if(t.current_grade_id&&t.current_council&&t.current_council.id&&(!e||t.current_subject_id)){var i=void 0,s=void 0;return t.current_subject_id?(i="[council_id+grade_id+subject_id]",s=[t.current_council.id,t.current_grade_id,t.current_subject_id]):(i="[council_id+grade_id]",s=[t.current_council.id,t.current_grade_id]),t.loading=!0,t.db.evaluations.where(i).equals(s).toArray().then(function(i){if(e){i=i.filter(function(e){return e.user_id===t.user.id}).map(function(e){var i=t.topic_options.find(function(t){return t.id===e.topic_option_id});return e.topic_id=i.topic_id,e});var s=[];t.studentsInGrade.forEach(function(e){t.councilTopics.forEach(function(a){i.find(function(t){return t.student_id===e.id&&t.topic_id===a.id})||s.push({student_id:e.id,topic_id:a.id,topic_option_id:a.topic_option_id,council_id:t.current_council.id,user_id:t.user.id,grade_id:t.current_grade_id,subject_id:t.current_subject_id})})}),i=i.concat(s)}t.evaluations=i,t.loading=!1,S()})}this.evaluations=[]}},watch:{current_grade_id:function(t){var e=this;if("Evaluation"===e.$route.name){var i=e.teachers.filter(function(i){return i.user_id===e.user.id&&i.grade_id===t});1===i.length?e.current_subject_id=i[0].subject_id:e.current_subject_id=""}},current_subject_id:function(){"Evaluation"===this.$route.name&&this.filter_evaluations()}},computed:{activeCouncils:function(){return this.councils.filter(function(t){return new Date(t.start_date)<=new Date&&new Date(t.end_date)>=new Date})},studentsInGrade:function(){var t=this;if(this.current_grade_id)return this.students.filter(function(e){return void 0!==t.studentGrade(e.id)}).sort(function(e,i){return(e=t.studentGrade(e.id).number)<(i=t.studentGrade(i.id).number)?-1:e>i?1:0})},currentGrade:function(){var t=this;if(this.current_grade_id)return this.grades.find(function(e){return parseInt(e.id)===parseInt(t.current_grade_id)})},councilTopics:function(){var t=this;return this.topics.filter(function(e){return void 0!==t.council_topics.find(function(i){return i.topic_id===e.id&&i.council_id===t.current_council.id})})},subjectsInGrade:function(){var t=this;if(this.current_grade_id)return this.subjects.filter(function(e){return t.grade_subjects.find(function(i){return i.subject_id===e.id&&i.grade_id===t.current_grade_id})})},gradeObservations:function(){var t=this;if(this.current_grade_id)return this.grade_observations.filter(function(e){return parseInt(e.grade_id)===parseInt(t.current_grade_id)&&parseInt(e.council_id)===parseInt(t.current_council.id)&&e.description.length&&(!t.current_subject_id||parseInt(e.subject_id)===parseInt(t.current_subject_id))})},orderedUsers:function(){return this.users.sort(function(t,e){return t.name.localeCompare(e.name,"pt-BR",{ignorePunctuation:!0})})}},created:function(){if(!this.logged_in&&"Login"!==this.$route.name)return this.$router.push("/login"),void(this.loading=!1);this.seed()}},q={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[t._m(0),t._v(" "),i("header",{staticClass:"header"},[i("router-link",{staticClass:"header-button main-button",attrs:{to:{name:"Index"}}},[t._v("Conselho")]),t._v(" "),t.logged_in?[t.logged_in?i("a",{staticClass:"header-button menu-toggle material-icons",attrs:{href:"#menu"}},[t._v("menu")]):t._e(),t._v(" "),i("button",{staticClass:"header-button material-icons",attrs:{type:"button"},on:{click:t.load_from_api}},[t._v("sync")]),t._v(" "),t.userHasPermission("role")?i("div",{staticClass:"header-pane"},[i("button",{staticClass:"header-button material-icons",attrs:{type:"button"}},[t._v("\n          notifications\n          "),t.teacher_requests.length?i("span",{staticClass:"header-button-label-red"},[t._v(t._s(t.teacher_requests.length))]):t._e()]),t._v(" "),i("div",{staticClass:"header-pane-popup"},[t._m(1),t._v(" "),i("div",{staticClass:"header-pane-body"},[t._l(t.teacher_requests,function(e,s){return i("div",{key:e.id},[s?i("hr",{staticClass:"margin-h-15"}):t._e(),t._v(" "),i("router-link",{staticClass:"no-link",attrs:{to:{name:"Teacher"}}},[i("div",{staticClass:"header-notification-title"},[i("b",[t._v(t._s(t.users.find(function(t){return t.id===e.user_id}).name))]),t._v(" aguarda sua aprovação")]),t._v(" "),i("div",{staticClass:"header-notification-description"},[t._v(t._s(t.grades.find(function(t){return t.id===e.grade_id}).name)+" - "+t._s(t.subjects.find(function(t){return t.id===e.subject_id}).name)+"\n                  "),i("div",{staticClass:"text-muted"},[t._v(t._s(new Date(e.created_at).toLocaleDateString("pt-BR")))])])])],1)}),t._v(" "),t.teacher_requests.length?t._e():i("div",{staticClass:"text-center text-muted"},[i("br"),i("br"),t._v(" "),i("div",{staticClass:"h5"},[t._v("Não há notificações")]),i("br"),i("br")])],2)])]):t._e(),t._v(" "),i("div",{staticClass:"header-pane"},[i("button",{staticClass:"header-button",attrs:{type:"button"}},[t._v(t._s(t.user?t.user.name:""))]),t._v(" "),i("div",{staticClass:"header-pane-popup"},[i("div",{staticClass:"header-pane-body text-center bg-primary text-white"},[i("br"),t._v(" "),t._m(2),t._v(" "),i("div",{staticClass:"text-20"},[t._v(t._s(t.user?t.user.name:""))]),i("br"),i("br")]),t._v(" "),i("div",{staticClass:"header-pane-footer"},[i("router-link",{staticClass:"btn-default btn-sm",attrs:{to:{name:"User"}}},[t._v("Usuário")]),t._v(" "),i("button",{staticClass:"btn-default btn-sm pull-right",attrs:{type:"button"},on:{click:t.logout}},[t._v("Sair")])],1)])])]:t._e()],2),t._v(" "),i("div",{staticClass:"container"},[t.logged_in?i("nav",{staticClass:"menu",attrs:{id:"menu"}},[i("a",{staticClass:"menu-close header-button material-icons",attrs:{href:"#"}},[t._v("menu")]),t._v(" "),i("router-link",{staticClass:"menu-link",attrs:{to:{name:"Index"},"active-class":"menu-active",exact:""}},[i("i",{staticClass:"material-icons"},[t._v("home")]),t._v(" Página Inicial\n      ")]),t._v(" "),t.userHasPermission("subject")?i("router-link",{staticClass:"menu-link",attrs:{to:{name:"Subject"},"active-class":"menu-active"}},[i("i",{staticClass:"material-icons"},[t._v("book")]),t._v(" Disciplinas\n      ")]):t._e(),t._v(" "),t.userHasPermission("topic")?i("router-link",{staticClass:"menu-link",attrs:{to:{name:"Topic"},"active-class":"menu-active"}},[i("i",{staticClass:"material-icons"},[t._v("list")]),t._v(" Tópicos\n      ")]):t._e(),t._v(" "),t.userHasPermission("grade")?i("router-link",{staticClass:"menu-link",attrs:{to:{name:"Grade"},"active-class":"menu-active"}},[i("i",{staticClass:"material-icons"},[t._v("people")]),t._v(" Turmas\n      ")]):t._e(),t._v(" "),t.userHasPermission("council")?i("router-link",{staticClass:"menu-link",attrs:{to:{name:"Council"},"active-class":"menu-active"}},[i("i",{staticClass:"material-icons"},[t._v("edit")]),t._v(" Conselhos de Classe\n      ")]):t._e(),t._v(" "),t.userHasPermission("role")?i("router-link",{staticClass:"menu-link",attrs:{to:{name:"Role"},"active-class":"menu-active"}},[i("i",{staticClass:"material-icons"},[t._v("supervisor_account")]),t._v(" Usuários\n      ")]):t._e(),t._v(" "),t.userHasPermission("teacher")?i("router-link",{staticClass:"menu-link",attrs:{to:{name:"Teacher"},"active-class":"menu-active"}},[i("i",{staticClass:"material-icons"},[t._v("supervisor_account")]),t._v(" Professores\n      ")]):t._e(),t._v(" "),t.userHasPermission("evaluate")?[i("router-link",{staticClass:"menu-link",attrs:{to:{name:"TeacherRequest"},"active-class":"menu-active"}},[i("i",{staticClass:"material-icons"},[t._v("people")]),t._v(" Turmas\n        ")]),t._v(" "),t._l(t.activeCouncils,function(e){return i("router-link",{key:e.id,staticClass:"menu-link",attrs:{to:{name:"Evaluate",params:{id:e.id}},"active-class":"menu-active"}},[i("i",{staticClass:"material-icons"},[t._v("edit")]),t._v(" "+t._s(e.name)+"\n        ")])})]:t._e()],2):t._e(),t._v(" "),i("main",{staticClass:"content mark-required selection-primary"},[i("router-view")],1)]),t._v(" "),i("input",{staticClass:"notification-toggle notification-start-hidden",attrs:{type:"radio",name:"notification-toggle",checked:""}}),t._v(" "),i("input",{staticClass:"notification-toggle",attrs:{type:"radio",name:"notification-toggle",id:"no-notification"}}),t._v(" "),i("input",{staticClass:"notification-toggle",attrs:{type:"radio",name:"notification-toggle",id:"notification-shown"}}),t._v(" "),Object.keys(t.notification).length>0?i("div",{staticClass:"notification",class:"notification-"+t.notification.style},[i("label",{staticClass:"notification-dismiss material-icons",attrs:{for:"no-notification"}},[t._v("close")]),t._v(" "),void 0!==t.notification.icon?i("div",{staticClass:"notification-icon material-icons"},[t._v(t._s(t.notification.icon))]):t._e(),t._v(" "),i("div",{staticClass:"notification-title"},[t._v(t._s(t.notification.title))]),t._v(t._s(t.notification.message)+"\n  ")]):t._e(),t._v(" "),t.loading?i("div",{attrs:{id:"loading"}},[i("div",{staticClass:"material-icons"},[t._v("sync")])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("form",{attrs:{id:"form-valid-support-helper"}},[e("input",{attrs:{required:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header-pane-header"},[e("i",{staticClass:"material-icons"},[this._v("notifications")]),this._v("Notificações")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-80"},[e("i",{staticClass:"material-icons user-icon"},[this._v("account_circle")])])}]};var I=i("VU/8")(k,q,!1,function(t){i("VOiu"),i("wrcB"),i("cMOQ")},null,null).exports,D=i("/ocq"),N={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("home")]),this._v("Página Inicial")])])])])}]},P=i("VU/8")({name:"Index"},N,!1,null,null,null).exports,T={name:"Login",data:function(){return this.$parent.$data},methods:{login:function(t){var e=this,i=this.$parent,s=new Headers;s.set("Timezone","-03:00"),s.set("Accept","application/json; charset=UTF-8"),s.set("Content-Type","application/json");var a={};new FormData(t.target).forEach(function(t,e){a[e]=t});var r=i.api_url+"user_token",n={headers:s,method:"POST",mode:"cors",body:o()(a)};return i.loading=!0,fetch(r,n).then(function(t){if(!t.ok)throw alert("Não foi possível fazer login. Tente novamente!"),t;return t.json()}).then(function(t){localStorage.setItem("token",o()(t)),i.token=t,i.logged_in=!0,e.logged_in=!0,e.$forceUpdate(),i.seed().then(function(){i.$router.push("/"),i.loading=!1})}).catch(function(){i.loading=!1})}}},A={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.logged_in?t._e():i("div",[t._m(0),t._v(" "),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-12 col-sm-10 col-md-8 col-lg-7 col-xlg-6"},[i("article",{staticClass:"box"},[i("div",{staticClass:"box-body"},[i("form",{attrs:{action:"#",method:"POST"},on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[i("br"),t._v(" "),t._m(1),i("br")])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("lock")]),this._v("Login")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-11"},[i("div",{staticClass:"input"},[i("input",{attrs:{name:"email",required:"",type:"email",id:"email"}}),t._v(" "),i("label",{attrs:{for:"email"}},[i("div",{staticClass:"material-icons"},[t._v("email")]),t._v(" E-mail\n                  ")])]),t._v(" "),i("div",{staticClass:"input"},[i("input",{attrs:{name:"password",required:"",type:"password",id:"password"}}),t._v(" "),i("label",{attrs:{for:"password"}},[i("div",{staticClass:"material-icons"},[t._v("vpn_key")]),t._v(" Senha\n                  ")])]),t._v(" "),i("div",{staticClass:"text-right"},[i("button",{staticClass:"btn-success btn-lg",attrs:{type:"submit"}},[i("div",{staticClass:"material-icons"},[t._v("check")]),t._v(" Entrar\n                  ")])])])])}]},U=i("VU/8")(T,A,!1,null,null,null).exports,R={name:"TeacherRequest",data:function(){return this.$parent.$data},methods:{teacher_request_save:function(t){t.preventDefault();var e=this.$parent;e.loading=!0;var i=t.target,s={grade_id:i.querySelector("[name=grade_id]").value,subject_id:i.querySelector("[name=subject_id]").value,user_id:e.user.id};e.save_resource("teacher_request",s).then(function(){e.loading=!1,e.current_grade_id="",e.current_subject_id="",e.notify("Sucesso!",i.dataset.success,"success")}).catch(function(t){e.loading=!1,console.log("Error:",t),e.notify("Erro!",i.dataset.error,"danger")})},teacher_request_delete:function(t){this.$parent.delete_resource("teacher_request",t)}},created:function(){this.current_grade_id="",this.current_subject_id=""}},O={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._m(0),t._v(" "),i("article",{staticClass:"box"},[i("div",{staticClass:"box-body"},[i("br"),t._v(" "),i("form",{attrs:{action:"#","data-success":"Aguardando a aprovação do supervisor!","data-error":"Não foi possível cadastrar"},on:{submit:function(e){return e.preventDefault(),t.teacher_request_save(e)}}},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-12 col-md-9"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"input col-6 col-sm-4"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.current_grade_id,expression:"current_grade_id"}],attrs:{id:"current_grade_id",name:"grade_id",required:""},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_grade_id=e.target.multiple?i:i[0]}}},[i("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.grades,function(e){return i("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),i("label",{attrs:{for:"current_grade_id"}},[t._v("Turma")])]),t._v(" "),i("div",{staticClass:"input col-6 col-sm-4"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.current_subject_id,expression:"current_subject_id"}],attrs:{id:"current_subject_id",name:"subject_id",required:"",disabled:!t.current_grade_id},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_subject_id=e.target.multiple?i:i[0]}}},[i("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v(t._s(t.current_grade_id?"Selecione...":"Selecione a turma..."))]),t._v(" "),t._l(t.subjects,function(e){return t.current_grade_id&&void 0!==t.grade_subjects.find(function(i){return i.subject_id===e.id&&i.grade_id===t.current_grade_id})?i("option",{key:e.id,attrs:{disabled:void 0!==t.teachers.find(function(i){return i.grade_id===t.current_grade_id&&i.subject_id===e.id})},domProps:{value:e.id}},[t._v(t._s(e.name))]):t._e()})],2),t._v(" "),i("label",{attrs:{for:"current_subject_id"}},[t._v("Disciplina")])]),t._v(" "),t._m(1)])])])]),i("br"),t._v(" "),void 0!==t.teachers.find(function(e){return e.user_id===t.user.id})||void 0!==t.teacher_requests.find(function(e){return e.user_id===t.user_id})?i("table",{staticClass:"table"},[t._m(2),t._v(" "),i("tbody",[t._l(t.teacher_requests,function(e){return e.user_id===t.user.id?i("tr",{key:e.id},[i("td",[t._v(t._s(t.grades.find(function(t){return t.id===e.grade_id}).name))]),t._v(" "),i("td",[t._v(t._s(t.subjects.find(function(t){return t.id===e.subject_id}).name))]),t._v(" "),i("td",{staticClass:"text-muted"},[t._v("Aguardando aprovação")]),t._v(" "),i("td",{staticClass:"text-right no-wrap"},[i("a",{staticClass:"btn-danger btn-sm tooltip tooltip-end",attrs:{href:"#modal-delete-teacher_request-"+e.id,title:"Remover"}},[i("div",{staticClass:"material-icons"},[t._v("delete")]),i("span",{staticClass:"d-none d-md-inline"},[t._v(" Remover")])])])]):t._e()}),t._v(" "),t._l(t.teachers,function(e){return e.user_id===t.user.id?i("tr",{key:e.id},[i("td",[t._v(t._s(t.grades.find(function(t){return t.id===e.grade_id}).name))]),t._v(" "),i("td",[t._v(t._s(t.subjects.find(function(t){return t.id===e.subject_id}).name))]),t._v(" "),i("td"),t._v(" "),t._m(3,!0)]):t._e()})],2)]):i("div",{staticClass:"text-center text-muted"},[i("br"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Você ainda não está vinculado à nenhuma turma.")]),t._v(" "),t._m(4),i("br")])])]),t._v(" "),t._m(5),i("a",{staticClass:"modal-close",attrs:{href:"#"}}),t._v(" "),t._l(t.teacher_requests,function(e){return i("div",{key:e.id},[i("div",{staticClass:"modal modal-xs modal-danger",attrs:{id:"modal-delete-teacher_request-"+e.id}},[i("div",{staticClass:"modal-header"},[t._v("Remover solicitação")]),t._v(" "),t._m(6,!0),t._v(" "),i("div",{staticClass:"modal-footer"},[t._m(7,!0),t._v(" "),i("button",{staticClass:"btn-danger btn-sm pull-right",on:{click:function(i){t.teacher_request_delete(e.id)}}},[i("div",{staticClass:"material-icons"},[t._v("check")]),t._v("  Remover\n        ")])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}})])})],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("people")]),this._v("Turmas")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-12 col-sm-3"},[e("br",{staticClass:"d-none d-sm-inline"}),this._v(" "),e("button",{staticClass:"btn-success",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v(" Salvar\n                ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Turma")]),this._v(" "),e("th",[this._v("Disciplina")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("td",{staticClass:"text-right no-wrap"},[e("a",{staticClass:"btn-danger btn-sm tooltip tooltip-end",attrs:{href:"#modal-delete-teacher",title:"Remover"}},[e("div",{staticClass:"material-icons"},[this._v("delete")]),e("span",{staticClass:"d-none d-md-inline"},[this._v(" Remover")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Selecione uma turma e uma disciplina e clique em "),e("b",[this._v("salvar")]),this._v(" para poder avaliar.")])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"modal modal-xs modal-danger",attrs:{id:"modal-delete-teacher"}},[i("div",{staticClass:"modal-header"},[t._v("Fale com o supervisor")]),t._v(" "),i("div",{staticClass:"modal-body"},[i("p",[t._v("Você não pode se desvincular desta turma, pois já recebeu a aprovação do supervisor.")]),t._v(" "),i("p",[t._v("Caso seja realmente necessário, solicite ao supervisor que te desvincule.")])]),t._v(" "),i("div",{staticClass:"modal-footer text-right"},[i("a",{staticClass:"btn-danger btn-sm",attrs:{href:"#"}},[i("div",{staticClass:"material-icons"},[t._v("check")]),t._v("  Entendi")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-body"},[e("p",[this._v("Tem certeza que deseja remover esta solicitação?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-primary btn-sm",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])}]},G=i("VU/8")(R,O,!1,null,null,null).exports,H={name:"Subject",data:function(){return this.$parent.$data},methods:{subject_save:function(t){t.preventDefault();var e=this.$parent;e.loading=!0,document.location.hash="";var i=t.target,s=e.parseObject({name:i.querySelector("[name=name]").value,active:!0});return e.save_resource("subject",s).then(function(){e.loading=!1,e.notify("Sucesso!",i.dataset.success,"success")}).catch(function(t){e.loading=!1,console.log("Error:",t),e.notify("Erro!",i.dataset.error,"danger")})},subject_update:function(t){t.preventDefault();var e=this,i=this.$parent;i.loading=!0,document.location.hash="";var s=t.target,a=i.parseObject({id:s.querySelector("[name=id]").value,name:s.querySelector("[name=name]").value,active:!!s.querySelector("[name=active]").checked});return i.save_resource("subject",a).then(function(){i.loading=!1,i.notify("Sucesso!",s.dataset.success,"success"),e.$forceUpdate()}).catch(function(t){i.loading=!1,console.log("Error:",t),i.notify("Erro!",s.dataset.error,"danger"),e.$forceUpdate()})}}},L={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._m(0),t._v(" "),i("article",{staticClass:"box"},[i("div",{staticClass:"box-body"},[t.subjects.length?i("table",{staticClass:"table"},[t._m(1),t._v(" "),i("tbody",t._l(t.subjects,function(e){return i("tr",{key:e.id},[i("td",{class:parseInt(e.active)?"":"text-muted"},[t._v("\n              "+t._s(e.name)+" "),parseInt(e.active)?t._e():i("span",{staticClass:"text-muted"},[t._v("(invisível)")])]),t._v(" "),i("td",{staticClass:"text-right no-wrap"},[i("a",{staticClass:"btn-warning btn-sm tooltip tooltip-end",attrs:{href:"#modal-edit-"+e.id,title:"Editar disciplina"}},[i("div",{staticClass:"material-icons"},[t._v("edit")]),t._v(" "),i("span",{staticClass:"d-none d-md-inline"},[t._v("Editar")])])])])}))]):i("div",{staticClass:"text-center text-muted"},[i("br"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Ainda não há nenhuma disciplina cadastrada")]),i("br")])])]),t._v(" "),i("div",{staticClass:"modal",attrs:{id:"modal-new"}},[i("div",{staticClass:"modal-header"},[t._v("Nova disciplina")]),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-11"},[i("form",{attrs:{action:"#","data-success":"Disciplina cadastrada com sucesso","data-error":"Não foi possível cadastrar a disciplina"},on:{submit:function(e){return e.preventDefault(),t.subject_save(e)}}},[i("input",{attrs:{type:"hidden",name:"active",value:"1"}}),i("br"),t._v(" "),t._m(2),t._v(" "),i("br"),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),i("br")])])])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}}),t._v(" "),t._l(t.subjects,function(e){return i("div",{key:e.id},[i("div",{staticClass:"modal",attrs:{id:"modal-edit-"+e.id}},[i("div",{staticClass:"modal-header"},[t._v("Editar disciplina")]),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-11"},[i("form",{attrs:{action:"#","data-success":"Disciplina editada com sucesso","data-error":"Não foi possível editar a disciplina"},on:{submit:function(e){return e.preventDefault(),t.subject_update(e)}}},[i("input",{attrs:{type:"hidden",name:"id"},domProps:{value:e.id}}),i("br"),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"input col-12 col-sm-8"},[i("input",{attrs:{required:"",name:"name",placeholder:"Ex.: Matemática"},domProps:{value:e.name}}),t._v(" "),i("label",[t._v("Nome")])]),t._v(" "),i("div",{staticClass:"col-12 col-sm-4"},[i("label",[i("br"),t._v(" "),i("input",{attrs:{name:"active",type:"checkbox"},domProps:{value:1,checked:parseInt(e.active)}}),t._v("Visível\n                  ")])])]),t._v(" "),i("br"),t._v(" "),t._m(5,!0),t._v(" "),t._m(6,!0),i("br")])])])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}})])})],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("book")]),this._v("Disciplinas")])]),this._v(" "),e("div",{staticClass:"col text-right"},[e("a",{staticClass:"btn-success btn-sm no-wra",attrs:{href:"#modal-new"}},[e("div",{staticClass:"material-icons"},[this._v("add")]),this._v(" Criar nova disciplina")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input"},[e("input",{attrs:{required:"",name:"name",placeholder:"Ex.: Matemática"}}),this._v(" "),e("label",[this._v("Nome")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-danger",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v(" Cancelar\n            ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v("  Salvar\n            ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-danger",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v(" Cancelar\n              ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v("  Salvar\n              ")])}]},F=i("VU/8")(H,L,!1,null,null,null).exports,V={name:"Topic",data:function(){var t=this.$parent.$data;return t.orderedTopicOptions=this.$parent.orderedTopicOptions,t},methods:{topic_save:function(t){t.preventDefault();var e=this,i=this.$parent;document.location.hash="",i.loading=!0;var s=t.target,a={name:s.querySelector("[name=name]").value,active:!0,topic_option_id:null},r=s.querySelectorAll('[name="option_name[]"]'),n=[].map.call(r,function(t){return t.value}),o=s.querySelectorAll('[name="option_value[]"]'),c=[].map.call(o,function(t){return t.value}),u=s.querySelectorAll("[name=option_default]"),l=[].map.call(u,function(t){return t.checked}).indexOf(!0),_=[];return n.forEach(function(t,e){_.push({name:t,value:c[e],active:!0})}),i.save_resource("topic",a,!0,!1).then(function(t){a.id=t.id;var e=[];return _.forEach(function(s){s.topic_id=t.id,e.push(i.save_resource("topic_option",s,!0,!1))}),d.a.all(e)}).then(function(t){if(-1!==l)return a.topic_option_id=t[l].id,i.save_resource("topic",a)}).then(function(){return d.a.all([i.db.topics.toArray().then(function(t){return i.topics=t}),i.db.topic_options.toArray().then(function(t){return i.topic_options=t})])}).then(function(){i.loading=!1,i.notify("Sucesso!",s.dataset.success,"success"),e.$forceUpdate()}).catch(function(t){i.loading=!1,console.log("Error:",t),i.notify("Erro!",s.dataset.error,"danger"),e.$forceUpdate()})},topic_update:function(t){t.preventDefault();var e=this,i=this.$parent;document.location.hash="",i.loading=!0;var s=t.target,a=s.querySelectorAll('[name="option_id[]"]'),r=[].map.call(a,function(t){return t.value}),n=s.querySelectorAll('[name="option_name[]"]'),o=[].map.call(n,function(t){return t.value}),c=s.querySelectorAll('[name="option_value[]"]'),u=[].map.call(c,function(t){return t.value}),l=s.querySelectorAll("[name=option_default]"),_=[].map.call(l,function(t){return t.checked}).indexOf(!0),v={id:s.querySelector("[name=id]").value,name:s.querySelector("[name=name]").value,active:s.querySelector("[name=active]").checked,topic_option_id:r[_]?r[_]:null},m=[];return o.forEach(function(t,e){m.push({id:r[e],name:t,value:u[e],active:!0,topic_id:v.id})}),i.save_resource("topic",v,!0,!1).then(function(){var t=[];return m.forEach(function(e){t.push(i.save_resource("topic_option",e,!0,!1))}),d.a.all(t)}).then(function(){return d.a.all([i.db.topics.toArray().then(function(t){return i.topics=t}),i.db.topic_options.toArray().then(function(t){return i.topic_options=t})])}).then(function(){i.loading=!1,i.notify("Sucesso!",s.dataset.success,"success"),e.$forceUpdate()}).catch(function(t){i.loading=!1,console.log("Error:",t),i.notify("Erro!",s.dataset.error,"danger"),e.$forceUpdate()})}}},z={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._m(0),t._v(" "),i("article",{staticClass:"box"},[i("div",{staticClass:"box-body"},[t.topics.length?i("table",{staticClass:"table"},[t._m(1),t._v(" "),i("tbody",t._l(t.topics,function(e){return i("tr",{key:e.id},[i("td",{class:parseInt(e.active)?"":"text-muted"},[t._v("\n            "+t._s(e.name)+"\n            "),parseInt(e.active)?t._e():i("span",{staticClass:"text-muted"},[t._v("(invisível)")])]),t._v(" "),i("td",{staticClass:"text-right no-wrap"},[i("a",{staticClass:"btn-warning btn-sm tooltip tooltip-end",attrs:{href:"#modal-"+e.id,title:"Editar tópico e suas opções de resposta"}},[i("div",{staticClass:"material-icons"},[t._v("edit")]),t._v(" "),i("span",{staticClass:"d-none d-md-inline"},[t._v("Editar")])])])])}))]):i("div",{staticClass:"text-center text-muted"},[i("br"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Ainda não há nenhum tópico cadastrado")]),i("br")])])]),t._v(" "),i("div",{staticClass:"modal",attrs:{id:"modal-new"}},[i("div",{staticClass:"modal-header"},[t._v("Criar novo tópico")]),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-11"},[i("form",{attrs:{action:"#","data-success":"Tópico cadastrado com sucesso","data-error":"Não foi possível cadastrar o tópico"},on:{submit:function(e){return e.preventDefault(),t.topic_save(e)}}},[i("br"),t._v(" "),t._m(2),t._v(" "),i("hr"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Opções de resposta")]),t._v(" "),i("table",{staticClass:"table"},[t._m(3),t._v(" "),i("tbody",t._l(t.new_topic_options,function(e,s){return i("tr",{key:e.id},[i("td",[i("div",{staticClass:"input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"topic_option.name"}],staticStyle:{margin:"0px"},attrs:{required:"",placeholder:"Ex.: Excelente",name:"option_name[]",minlength:"3"},domProps:{value:e.name},on:{input:function(i){i.target.composing||t.$set(e,"name",i.target.value)}}})])]),t._v(" "),i("td",[i("div",{staticClass:"input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"topic_option.value"}],staticStyle:{margin:"0px"},attrs:{required:"",type:"number",min:"0",max:"100",placeholder:"0 - 100",name:"option_value[]"},domProps:{value:e.value},on:{input:function(i){i.target.composing||t.$set(e,"value",i.target.value)}}})])]),t._v(" "),i("td",{staticClass:"text-center"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.default,expression:"topic_option.default"}],attrs:{type:"radio",name:"option_default",value:"1",required:""},domProps:{checked:t._q(e.default,"1")},on:{change:function(i){t.$set(e,"default","1")}}})]),t._v(" "),i("td",{staticClass:"text-right",staticStyle:{"margin-top":"-2px"}},[i("button",{staticClass:"btn-danger tooltip tooltip-end",staticStyle:{margin:"0px 2px"},attrs:{title:"Remover opção de resposta",disabled:t.new_topic_options.length<=2,type:"button"},on:{click:function(e){t.new_topic_options.splice(s,1)}}},[i("div",{staticClass:"material-icons"},[t._v("delete")]),i("span",{staticClass:"d-none d-md-inline"},[t._v(" Remover")])])])])}))]),t._v(" "),i("div",{staticClass:"text-center"},[i("button",{staticClass:"btn-primary tooltip",attrs:{title:"Criar uma nova opção de resposta para este tópico",type:"button"},on:{click:function(e){t.new_topic_options.push({})}}},[i("div",{staticClass:"material-icons"},[t._v("add")]),t._v("Criar nova opção\n              ")])]),i("br"),i("br"),t._m(4),t._v(" "),t._m(5),i("br")])])])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}}),t._v(" "),t._l(t.topics,function(e){return i("div",{key:e.id},[i("div",{staticClass:"modal",attrs:{id:"modal-"+e.id}},[i("div",{staticClass:"modal-header"},[t._v("Editar tópico")]),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-11"},[i("form",{attrs:{action:"#","data-success":"Tópico editado com sucesso","data-error":"Não foi possível editar o tópico"},on:{submit:function(e){return e.preventDefault(),t.topic_update(e)}}},[i("input",{attrs:{type:"hidden",name:"id"},domProps:{value:e.id}}),i("br"),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-8"},[i("div",{staticClass:"input"},[i("input",{attrs:{required:"",placeholder:"Ex.: Tarefas de casa",name:"name",minlength:"3"},domProps:{value:e.name}}),t._v(" "),i("label",[t._v("Nome")])])]),t._v(" "),i("div",{staticClass:"col-4"},[i("br"),t._v(" "),i("label",[i("input",{attrs:{type:"checkbox",name:"active",value:"1"},domProps:{checked:parseInt(e.active)}}),t._v(" Visível\n                  ")])])]),t._v(" "),i("hr"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Opções de resposta")]),t._v(" "),i("table",{staticClass:"table"},[t._m(6,!0),t._v(" "),i("tbody",t._l(t.orderedTopicOptions(e.id),function(s){return i("tr",{key:s.id},[i("td",[i("input",{attrs:{type:"hidden",name:"option_id[]"},domProps:{value:s.id}}),t._v(" "),i("div",{staticClass:"input"},[i("input",{staticStyle:{margin:"0px"},attrs:{required:"",placeholder:"Ex.: Excelente",name:"option_name[]",minlength:"3"},domProps:{value:s.name}})])]),t._v(" "),i("td",[i("div",{staticClass:"input"},[i("input",{staticStyle:{margin:"0px"},attrs:{required:"",type:"number",min:"0",max:"100",placeholder:"0 - 100",name:"option_value[]"},domProps:{value:s.value}})])]),t._v(" "),i("td",{staticClass:"text-center"},[i("input",{attrs:{type:"radio",name:"option_default",value:"1",required:""},domProps:{checked:e.topic_option_id===s.id}})])])}))]),t._v(" "),i("div",{staticClass:"text-center"},[i("button",{staticClass:"btn-primary tooltip",attrs:{type:"button",title:"Criar uma nova opção de resposta para este tópico"},on:{click:function(i){t.topic_options.push({topic_id:e.id})}}},[i("div",{staticClass:"material-icons"},[t._v("add")]),t._v("Criar nova opção\n                ")])]),i("br"),i("br"),t._m(7,!0),t._v(" "),t._m(8,!0),i("br")])])])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}}),t._v(" "),i("div",{staticClass:"modal modal-xs",class:e.active?"modal-danger":"modal-success",attrs:{id:"modal-visibility-"+e.id}},[i("div",{staticClass:"modal-header"},[t._v(t._s(e.active?"Esconder":"Mostrar")+" tópico")]),t._v(" "),i("div",{staticClass:"modal-body"},[i("p",[t._v("Tem certeza que deseja "+t._s(e.active?"esconder":"mostrar")+" este tópico na criação dos conselhos de classe?")])]),t._v(" "),i("div",{staticClass:"modal-footer"},[t._m(9,!0),e.active?i("a",{staticClass:"btn-danger btn-sm pull-right",attrs:{href:"#"}},[i("div",{staticClass:"material-icons"},[t._v("visibility_off")]),t._v("  Esconder")]):t._e(),e.active?t._e():i("a",{staticClass:"btn-success btn-sm pull-right",attrs:{href:"#"}},[i("div",{staticClass:"material-icons"},[t._v("visibility")]),t._v("  Mostrar")])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}})])})],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("list")]),this._v("Tópicos")])]),this._v(" "),e("div",{staticClass:"col text-right"},[e("a",{staticClass:"btn-success btn-sm no-wrap",attrs:{href:"#modal-new"}},[e("div",{staticClass:"material-icons"},[this._v("add")]),this._v("\n        Criar novo tópico\n      ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input"},[e("input",{attrs:{required:"",placeholder:"Ex.: Tarefas de casa",name:"name",minlength:"3"}}),this._v(" "),e("label",[this._v("Nome")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")]),this._v(" "),e("th",{staticClass:"no-wrap"},[this._v("Valor (0-100)")]),this._v(" "),e("th",{staticClass:"text-center"},[this._v("Padrão")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-danger",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v("  Salvar\n            ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")]),this._v(" "),e("th",[this._v("Valor (0-100)")]),this._v(" "),e("th",{staticClass:"text-center"},[this._v("Padrão")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-danger",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v("  Salvar\n              ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-primary btn-sm",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])}]},B=i("VU/8")(V,z,!1,null,null,null).exports,M={name:"Grade",data:function(){var t=this.$parent.$data;return t.current_grade_subjects=[],t.current_student_grades=[],t.current_students=[],t.current_subjects=[],t.current_grade=void 0,t},watch:{current_grade_id:function(){this.update_current()}},methods:{studentGrade:function(t){return this.current_student_grades.find(function(e){return e.student_id===t})},grade_save:function(t){t.preventDefault();var e=this,i=this.$parent;document.location.hash="",i.loading=!0;var s=t.target,a={name:s.querySelector("[name=name]").value,level:s.querySelector("[name=level]").value,active:!0},r=s.querySelectorAll('[name="grade_subject[]"]:checked'),n=[].map.call(r,function(t){return t.value});return i.save_resource("grade",a).then(function(t){var e=[];return n.forEach(function(s){e.push(i.save_resource("grade_subject",{subject_id:s,grade_id:t.id},!0,!1))}),d.a.all(e)}).then(function(){return i.db.grade_subjects.toArray().then(function(t){return i.grade_subjects=t})}).then(function(){i.notify("Sucesso!",s.dataset.success,"success")}).catch(function(t){i.notify("Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.$forceUpdate()})},grade_update:function(t){t.preventDefault();var e=this,i=this.$parent;document.location.hash="",i.loading=!0;var s=t.target,a={id:s.querySelector("[name=id").value,name:s.querySelector("[name=name]").value,level:s.querySelector("[name=level]").value,active:s.querySelector("[name=active]").checked};return i.save_resource("grade",a).then(function(){i.notify("Sucesso!",s.dataset.success,"success")}).catch(function(t){i.notify("Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.update_current(),e.$forceUpdate()})},student_save:function(t){t.preventDefault();var e=this,i=this.$parent;i.loading=!0;var s=t.target,a={name:s.querySelector("[name=name]").value,active:!0},r={grade_id:s.querySelector("[name=grade_id]").value,number:s.querySelector("[name=number]").value,start_date:"2018-01-01",end_date:"2018-12-31"};return i.save_resource("student",a).then(function(t){return r.student_id=t.id,i.save_resource("student_grade",r)}).then(function(){i.loading=!1,i.notify("Sucesso!",s.dataset.success,"success"),e.update_current(),e.$forceUpdate()}).catch(function(t){console.log("Error:",t),i.loading=!1,i.notify("Erro!",s.dataset.error,"danger"),e.update_current(),e.$forceUpdate()})},student_toggle:function(t){var e=this,i=this.$parent,s=i.studentGrade(t);return s.end_date=new Date(s.end_date)<=new Date?"2018-12-31":(new Date).toISOString().slice(0,10),i.loading=!0,i.save_resource("student_grade",s).then(function(){i.notify("Sucesso!","","success")}).catch(function(t){i.notify("Erro!","","danger"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.update_current(),e.$forceUpdate()})},grade_subject_save:function(t){var e=this,i=this.$parent;t.preventDefault(),i.loading=!0;var s=t.target,a={grade_id:i.current_grade_id,subject_id:s.querySelector("[name=subject_id]").value};i.save_resource("grade_subject",a).then(function(){i.notify("Sucesso!",s.dataset.success,"success")}).catch(function(t){i.notify("Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.update_current(),e.$forceUpdate()})},student_update:function(t){var e=this,i=this.$parent,s=document.querySelector('[data-student_id="'+t+'"]'),a={id:t,name:s.querySelector("[name=name]").value};if(a.name.length<3)i.notify("Erro","O nome do aluno precisa de ao menos 3 caracteres","error");else{var r={id:i.studentGrade(t).id,student_id:t,grade_id:i.current_grade_id,number:parseInt(s.querySelector("[name=number]").value)};r.number?(i.loading=!0,i.save_resource("student",a).then(function(){return i.save_resource("student_grade",r)}).then(function(){i.notify("Sucesso!","Aluno editado com sucesso!","success")}).catch(function(t){i.notify("Erro!","Não foi possível editar o aluno!","error"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.update_current(),e.$forceUpdate()})):i.notify("Erro","O aluno precisa de um número válido")}},update_current:function(){var t=this;if(!this.current_grade_id)return this.current_grade_subjects=[],this.current_student_grades=[],this.current_students=[],this.current_subjects=[],void(this.current_grade=void 0);this.current_grade=this.grades.find(function(e){return e.id===t.current_grade_id}),this.current_grade_subjects=this.grade_subjects.filter(function(e){return e.grade_id===t.current_grade_id}),this.current_subjects=this.subjects.filter(function(e){return t.current_grade_subjects.find(function(t){return t.subject_id===e.id})}).sort(function(t,e){return t.name.localeCompare(e.name,"pt-BR",{ignorePunctuation:!0})}),this.current_student_grades=this.student_grades.filter(function(e){return e.grade_id===t.current_grade_id}),this.current_students=this.students.filter(function(e){return t.studentGrade(e.id)}).sort(function(e,i){return(e=t.studentGrade(e.id).number)<(i=t.studentGrade(i.id).number)?-1:e>i?1:0})}},created:function(){this.current_grade_subjects=[],this.current_student_grades=[],this.current_students=[],this.current_subjects=[],this.current_grade=void 0,this.current_grade_id="",this.current_subject_id=""}},W={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._m(0),t._v(" "),i("article",{staticClass:"box"},[i("div",{staticClass:"box-body"},[t.grades.length?i("table",{staticClass:"table"},[t._m(1),t._v(" "),i("tbody",t._l(t.grades,function(e){return i("tr",{key:e.id},[i("td",{class:parseInt(e.active)?"":"text-muted"},[t._v("\n              "+t._s(e.name)+"\n              "),parseInt(e.active)?t._e():i("span",{staticClass:"text-muted"},[t._v("(invisível)")])]),t._v(" "),i("td",{staticClass:"text-right no-wrap"},[i("a",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{href:"#modal-students",title:"Estudantes"},on:{click:function(i){t.current_grade_id=e.id}}},[i("div",{staticClass:"material-icons"},[t._v("person")]),t._v(" "),i("span",{staticClass:"d-none d-md-inline"},[t._v("Estudantes")])]),t._v(" "),i("a",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{href:"#modal-subjects",title:"Disciplinas"},on:{click:function(i){t.current_grade_id=e.id}}},[i("div",{staticClass:"material-icons"},[t._v("book")]),t._v(" "),i("span",{staticClass:"d-none d-md-inline"},[t._v("Disciplinas")])]),t._v(" "),i("a",{staticClass:"btn-warning btn-sm tooltip tooltip-end",attrs:{href:"#modal-edit",title:"Editar informações da turma"},on:{click:function(i){t.current_grade_id=e.id}}},[i("div",{staticClass:"material-icons"},[t._v("edit")]),t._v(" "),i("span",{staticClass:"d-none d-md-inline"},[t._v("Editar")])])])])}))]):i("div",{staticClass:"text-center text-muted"},[i("br"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Ainda não há nenhuma turma cadastrada")]),i("br")])])]),t._v(" "),i("div",{staticClass:"modal",attrs:{id:"modal-new"}},[i("div",{staticClass:"modal-header"},[t._v("Nova turma")]),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-11"},[i("form",{attrs:{action:"#","data-resource":"grade","data-success":"Turma cadastrada com sucesso","data-error":"Não foi possível cadastrar a turma"},on:{submit:function(e){return e.preventDefault(),t.grade_save(e)}}},[i("input",{attrs:{type:"hidden",name:"active",value:"1"}}),i("br"),t._v(" "),t._m(2),i("br"),t._v(" "),i("div",{staticClass:"row"},t._l(t.subjects,function(e){return e.active?i("div",{key:e.id,staticClass:"col-6 col-md-4"},[i("label",[i("input",{attrs:{type:"checkbox",name:"grade_subject[]"},domProps:{value:e.id}}),t._v(" "+t._s(e.name)+"\n                ")])]):t._e()})),i("br"),t._m(3),t._v(" "),t._m(4),i("br")])])])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}}),t._v(" "),i("div",{staticClass:"modal",attrs:{id:"modal-students"}},[i("div",{staticClass:"modal-header"},[t._v("Estudantes - "+t._s(t.current_grade?t.current_grade.name:""))]),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-11"},[i("form",{attrs:{action:"#","data-resource":"grade","data-success":"Estudante cadastrado com sucesso","data-error":"Não foi possível cadastrar o estudante"},on:{submit:function(e){return e.preventDefault(),t.student_save(e)}}},[i("input",{attrs:{type:"hidden",name:"grade_id"},domProps:{value:t.current_grade_id}}),i("br"),t._v(" "),t._m(5),t._v(" "),t._m(6)]),i("br"),t._v(" "),t.current_students?i("table",{staticClass:"table"},[t._m(7),t._v(" "),i("tbody",t._l(t.current_students,function(e){return i("tr",{key:e.id,attrs:{"data-student_id":e.id}},[t.studentGrade(e.id).end_date<=(new Date).toISOString().slice(0,10)?[i("td",{staticClass:"text-striked"},[t._v(t._s(e.name))]),t._v(" "),i("td",{staticStyle:{"max-width":"75px"}},[t._v(t._s(t.studentGrade(e.id).number))]),t._v(" "),i("td",{staticClass:"text-right"},[i("button",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{title:"Ativar e Desativar"},on:{click:function(i){t.student_toggle(e.id)}}},[i("div",{staticClass:"material-icons"},[t._v("visibility_off")]),i("span",{staticClass:"d-none d-md-inline"},[t._v(" Ativar e Desativar")])])])]:[i("td",[i("input",{attrs:{name:"name"},domProps:{value:e.name}})]),t._v(" "),i("td",{staticStyle:{"max-width":"75px"}},[i("input",{attrs:{type:"number",min:"1",step:"1",name:"number"},domProps:{value:t.studentGrade(e.id).number}})]),t._v(" "),i("td",{staticClass:"text-right"},[i("button",{staticClass:"btn-success btn-sm tooltip tooltip-end",attrs:{title:"Salvar"},on:{click:function(i){t.student_update(e.id)}}},[i("div",{staticClass:"material-icons"},[t._v("save")]),i("span",{staticClass:"d-none d-md-inline"},[t._v(" Salvar")])]),t._v(" "),i("button",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{title:"Ativar e Desativar"},on:{click:function(i){t.student_toggle(e.id)}}},[i("div",{staticClass:"material-icons"},[t._v("visibility_off")]),i("span",{staticClass:"d-none d-md-inline"},[t._v(" Ativar e Desativar")])])])]],2)}))]):t._e(),i("br"),t._m(8)])])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}}),t._v(" "),i("div",{staticClass:"modal",attrs:{id:"modal-edit"}},[i("div",{staticClass:"modal-header"},[t._v("Editar turma")]),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-11"},[t.current_grade?i("form",{attrs:{action:"#","data-resource":"grade","data-success":"Turma editada com sucesso","data-error":"Não foi possível editar a turma"},on:{submit:function(e){return e.preventDefault(),t.grade_update(e)}}},[i("input",{attrs:{type:"hidden",name:"id"},domProps:{value:t.current_grade_id}}),i("br"),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm-8 input"},[i("input",{attrs:{required:"",placeholder:"Ex.: 1° Ano A",name:"name"},domProps:{value:t.current_grade.name}}),t._v(" "),i("label",[t._v("Nome")])]),t._v(" "),i("div",{staticClass:"col-sm-4 input"},[i("input",{attrs:{type:"number",required:"",min:"1",placeholder:"Ex.: 1",name:"level"},domProps:{value:t.current_grade.level}}),t._v(" "),t._m(9)])]),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-12 text-center"},[i("label",[i("br"),t._v(" "),i("input",{attrs:{name:"active",value:"1",type:"checkbox"},domProps:{checked:parseInt(t.current_grade.active)}}),t._v("Visível\n                ")])])]),i("br"),t._m(10),t._v(" "),t._m(11),i("br")]):t._e()])])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}}),t._v(" "),i("div",{staticClass:"modal",attrs:{id:"modal-subjects"}},[i("div",{staticClass:"modal-header"},[t._v("Disciplinas - "+t._s(t.current_grade?t.current_grade.name:""))]),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-11"},[i("form",{attrs:{action:"#","data-success":"Disciplina incluída com sucesso","data-error":"Não foi possível incluir a disciplina"},on:{submit:function(e){return e.preventDefault(),t.grade_subject_save(e)}}},[i("br"),t._v(" "),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-12 col-sm-6 input"},[i("select",{attrs:{required:"",name:"subject_id"}},[i("option",{attrs:{value:"",disabled:"",hidden:"",selected:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.subjects,function(e){return i("option",{key:e.id,attrs:{disabled:t.current_subjects.find(function(t){return t.id===e.id})},domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),i("label",[t._v("Disciplina")])]),t._v(" "),t._m(12)]),t._v(" "),i("div",{staticClass:"row"},t._l(t.current_subjects,function(e){return i("div",{key:e.id,staticClass:"col-6 col-md-4"},[i("div",{staticClass:"material-icons"},[t._v("check")]),t._v(" "+t._s(e.name)+"\n              ")])})),i("br"),t._m(13),i("br")])])])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("people")]),this._v("Turma")])]),this._v(" "),e("div",{staticClass:"col text-right"},[e("a",{staticClass:"btn-success btn-sm no-wrap",attrs:{href:"#modal-new"}},[e("div",{staticClass:"material-icons"},[this._v("add")]),this._v("\n        Criar nova turma\n      ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-8 input"},[e("input",{attrs:{required:"",placeholder:"Ex.: 1° Ano A",name:"name"}}),this._v(" "),e("label",[this._v("Nome")])]),this._v(" "),e("div",{staticClass:"col-sm-4 input"},[e("input",{attrs:{type:"number",required:"",min:"1",placeholder:"Ex. 1° ano: 1",name:"level"}}),this._v(" "),e("label",[this._v("\n                  Nível\n\n                  "),e("div",{staticClass:"material-icons tooltip tooltip-left tooltip-start",attrs:{"data-tooltip":"1° ano: nível 1;&#xa;2° ano: nível 2;&#xa;3° ano: nível 3;&#xa;etc"}},[this._v("info")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-danger",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v("  Salvar\n            ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-8 input"},[e("input",{attrs:{required:"",placeholder:"Ex.: João da Silva",name:"name"}}),this._v(" "),e("label",[this._v("Nome")])]),this._v(" "),e("div",{staticClass:"col-sm-4 input"},[e("input",{attrs:{type:"number",required:"",min:"1",placeholder:"Ex.: 5",name:"number"}}),this._v(" "),e("label",[this._v("Número")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v("  Salvar\n            ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")]),this._v(" "),e("th",[this._v("Número")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-danger",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Fechar")])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",[this._v("\n                  Nível\n\n                  "),e("div",{staticClass:"material-icons tooltip tooltip-left tooltip-start",attrs:{"data-tooltip":"1° ano: nível 1;&#xa;2° ano: nível 2;&#xa;3° ano: nível 3;&#xa;etc"}},[this._v("info")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-danger",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v("  Salvar\n            ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-12 col-sm-3"},[e("br",{staticClass:"d-none d-sm-inline"}),this._v(" "),e("button",{staticClass:"btn-success",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v(" Salvar\n                ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-danger",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])}]},J=i("VU/8")(M,W,!1,null,null,null).exports,Q={name:"Council",data:function(){return this.$parent.$data},methods:{councilStatus:function(t){var e=this.councils.find(function(e){return e.id===t}),i=new Date;return i>new Date(e.end_date)?"Finalizado":i<new Date(e.start_date)?"Aguardando início":e.active?"Acontecendo":"Pausado"},activeCouncil:function(t){var e=this.councils.find(function(e){return e.id===t}),i=new Date;return e.status&&i>=new Date(e.start_date)&&i<=new Date(e.end_date)},council_save:function(t){t.preventDefault();var e=this,i=this.$parent;document.location.hash="",i.loading=!0;var s=t.target,a={name:s.querySelector("[name=name]").value,start_date:s.querySelector("[name=start_date]").value,end_date:s.querySelector("[name=end_date]").value,active:!0},r=s.querySelectorAll('[name="council_topic[]"]:checked'),n=[].map.call(r,function(t){return t.value});return i.save_resource("council",a).then(function(t){var e=[];n.forEach(function(s){e.push(i.save_resource("council_topic",{topic_id:s,council_id:t.id}))});var s=[];return i.grades.forEach(function(e){s.push(i.save_resource("council_grade",{grade_id:e.id,council_id:t.id}))}),d.a.all(e.concat(s))}).then(function(){i.notify("Sucesso!",s.dataset.success,"success")}).catch(function(t){i.notify("Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.$forceUpdate()})},council_update:function(t){t.preventDefault();var e=this,i=this.$parent;document.location.hash="",i.loading=!0;var s=t.target,a={id:s.querySelector("[name=id]").value,name:s.querySelector("[name=name]").value,start_date:s.querySelector("[name=start_date]").value,end_date:s.querySelector("[name=end_date]").value,active:!0};return i.save_resource("council",a).then(function(){i.notify("Sucesso!",s.dataset.success,"success")}).catch(function(t){i.notify("Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.$forceUpdate()})}}},Y={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._m(0),t._v(" "),i("article",{staticClass:"box"},[i("div",{staticClass:"box-body"},[t.councils.length?i("table",{staticClass:"table"},[t._m(1),t._v(" "),i("tbody",t._l(t.councils,function(e){return i("tr",{key:e.id,class:t.activeCouncil(e.id)?"text-bold":""},[i("td",[t._v(t._s(e.name))]),t._v(" "),i("td",{staticClass:"d-none d-sm-table-cell"},[t._v(t._s(new Date(e.start_date).toLocaleDateString("pt-BR"))+" - "+t._s(new Date(e.end_date).toLocaleDateString("pt-BR")))]),t._v(" "),i("td",{staticClass:"d-none d-lg-table-cell"},[t._v(t._s(t.councilStatus(e.id)))]),t._v(" "),i("td",{staticClass:"text-right no-wrap"},[i("router-link",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{to:{name:"Report",params:{id:e.id}},title:"Relatórios do conselho de classe"}},[i("div",{staticClass:"material-icons"},[t._v("search")]),t._v(" "),i("span",{staticClass:"d-none d-md-inline"},[t._v("Relatórios")])]),t._v(" "),i("a",{staticClass:"btn-warning btn-sm tooltip tooltip-end",attrs:{href:"#modal-edit-"+e.id,title:"Editar informações do conselho"}},[i("div",{staticClass:"material-icons"},[t._v("edit")]),t._v(" "),i("span",{staticClass:"d-none d-md-inline"},[t._v("Editar")])])],1)])}))]):i("div",{staticClass:"text-center text-muted"},[i("br"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Ainda não há nenhum conselho de classe cadastrado")]),i("br")])])]),t._v(" "),i("div",{staticClass:"modal",attrs:{id:"modal-new"}},[i("div",{staticClass:"modal-header"},[t._v("Novo conselho de classe")]),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-11"},[i("form",{attrs:{action:"#","data-success":"Conselho de classe criado com sucesso","data-error":"Não foi possível criar o conselho de classe"},on:{submit:function(e){return e.preventDefault(),t.council_save(e)}}},[i("br"),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-4 input"},[i("input",{attrs:{required:"",placeholder:"Ex.: "+(1+~~(((new Date).getMonth()+1)/4))+"° trimestre "+(new Date).getFullYear(),name:"name"}}),t._v(" "),i("label",[t._v("Nome")])]),t._v(" "),t._m(2),t._v(" "),t._m(3)]),i("br"),t._v(" "),i("div",{staticClass:"row"},t._l(t.topics,function(e){return e.active?i("div",{key:e.id,staticClass:"col-6 col-md-4"},[i("label",[i("input",{attrs:{type:"checkbox",name:"council_topic[]"},domProps:{value:e.id}}),t._v(" "+t._s(e.name)+"\n                ")])]):t._e()})),i("br"),t._m(4),t._v(" "),t._m(5),i("br")])])])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}}),t._v(" "),t._l(t.councils,function(e){return i("div",{key:e.id},[i("div",{staticClass:"modal",attrs:{id:"modal-edit-"+e.id}},[i("div",{staticClass:"modal-header"},[t._v("Editar conselho de classe")]),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-11"},[i("form",{attrs:{action:"#","data-success":"Conselho de classe editado com sucesso","data-error":"Não foi possível editar o conselho de classe"},on:{submit:function(e){return e.preventDefault(),t.council_update(e)}}},[i("input",{attrs:{type:"hidden",name:"id"},domProps:{value:e.id}}),i("br"),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-4 input"},[i("input",{attrs:{required:"",name:"name",placeholder:"Ex.: "+(1+~~(((new Date).getMonth()+1)/4))+"° trimestre "+(new Date).getFullYear()},domProps:{value:e.name}}),t._v(" "),i("label",[t._v("Nome")])]),t._v(" "),i("div",{staticClass:"col-sm-6 col-md-4 input"},[i("input",{attrs:{type:"date",required:"",name:"start_date",placeholder:"Primeiro dia disponível para avaliação"},domProps:{value:e.start_date}}),t._v(" "),t._m(6,!0)]),t._v(" "),i("div",{staticClass:"col-sm-6 col-md-4 input"},[i("input",{attrs:{type:"date",required:"",name:"end_date",placeholder:"Primeiro dia disponível para avaliação"},domProps:{value:e.end_date}}),t._v(" "),t._m(7,!0)])]),i("br"),t._v(" "),i("div",{staticClass:"row"},t._l(t.topics,function(s){return t.council_topics.find(function(t){return t.council_id===e.id&&t.topic_id===s.id})?i("div",{key:s.id,staticClass:"col-6 col-md-4"},[i("div",{staticClass:"material-icons"},[t._v("check")]),t._v(" "+t._s(s.name)+"\n                ")]):t._e()})),i("br"),t._m(8,!0),t._v(" "),t._m(9,!0),i("br")])])])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}})])})],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("edit")]),this._v("Conselhos de Classe")])]),this._v(" "),e("div",{staticClass:"col text-right"},[e("a",{staticClass:"btn-success btn-sm no-wrap",attrs:{href:"#modal-new"}},[e("div",{staticClass:"material-icons"},[this._v("add")]),this._v(" Criar novo conselho")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")]),this._v(" "),e("th",{staticClass:"d-none d-sm-table-cell"},[this._v("Período")]),this._v(" "),e("th",{staticClass:"d-none d-lg-table-cell"},[this._v("Status")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-sm-6 col-md-4 input"},[e("input",{attrs:{type:"date",required:"",name:"start_date"}}),this._v(" "),e("label",[this._v("\n                  Data inicial\n\n                  "),e("div",{staticClass:"material-icons tooltip",attrs:{"data-tooltip":"Primeiro dia disponível para avaliação"}},[this._v("help")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-sm-6 col-md-4 input"},[e("input",{attrs:{type:"date",required:"",name:"end_date"}}),this._v(" "),e("label",[this._v("\n                  Data final\n\n                  "),e("div",{staticClass:"material-icons tooltip",attrs:{"data-tooltip":"Último dia disponível para avaliação"}},[this._v("help")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-danger",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v("  Salvar\n            ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",[this._v("\n                    Data inicial\n\n                    "),e("div",{staticClass:"material-icons tooltip",attrs:{"data-tooltip":"Primeiro dia disponível para avaliação"}},[this._v("help")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",[this._v("\n                    Data final\n\n                    "),e("div",{staticClass:"material-icons tooltip",attrs:{"data-tooltip":"Último dia disponível para avaliação"}},[this._v("help")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-danger",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v("  Salvar\n              ")])}]},X=i("VU/8")(Q,Y,!1,null,null,null).exports,Z={name:"Role",data:function(){return this.$parent.$data},computed:{orderedUsers:function(){return this.users.sort(function(t,e){return t.name.localeCompare(e.name,"pt-BR",{ignorePunctuation:!0})})}},methods:{role_type:function(t){var e=this.roles.find(function(e){return e.user_id===t&&parseInt(e.approved)});return e?this.role_types.find(function(t){return t.id===e.role_type_id}):{}},user_save:function(t){t.preventDefault();var e=this,i=this.$parent,s=t.target,a={name:s.querySelector("[name=name]").value,email:s.querySelector("[name=email]").value,password:s.querySelector("[name=password]").value},r={role_type_id:s.querySelector("[name=role_type_id]").value};a.password===s.querySelector("[name=re_password]").value?(i.loading=!0,i.save_resource("user",a).then(function(t){return a.id=t.id,r.user_id=t.id,i.api_fetch("user_token","POST",a)}).then(function(t){return t.json()}).then(function(t){return i.save_resource("role",r,!0,!0,{Token:t.value})}).then(function(t){return r.id=t.id,r.approved=!0,i.save_resource("role",r)}).then(function(){i.notify("Sucesso!",s.dataset.success,"success"),document.location.hash=""}).catch(function(t){i.notify("Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.$forceUpdate()})):i.notify("Erro!","As senhas informadas devem ser iguais!","danger")}}},K={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._m(0),t._v(" "),i("article",{staticClass:"box"},[i("div",{staticClass:"box-body"},[i("table",{staticClass:"table"},[t._m(1),t._v(" "),i("tbody",t._l(t.orderedUsers,function(e){return i("tr",{key:e.id},[i("td",[t._v(t._s(e.name))]),t._v(" "),i("td",[t._v(t._s(t.role_type(e.id).name))]),t._v(" "),i("td",[t._v(t._s(e.email))])])}))])])]),t._v(" "),i("div",{staticClass:"modal",attrs:{id:"modal-new"}},[i("div",{staticClass:"modal-header"},[t._v("Novo usuário")]),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-11"},[i("form",{attrs:{action:"#","data-success":"Usuário cadastrado com sucesso","data-error":"Não foi possível cadastrar o usuário"},on:{submit:t.user_save}},[i("br"),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-6 input"},[i("select",{attrs:{required:"",name:"role_type_id"}},[i("option",{attrs:{value:"",selected:"",disabled:"",hidden:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.role_types,function(e){return i("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),i("label",[t._v("Tipo de usuário")])])]),i("br"),i("br"),t._m(4),t._v(" "),t._m(5),i("br")])])])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("people")]),this._v("Usuários")])]),this._v(" "),e("div",{staticClass:"col text-right"},[e("a",{staticClass:"btn-success btn-sm no-wra",attrs:{href:"#modal-new"}},[e("div",{staticClass:"material-icons"},[this._v("add")]),this._v(" Criar novo usuário")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")]),this._v(" "),e("th",[this._v("Tipo")]),this._v(" "),e("th",[this._v("E-mail")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6 input"},[e("input",{attrs:{required:"",placeholder:"Ex.: João da Silva",name:"name",minlength:"3"}}),this._v(" "),e("label",[this._v("Nome")])]),this._v(" "),e("div",{staticClass:"col-sm-6 input"},[e("input",{attrs:{required:"",placeholder:"Ex.: joao@email.com",name:"email",type:"email",minlength:"3"}}),this._v(" "),e("label",[this._v("E-mail")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6 input"},[e("input",{attrs:{required:"",placeholder:"Ao menos 5 caracteres",name:"password",type:"password",minlength:"5"}}),this._v(" "),e("label",[this._v("Senha")])]),this._v(" "),e("div",{staticClass:"col-sm-6 input"},[e("input",{attrs:{required:"",placeholder:"Igual à anterior",name:"re_password",type:"password",minlength:"5"}}),this._v(" "),e("label",[this._v("Repita a senha")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-danger",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v("  Salvar\n            ")])}]},tt=i("VU/8")(Z,K,!1,null,null,null).exports,et={name:"Teacher",data:function(){var t=this.$parent.$data;return t.current_teacher_request_id=void 0,t.current_teacher_id=void 0,t.current_user_id=void 0,t.current_user=void 0,t},watch:{current_user_id:function(){this.update_current()}},computed:{orderedUsers:function(){return this.users.sort(function(t,e){return t.name.localeCompare(e.name,"pt-BR",{ignorePunctuation:!0})})},usersWhoEvaluate:function(){var t=this;return this.orderedUsers.filter(function(e){return t.userHasPermission("evaluate",e.id)})}},methods:{role_type:function(t){var e=this.roles.find(function(e){return e.user_id===t&&parseInt(e.approved)});return e?this.role_types.find(function(t){return t.id===e.role_type_id}):{}},userHasPermission:function(t,e){e||(e=this.user.id);var i=this.role_type(e);if(void 0===i.id)return!1;var s=this.permissions.find(function(e){return e.reference===t});return!!this.role_type_permissions.find(function(t){return t.permission_id===s.id&&t.role_type_id===i.id})},teacher_save:function(t){t.preventDefault();var e=this,i=this.$parent;i.loading=!0;var s=t.target,a={grade_id:s.querySelector("[name=grade_id]").value,subject_id:s.querySelector("[name=subject_id]").value,user_id:s.querySelector("[name=user_id]").value,start_date:"2018-01-01",end_date:"2018-12-31"};i.save_resource("teacher",a).then(function(){i.current_subject_id="",i.current_grade_id="",i.notify("Sucesso!",s.dataset.success,"success")}).catch(function(t){i.notify("Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.$forceUpdate()})},accept_teacher_request:function(){var t=this,e=this.$parent;e.loading=!0;var i=e.teacher_requests.find(function(e){return e.id===t.current_teacher_request_id}),s={user_id:i.user_id,grade_id:i.grade_id,subject_id:i.subject_id,start_date:"2018-01-01",end_date:"2018-12-31"};e.save_resource("teacher",s).then(function(){return e.delete_resource("teacher_request",t.current_teacher_request_id)}).then(function(){e.notify("Sucesso!","Professor aceitado com sucesso","success")}).catch(function(t){e.notify("Erro!","Não foi possível aceitar o professor","danger"),console.log("Error:",t)}).finally(function(){e.loading=!1,t.$forceUpdate()})},deny_teacher_request:function(){var t=this,e=this.$parent;e.loading=!0,e.delete_resource("teacher_request",t.current_teacher_request_id).then(function(){e.notify("Sucesso!","Professor negado com sucesso","success")}).catch(function(t){e.notify("Erro!","Não foi possível negar o professor","danger"),console.log("Error:",t)}).finally(function(){e.loading=!1,t.$forceUpdate()})},remove_teacher:function(){var t=this,e=this.$parent;e.loading=!0,e.delete_resource("teacher",t.current_teacher_id).then(function(){e.notify("Sucesso!","Professor removido com sucesso","success")}).catch(function(t){e.notify("Erro!","Não foi possível remover o professor","danger"),console.log("Error:",t)}).finally(function(){e.loading=!1,t.$forceUpdate()})},update_current:function(){var t=this;this.current_user_id?this.current_user=this.users.find(function(e){return e.id===t.current_user_id}):this.current_user=void 0}},created:function(){this.current_grade_id="",this.current_subject_id="",this.current_teacher_request_id=void 0,this.current_teacher_id=void 0,this.current_user_id=void 0,this.current_user=void 0}},it={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._m(0),t._v(" "),i("article",{staticClass:"box"},[i("div",{staticClass:"box-header"},[t._v("Aguardando aprovação")]),t._v(" "),i("div",{staticClass:"box-body"},[t.teacher_requests.length?i("table",{staticClass:"table"},[t._m(1),t._v(" "),i("tbody",t._l(t.teacher_requests,function(e){return i("tr",{key:e.id},[i("td",[t._v(t._s(t.users.find(function(t){return t.id===e.user_id}).name))]),t._v(" "),i("td",[t._v(t._s(t.grades.find(function(t){return t.id===e.grade_id}).name))]),t._v(" "),i("td",[t._v(t._s(t.subjects.find(function(t){return t.id===e.subject_id}).name))]),t._v(" "),i("td",{staticClass:"text-right no-wrap"},[i("a",{staticClass:"btn-success btn-sm tooltip tooltip-end",attrs:{href:"#modal-accept",title:"Aceitar professor"},on:{click:function(i){t.current_teacher_request_id=e.id}}},[i("div",{staticClass:"material-icons"},[t._v("check")]),t._v(" "),i("span",{staticClass:"d-none d-md-inline"},[t._v("Aceitar professor")])]),t._v(" "),i("a",{staticClass:"btn-danger btn-sm tooltip tooltip-end",attrs:{href:"#modal-deny",title:"Negar professor"},on:{click:function(i){t.current_teacher_request_id=e.id}}},[i("div",{staticClass:"material-icons"},[t._v("close")]),t._v(" "),i("span",{staticClass:"d-none d-md-inline"},[t._v("Negar professor")])])])])}))]):i("div",{staticClass:"text-center text-muted"},[i("br"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Nenhum professor esperando aprovação")]),i("br")])])]),t._v(" "),i("article",{staticClass:"box"},[i("div",{staticClass:"box-header"},[t._v("Todos")]),t._v(" "),i("div",{staticClass:"box-body"},[i("table",{staticClass:"table"},[t._m(2),t._v(" "),i("tbody",t._l(t.usersWhoEvaluate,function(e){return i("tr",{key:e.id},[i("td",[t._v(t._s(e.name))]),t._v(" "),i("td",{staticClass:"text-right no-wrap"},[i("a",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{href:"#modal-grades",title:"Turmas"},on:{click:function(i){t.current_user_id=e.id}}},[i("div",{staticClass:"material-icons"},[t._v("people")]),t._v(" "),i("span",{staticClass:"d-none d-md-inline"},[t._v("Turmas")])])])])}))])])]),t._v(" "),i("div",{staticClass:"modal",attrs:{id:"modal-grades"}},[i("div",{staticClass:"modal-header"},[t._v("Turmas de "+t._s(t.current_user?t.current_user.name:""))]),t._v(" "),i("div",{staticClass:"modal-body"},[i("br"),t._v(" "),i("form",{attrs:{action:"#","data-success":"Professor salvo com sucesso!","data-error":"Não foi possível cadastrar"},on:{submit:function(e){return e.preventDefault(),t.teacher_save(e)}}},[i("input",{attrs:{type:"hidden",name:"user_id"},domProps:{value:t.current_user_id}}),t._v(" "),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-12 col-md-9"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"input col-6 col-sm-4"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.current_grade_id,expression:"current_grade_id"}],attrs:{id:"current_grade_id",name:"grade_id",required:""},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_grade_id=e.target.multiple?i:i[0]}}},[i("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.grades,function(e){return i("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),i("label",{attrs:{for:"current_grade_id"}},[t._v("Turma")])]),t._v(" "),i("div",{staticClass:"input col-6 col-sm-4"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.current_subject_id,expression:"current_subject_id"}],attrs:{id:"current_subject_id",name:"subject_id",required:"",disabled:!t.current_grade_id},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_subject_id=e.target.multiple?i:i[0]}}},[i("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v(t._s(t.current_grade_id?"Selecione...":"Selecione a turma..."))]),t._v(" "),t._l(t.subjects,function(e){return t.current_grade_id&&void 0!==t.grade_subjects.find(function(i){return i.subject_id===e.id&&i.grade_id===t.current_grade_id})?i("option",{key:e.id,attrs:{disabled:void 0!==t.teachers.find(function(i){return i.grade_id===t.current_grade_id&&i.subject_id===e.id})},domProps:{value:e.id}},[t._v(t._s(e.name)+" "+t._s(void 0!==t.teachers.find(function(i){return i.grade_id===t.current_grade_id&&i.subject_id===e.id})?" - "+t.users.find(function(i){return t.teachers.find(function(i){return i.grade_id===t.current_grade_id&&i.subject_id===e.id}).user_id===i.id}).name:""))]):t._e()})],2),t._v(" "),i("label",{attrs:{for:"current_subject_id"}},[t._v("Disciplina")])]),t._v(" "),t._m(3)])])])]),i("br"),t._v(" "),t.current_user&&t.teachers.find(function(e){return e.user_id===t.current_user.id})?i("table",{staticClass:"table"},[t._m(4),t._v(" "),i("tbody",t._l(t.teachers,function(e){return e.user_id===t.current_user.id?i("tr",{key:e.id},[i("td",[t._v(t._s(t.grades.find(function(t){return t.id===e.grade_id}).name))]),t._v(" "),i("td",[t._v(t._s(t.subjects.find(function(t){return t.id===e.subject_id}).name))]),t._v(" "),i("td",{staticClass:"text-right"},[i("a",{staticClass:"btn-danger btn-sm tooltip tooltip-end",attrs:{href:"#modal-remove",title:"Remover"},on:{click:function(i){t.current_teacher_id=e.id}}},[i("div",{staticClass:"material-icons"},[t._v("delete")]),t._v(" "),i("span",{staticClass:"d-none d-md-inline"},[t._v("Remover")])])])]):t._e()}))]):i("div",{staticClass:"text-center text-muted"},[i("br"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Nenhuma turma aprovada")]),i("br")])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}}),t._v(" "),i("div",{staticClass:"modal modal-xs modal-success",attrs:{id:"modal-accept"}},[i("div",{staticClass:"modal-header"},[t._v("Aceitar professor")]),t._v(" "),t._m(5),t._v(" "),i("div",{staticClass:"modal-footer"},[t._m(6),t._v(" "),i("button",{staticClass:"btn-success btn-sm pull-right",on:{click:t.accept_teacher_request}},[i("div",{staticClass:"material-icons"},[t._v("check")]),t._v("  Aceitar\n      ")])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}}),t._v(" "),i("div",{staticClass:"modal modal-xs modal-danger",attrs:{id:"modal-deny"}},[i("div",{staticClass:"modal-header"},[t._v("Negar professor")]),t._v(" "),t._m(7),t._v(" "),i("div",{staticClass:"modal-footer"},[t._m(8),t._v(" "),i("button",{staticClass:"btn-danger btn-sm pull-right",on:{click:t.deny_teacher_request}},[i("div",{staticClass:"material-icons"},[t._v("close")]),t._v("  Negar\n      ")])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}}),t._v(" "),i("div",{staticClass:"modal modal-xs modal-danger",attrs:{id:"modal-remove"}},[i("div",{staticClass:"modal-header"},[t._v("Remover professor")]),t._v(" "),t._m(9),t._v(" "),i("div",{staticClass:"modal-footer"},[t._m(10),t._v(" "),i("button",{staticClass:"btn-danger btn-sm pull-right",on:{click:t.remove_teacher}},[i("div",{staticClass:"material-icons"},[t._v("delete")]),t._v("  Remover\n      ")])])]),i("a",{staticClass:"modal-close",attrs:{href:"#"}})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("people")]),this._v("Professores")])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")]),this._v(" "),e("th",[this._v("Turma")]),this._v(" "),e("th",[this._v("Disciplina")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-12 col-sm-3"},[e("br",{staticClass:"d-none d-sm-inline"}),this._v(" "),e("button",{staticClass:"btn-success",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v(" Salvar\n                ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Turma")]),this._v(" "),e("th",[this._v("Disciplina")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-body"},[e("p",[this._v("Tem certeza que deseja aceitar este professor?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-primary btn-sm",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-body"},[e("p",[this._v("Tem certeza que deseja negar este professor?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-primary btn-sm",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-body"},[e("p",[this._v("Tem certeza que deseja remover este professor?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-primary btn-sm",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("  Cancelar")])}]},st=i("VU/8")(et,it,!1,null,null,null).exports,at={name:"User",data:function(){return this.$parent.$data},methods:{user_update:function(t){t.preventDefault();var e=this,i=this.$parent,s=t.target,a={id:i.user.id,name:i.user.name,email:i.user.email},r=s.querySelector("#password").value;if(r===s.querySelector("#re_password").value)return r&&(a.password=r),i.loading=!0,i.api_fetch("user","PATCH",a).then(function(t){return delete a.password,i.db.users.put(a)}).then(function(){i.notify("Sucesso!",s.dataset.success,"success")}).catch(function(t){i.notify("Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.$forceUpdate()});i.notify("Erro!","Os dois campos de senha devem ser iguais!","danger")}}},rt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._m(0),t._v(" "),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-md-10 col-lg-8 col-xlg-6"},[i("article",{staticClass:"box"},[i("div",{staticClass:"box-body"},[i("form",{attrs:{action:"#","data-success":"Usuário editado com sucesso","data-error":"Não foi possível editar o usuário"},on:{submit:function(e){return e.preventDefault(),t.user_update(e)}}},[i("div",{staticClass:"row"},[i("div",{staticClass:"input col-sm-6"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.name,expression:"user.name"}],attrs:{id:"user_name",minlength:"3",required:""},domProps:{value:t.user.name},on:{input:function(e){e.target.composing||t.$set(t.user,"name",e.target.value)}}}),t._v(" "),i("label",{attrs:{for:"user_name"}},[t._v("Nome completo")])]),t._v(" "),i("div",{staticClass:"input col-sm-6"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.email,expression:"user.email"}],attrs:{id:"user_email",type:"email",minlength:"3",required:""},domProps:{value:t.user.email},on:{input:function(e){e.target.composing||t.$set(t.user,"email",e.target.value)}}}),t._v(" "),i("label",{attrs:{for:"user_email"}},[t._v("E-mail")])])]),t._v(" "),t._m(1),t._v(" "),t._m(2)])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("person")]),this._v("Usuário")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"input col-sm-6"},[e("input",{attrs:{id:"password",type:"password",minlength:"5",placeholder:"Apenas caso queira alterar"}}),this._v(" "),e("label",{attrs:{for:"password"}},[this._v("Nova senha")])]),this._v(" "),e("div",{staticClass:"input col-sm-6"},[e("input",{attrs:{id:"re_password",type:"password",minlength:"5",placeholder:"Para conferir se digitou corretamente"}}),this._v(" "),e("label",{attrs:{for:"re_password"}},[this._v("Repita a senha")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-right"},[e("button",{staticClass:"btn-success"},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v(" Salvar\n              ")])])}]},nt=i("VU/8")(at,rt,!1,null,null,null).exports,ot=i("2QDH"),ct=i.n(ot),dt={name:"Report",data:function(){var t=this.$parent.$data,e=parseInt(this.$route.params.id);return t.current_council=t.councils.find(function(t){return t.id===e}),t.current_evaluations=[],t.current_student_observations=[],t.current_student_grades=[],t.current_topics=t.topics.filter(function(e){return void 0!==t.council_topics.find(function(i){return i.topic_id===e.id&&i.council_id===t.current_council.id})}),t.ordered_topic_options=t.topic_options.sort(function(t,e){return ct()(parseInt(t.value)-parseInt(e.value))}),t},watch:{current_grade_id:function(){this.update_current()},current_subject_id:function(){this.update_current()}},methods:{update_current:function(){var t=this;if(!this.current_grade_id)return this.current_evaluations=[],this.current_student_observations=[],void(this.current_student_grades=[]);this.current_evaluations=this.evaluations.filter(function(e){return e.council_id===t.current_council.id&&e.grade_id===t.current_grade_id&&(!t.current_subject_id||e.subject_id===t.current_subject_id)}),this.current_student_observations=this.student_observations.filter(function(e){return e.council_id===t.current_council.id&&e.grade_id===t.current_grade_id&&(!t.current_subject_id||e.subject_id===t.current_subject_id)}),this.current_student_grades=this.student_grades.filter(function(e){return e.grade_id===t.current_grade_id}),setTimeout(S,1e3)},reportStudentTopic:function(t,e){var i=this.ordered_topic_options.filter(function(t){return t.topic_id===e}),s=this.current_evaluations.filter(function(e){return e.student_id===t&&void 0!==i.find(function(t){return t.id===e.topic_option_id})});if(!s.length)return"-";var a=s.map(function(t){return parseInt(i.find(function(e){return e.id===t.topic_option_id}).value)}),r=a.reduce(function(t,e){return t+e}),n=parseInt(r/a.length),o=i.map(function(t){return t.value}),c=parseInt(o.reduce(function(t,e){return Math.abs(e-n)<Math.abs(t-n)?e:t}));return i.find(function(t){return parseInt(t.value)===c}).name+" ("+n+"%)"},studentGrade:function(t){return this.current_student_grades.find(function(e){return e.student_id===t})},studentHasEvaluation:function(t){return!!this.current_evaluations.find(function(e){return e.student_id===t})}},computed:{studentsInGrade:function(){var t=this;if(this.current_grade_id)return this.students.filter(function(e){return void 0!==t.studentGrade(e.id)}).sort(function(e,i){return(e=t.studentGrade(e.id).number)<(i=t.studentGrade(i.id).number)?-1:e>i?1:0})},currentGrade:function(){var t=this;if(this.current_grade_id)return this.grades.find(function(e){return parseInt(e.id)===parseInt(t.current_grade_id)})},subjectsInGrade:function(){var t=this;if(this.current_grade_id)return this.subjects.filter(function(e){return t.grade_subjects.find(function(i){return i.subject_id===e.id&&i.grade_id===t.current_grade_id})})},gradeObservations:function(){var t=this;if(this.current_grade_id)return this.grade_observations.filter(function(e){return e.grade_id===t.current_grade_id&&e.council_id===t.current_council.id&&(!t.current_subject_id||e.subject_id===t.current_subject_id)})}},created:function(){var t=this,e=parseInt(this.$route.params.id);this.current_council=this.councils.find(function(t){return t.id===e}),this.current_evaluations=[],this.current_student_observations=[],this.current_student_grades=[],this.current_topics=this.topics.filter(function(e){return void 0!==t.council_topics.find(function(i){return i.topic_id===e.id&&i.council_id===t.current_council.id})}),this.ordered_topic_options=this.topic_options.sort(function(t,e){return ct()(parseInt(t.value)-parseInt(e.value))}),this.current_grade_id="",this.current_subject_id=""}},ut={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h1",{staticClass:"content-title"},[i("i",{staticClass:"material-icons"},[t._v("edit")]),t._v("Relatórios - "+t._s(t.current_council.name))]),t._v(" "),i("article",{staticClass:"box"},[i("div",{staticClass:"box-body"},[i("br"),t._v(" "),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-12 col-md-8 col-lg-6"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"input col-12 col-sm-6"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.current_grade_id,expression:"current_grade_id"}],attrs:{id:"current_grade_id",name:"current_grade_id",required:""},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_grade_id=e.target.multiple?i:i[0]}}},[i("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.grades,function(e){return i("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),i("label",{attrs:{for:"current_grade_id"}},[t._v("Turma")])]),t._v(" "),i("div",{staticClass:"input col-12 col-sm-6"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.current_subject_id,expression:"current_subject_id"}],attrs:{id:"current_subject_id",name:"current_subject_id",required:"",disabled:!t.current_grade_id},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_subject_id=e.target.multiple?i:i[0]}}},[i("option",{attrs:{value:"",selected:""}},[t._v(t._s(t.current_grade_id?"Todas":"Selecione a turma..."))]),t._v(" "),t._l(t.subjectsInGrade,function(e){return i("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),i("label",{attrs:{for:"current_subject_id"}},[t._v("Disciplina")])])])])]),i("br"),t._v(" "),t.current_grade_id?t.evaluations.length?i("div",[i("div",{staticClass:"table"},[i("table",[i("thead",[i("tr",[i("th",[t._v("Aluno")]),t._v(" "),t._l(t.current_topics,function(e){return i("th",{key:e.id,staticStyle:{"min-width":"150px"}},[t._v(t._s(e.name))])}),t._v(" "),i("th",{staticClass:"no-wrap"},[t._v("Observações Gerais")])],2)]),t._v(" "),i("tbody",t._l(t.studentsInGrade,function(e){return i("tr",{key:e.id,attrs:{"data-student_id":e.id}},[i("td",{staticClass:"no-wrap"},[t._v(t._s(t.studentGrade(e.id).number)+" - "+t._s(e.name))]),t._v(" "),t._l(t.current_topics,function(s){return i("td",{key:s.id},[t._v(t._s(t.reportStudentTopic(e.id,s.id)))])}),t._v(" "),i("td",t._l(t.current_student_observations.filter(function(t){return t.student_id===e.id}),function(e){return i("p",{key:e.id,staticStyle:{"min-width":"250px"}},[i("b",[t._v(t._s(t.users.find(function(t){return t.id===e.user_id}).name)+t._s(t.current_subject_id?"":" - "+t.subjects.find(function(t){return t.id===e.subject_id}).name)+":")]),t._v(" "+t._s(e.description))])}))],2)}))])]),i("br"),t._v(" "),t._l(t.gradeObservations,function(e){return i("p",{key:e.id},[i("b",[t._v(t._s(t.users.find(function(t){return t.id===e.user_id}).name)+t._s(t.current_subject_id?"":" - "+t.subjects.find(function(t){return t.id===e.subject_id}).name)+":")]),t._v(" "+t._s(e.description))])})],2):i("div",{staticClass:"text-center text-muted"},[i("br"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Esta turma ainda não recebeu avaliações nesta disciplina.")]),i("br")]):i("div",{staticClass:"text-center text-muted"},[i("br"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Selecione uma turma para ver o relatório.")]),i("br")])])])])},staticRenderFns:[]},lt=i("VU/8")(dt,ut,!1,null,null,null).exports,_t={name:"Evaluate",data:function(){var t=this.$parent.$data,e=parseInt(this.$route.params.id);return t.current_council=t.councils.find(function(t){return t.id===e}),t.current_evaluations=[],t.current_student_observations=[],t.current_student_grades=[],t.current_topics=t.topics.filter(function(e){return void 0!==t.council_topics.find(function(i){return i.topic_id===e.id&&i.council_id===t.current_council.id})}),t.ordered_topic_options=t.topic_options.sort(function(t,e){return ct()(parseInt(t.value)-parseInt(e.value))}),t},watch:{current_grade_id:function(){this.update_current()},current_subject_id:function(){this.update_current()}},computed:{studentsInGrade:function(){var t=this;if(this.current_grade_id)return this.students.filter(function(e){return void 0!==t.studentGrade(e.id)}).sort(function(e,i){return(e=t.studentGrade(e.id).number)<(i=t.studentGrade(i.id).number)?-1:e>i?1:0})},currentGrade:function(){var t=this;if(this.current_grade_id)return this.grades.find(function(e){return parseInt(e.id)===parseInt(t.current_grade_id)})},subjectsInGrade:function(){var t=this;if(this.current_grade_id)return this.subjects.filter(function(e){return t.grade_subjects.find(function(i){return i.subject_id===e.id&&i.grade_id===t.current_grade_id})})},gradeObservations:function(){var t=this;if(this.current_grade_id)return this.grade_observations.filter(function(e){return e.grade_id===t.current_grade_id&&e.council_id===t.current_council.id&&(!t.current_subject_id||e.subject_id===t.current_subject_id)})}},methods:{set_confirm_redirect:function(){window.onbeforeunload=function(t){var e="Tem certeza que deseja sair da página? Você perderá o que não foi salvo";return t.returnValue=e,e}},update_current:function(){var t=this;if(!this.current_grade_id||!this.current_subject_id)return this.current_evaluations=[],this.current_student_observations=[],void(this.current_student_grades=[]);this.current_student_observations=this.student_observations.filter(function(e){return e.council_id===t.current_council.id&&e.grade_id===t.current_grade_id&&e.subject_id===t.current_subject_id&&e.user_id===t.user.id}),this.current_student_grades=this.student_grades.filter(function(e){return e.grade_id===t.current_grade_id});var e=this.evaluations.filter(function(e){return e.council_id===t.current_council.id&&e.grade_id===t.current_grade_id&&e.subject_id===t.current_subject_id&&e.user_id===t.user.id}).map(function(e){var i=t.topic_options.find(function(t){return t.id===e.topic_option_id});return e.topic_id=i.topic_id,e}),i=[];this.studentsInGrade.forEach(function(s){t.current_topics.forEach(function(a){e.find(function(t){return t.student_id===s.id&&t.topic_id===a.id})||i.push({student_id:s.id,topic_id:a.id,topic_option_id:a.topic_option_id,council_id:t.current_council.id,user_id:t.user.id,grade_id:t.current_grade_id,subject_id:t.current_subject_id})})}),this.current_evaluations=e.concat(i),setTimeout(S,1e3)},studentGrade:function(t){return this.current_student_grades.find(function(e){return e.student_id===t})},studentHasEvaluation:function(t){return!!this.current_evaluations.find(function(e){return e.id&&e.student_id===t})},studentIsActive:function(t){return this.studentGrade(t).end_date>(new Date).toISOString().slice(0,10)},topicOptions:function(t){return this.ordered_topic_options.filter(function(e){return e.topic_id===t})},student_evaluation_save:function(t){var e=this,i=this.$parent;i.loading=!0;var s=[];e.current_evaluations.filter(function(e){return e.student_id===t}).forEach(function(t){s.push(i.save_resource("evaluation",t,!0,!1))});var a=document.querySelector('tr[data-student_id="'+t+'"] textarea').value;if(a.length){var r=e.current_student_observations.find(function(e){return e.student_id===t});r&&r.description===a||s.push(i.save_resource("student_observation",{council_id:i.current_council.id,grade_id:i.current_grade_id,subject_id:i.current_subject_id,user_id:i.user.id,student_id:t,description:a,id:r?r.id:null}))}return d.a.all(s).then(function(){i.notify("Sucesso!","A avaliação do aluno foi salva com sucesso!","success")}).catch(function(t){i.notify("Erro!","Não foi possível salvar a avaliação do aluno","danger"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.$forceUpdate()})},evaluation_save:function(t){t.preventDefault();var e=this,i=this.$parent,s=t.target,a=e.current_evaluations,r=[];s.querySelectorAll("[data-student_id]").forEach(function(t){var s=t.querySelector("textarea");if(s&&s.value){s=s.value;var a=e.current_student_observations.find(function(e){return e.student_id===parseInt(t.dataset.student_id)});a&&a.description===s||r.push({council_id:i.current_council.id,grade_id:i.current_grade_id,subject_id:i.current_subject_id,user_id:i.user.id,student_id:parseInt(t.dataset.student_id),description:s,id:a?a.id:null})}});var n=s.querySelector("[name=grade_observation]").value;i.loading=!0;var o=[];if(n.length){var c=i.grade_observations.find(function(t){return t.council_id===i.current_council.id&&t.grade_id===i.current_grade_id&&t.subject_id===i.current_subject_id&&t.user_id===i.user.id});c&&!c.description!==n||o.push(i.save_resource("grade_observation",{council_id:i.current_council.id,grade_id:i.current_grade_id,subject_id:i.current_subject_id,user_id:i.user.id,description:n,id:c?c.id:null}))}return a.forEach(function(t){o.push(i.save_resource("evaluation",t,!0,!1))}),r.forEach(function(t){o.push(i.save_resource("student_observation",t))}),d.a.all(o).then(function(){i.notify("Sucesso!",s.dataset.success,"success"),window.onbeforeunload=void 0}).catch(function(t){i.notify("Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){i.loading=!1,e.$forceUpdate()})}},created:function(){var t=this,e=parseInt(this.$route.params.id);this.current_council=this.councils.find(function(t){return t.id===e}),this.current_evaluations=[],this.current_student_observations=[],this.current_student_grades=[],this.current_topics=this.topics.filter(function(e){return void 0!==t.council_topics.find(function(i){return i.topic_id===e.id&&i.council_id===t.current_council.id})}),this.ordered_topic_options=this.topic_options.sort(function(t,e){return ct()(parseInt(t.value)-parseInt(e.value))}),this.current_grade_id="",this.current_subject_id="",this.hide_evaluated_students=!1}},vt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h1",{staticClass:"content-title"},[i("i",{staticClass:"material-icons"},[t._v("edit")]),t._v("Avaliar - "+t._s(t.current_council.name))]),t._v(" "),i("article",{staticClass:"box"},[i("div",{staticClass:"box-body"},[i("form",{attrs:{action:"#","data-success":"Avaliação salva com sucesso","data-error":"Não foi possível salvar a avaliação"},on:{submit:t.evaluation_save}},[i("br"),t._v(" "),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-12 col-md-8 col-lg-6"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"input col-12 col-sm-6"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.current_grade_id,expression:"current_grade_id"}],attrs:{id:"current_grade_id",name:"current_grade_id",required:""},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_grade_id=e.target.multiple?i:i[0]}}},[i("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.grades,function(e){return void 0!==t.teachers.find(function(i){return i.user_id===t.user.id&&i.grade_id===e.id})?i("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))]):t._e()})],2),t._v(" "),i("label",{attrs:{for:"current_grade_id"}},[t._v("Turma")])]),t._v(" "),i("div",{staticClass:"input col-12 col-sm-6"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.current_subject_id,expression:"current_subject_id"}],attrs:{id:"current_subject_id",name:"current_subject_id",required:"",disabled:!t.current_grade_id},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_subject_id=e.target.multiple?i:i[0]}}},[i("option",{attrs:{value:"",hidden:"",disabled:""}},[t._v(t._s(t.current_grade_id?"Selecione...":"Selecione a turma..."))]),t._v(" "),t._l(t.subjectsInGrade,function(e){return t.grade_subjects.find(function(i){return i.subject_id===e.id&&i.grade_id===t.current_grade_id&&t.teachers.find(function(i){return i.user_id===t.user.id&&i.subject_id===e.id&&i.grade_id===t.current_grade_id})})?i("option",{key:e.id,domProps:{selected:1===t.subjectsInGrade.filter(function(e){return t.grade_subjects.find(function(i){return i.subject_id===e.id&&t.teachers.find(function(i){return i.user_id===t.user.id&&i.subject_id===e.id})})}).length,value:e.id}},[t._v(t._s(e.name))]):t._e()})],2),t._v(" "),i("label",{attrs:{for:"current_subject_id"}},[t._v("Disciplina")])])])])]),i("br"),t._v(" "),t.current_subject_id?i("div",[i("div",{staticClass:"text-center"},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.hide_evaluated_students,expression:"hide_evaluated_students"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.hide_evaluated_students)?t._i(t.hide_evaluated_students,null)>-1:t.hide_evaluated_students},on:{change:function(e){var i=t.hide_evaluated_students,s=e.target,a=!!s.checked;if(Array.isArray(i)){var r=t._i(i,null);s.checked?r<0&&(t.hide_evaluated_students=i.concat([null])):r>-1&&(t.hide_evaluated_students=i.slice(0,r).concat(i.slice(r+1)))}else t.hide_evaluated_students=a}}}),t._v(" Mostrar apenas alunos não avaliados\n            ")])]),i("br"),t._v(" "),i("div",{staticClass:"table"},[i("table",[i("thead",[i("tr",[i("th",[t._v("Aluno")]),t._v(" "),t._l(t.current_topics,function(e){return i("th",{key:e.id},[t._v(t._s(e.name))])}),t._v(" "),i("th",[t._v("Observações Gerais")]),t._v(" "),i("th")],2)]),t._v(" "),t.evaluations.length?i("tbody",t._l(t.studentsInGrade,function(e){return t.hide_evaluated_students&&t.studentHasEvaluation(e.id)?t._e():i("tr",{key:e.id,attrs:{"data-student_id":e.id}},[t.hide_evaluated_students||t.studentIsActive(e.id)?t.studentIsActive(e.id)?[i("td",[t._v("\n                    "+t._s(t.studentGrade(e.id).number)+" - "+t._s(e.name)+"\n                    "),t.studentHasEvaluation(e.id)?t._e():i("span",{staticClass:"text-muted"},[t._v(" (não avaliado)")])]),t._v(" "),t._l(t.current_topics,function(s){return i("td",{key:s.id},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.current_evaluations.find(function(t){return t.student_id===e.id&&t.topic_id===s.id}).topic_option_id,expression:"current_evaluations.find(evaluation => evaluation.student_id === student.id && evaluation.topic_id === topic.id).topic_option_id"}],attrs:{required:"","data-topic_id":s.id},on:{change:[function(i){var a=Array.prototype.filter.call(i.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.current_evaluations.find(function(t){return t.student_id===e.id&&t.topic_id===s.id}),"topic_option_id",i.target.multiple?a:a[0])},t.set_confirm_redirect]}},t._l(t.topicOptions(s.id),function(e){return i("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])}))])}),t._v(" "),i("td",[void 0!==t.student_observations.find(function(i){return i.student_id===e.id&&i.grade_id===t.current_grade_id&&i.subject_id===t.current_subject_id&&i.council_id===t.current_council.id&&i.user_id===t.user.id})?i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.student_observations.find(function(i){return i.student_id===e.id&&i.grade_id===t.current_grade_id&&i.subject_id===t.current_subject_id&&i.council_id===t.current_council.id&&i.user_id===t.user.id}).description,expression:"student_observations.find(student_observation => student_observation.student_id === student.id && student_observation.grade_id === current_grade_id && student_observation.subject_id === current_subject_id && student_observation.council_id === current_council.id && student_observation.user_id === user.id).description"}],staticClass:"resize-v",staticStyle:{"min-width":"250px","min-height":"70px"},domProps:{value:t.student_observations.find(function(i){return i.student_id===e.id&&i.grade_id===t.current_grade_id&&i.subject_id===t.current_subject_id&&i.council_id===t.current_council.id&&i.user_id===t.user.id}).description},on:{input:function(i){i.target.composing||t.$set(t.student_observations.find(function(i){return i.student_id===e.id&&i.grade_id===t.current_grade_id&&i.subject_id===t.current_subject_id&&i.council_id===t.current_council.id&&i.user_id===t.user.id}),"description",i.target.value)}}}):i("textarea",{staticClass:"resize-v",staticStyle:{"min-width":"250px","min-height":"70px"},attrs:{placeholder:"Conteúdos não assimilados e ações efetivadas"}})]),t._v(" "),i("td",[i("a",{staticClass:"btn-success btn-sm tooltip tooltip-end",attrs:{type:"button",title:"Salvar avaliação do aluno"},on:{click:function(i){t.student_evaluation_save(e.id)}}},[i("div",{staticClass:"material-icons"},[t._v("check")])])])]:t._e():[i("td",{staticClass:"text-striked"},[t._v(t._s(t.studentGrade(e.id).number)+" - "+t._s(e.name))]),t._v(" "),t._l(t.current_topics,function(e){return i("td",{key:e.id},[t._v("-")])}),t._v(" "),i("td",[t._v("-")]),t._v(" "),i("td",[t._v("-")])]],2)})):t._e()])]),i("br"),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-8"},[void 0!==t.grade_observations.find(function(e){return e.grade_id===t.current_grade_id&&e.subject_id===t.current_subject_id&&e.council_id===t.current_council.id&&e.user_id===t.user.id})?i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.grade_observations.find(function(e){return e.grade_id===t.current_grade_id&&e.subject_id===t.current_subject_id&&e.council_id===t.current_council.id&&e.user_id===t.user.id}).description,expression:"grade_observations.find(grade_observation=> grade_observation.grade_id === current_grade_id && grade_observation.subject_id === current_subject_id && grade_observation.council_id === current_council.id && grade_observation.user_id === user.id).description"}],staticClass:"resize-v",staticStyle:{"min-width":"300px"},attrs:{name:"grade_observation",minlength:"3",placeholder:"Observações da turma"},domProps:{value:t.grade_observations.find(function(e){return e.grade_id===t.current_grade_id&&e.subject_id===t.current_subject_id&&e.council_id===t.current_council.id&&e.user_id===t.user.id}).description},on:{input:function(e){e.target.composing||t.$set(t.grade_observations.find(function(e){return e.grade_id===t.current_grade_id&&e.subject_id===t.current_subject_id&&e.council_id===t.current_council.id&&e.user_id===t.user.id}),"description",e.target.value)}}}):i("textarea",{staticClass:"resize-v",staticStyle:{"min-width":"300px"},attrs:{name:"grade_observation",minlength:"3",placeholder:"Observações da turma"}})]),t._v(" "),t._m(0)])]):i("div",{staticClass:"text-center text-muted"},[i("br"),t._v(" "),i("div",{staticClass:"h4"},[t._v("Selecione uma "+t._s(t.current_grade_id?"disciplina":"turma")+" para avaliar.")]),i("br")])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-4 text-right"},[e("button",{staticClass:"btn-lg btn-success",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v(" Salvar\n              ")])])}]},mt=i("VU/8")(_t,vt,!1,null,null,null).exports;s.a.use(D.a);var ht=new D.a({routes:[{path:"/login",name:"Login",component:U,meta:{title:"Login"}},{path:"/subject",name:"Subject",component:F,meta:{title:"Disciplinas"}},{path:"/topic",name:"Topic",component:B,meta:{title:"Tópicos"}},{path:"/grade",name:"Grade",component:J,meta:{title:"Turmas"}},{path:"/teacher_request",name:"TeacherRequest",component:G,meta:{title:"Turmas"}},{path:"/council",name:"Council",component:X,meta:{title:"Conselhos de Classe"}},{path:"/role",name:"Role",component:tt,meta:{title:"Usuários"}},{path:"/teacher",name:"Teacher",component:st,meta:{title:"Professores"}},{path:"/user",name:"User",component:nt,meta:{title:"Usuário"}},{path:"/report/:id",name:"Report",component:lt,meta:{title:"Relatórios"}},{path:"/evaluate/:id",name:"Evaluate",component:mt,meta:{title:"Avaliar"}},{path:"/",name:"Index",component:P}]});ht.beforeEach(function(t,e,i){var s="Conselho";t.meta.title&&(s+=" - "+t.meta.title),document.title=s,document.location.hash="",i()});var pt=ht;s.a.config.productionTip=!1;new s.a({el:"#app",router:pt,components:{App:I},template:"<App/>"})},VOiu:function(t,e){},cMOQ:function(t,e){},wrcB:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.326393216352e8e47928.js.map