webpackJsonp([1],{"/HwJ":function(t,e){},"9GqY":function(t,e){},JUU2:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s("7+uW"),i=s("mvHQ"),n=s.n(i),a=s("//Fk"),o=s.n(a),c=s("2QDH"),u=s.n(c),d=s("fZjL"),l=s.n(d),_=s("NYxO"),v=new(s("YwQ6").a)("conselho");v.version(1).stores({councils:"id",council_grades:"id",council_topics:"id",evaluations:"id",grades:"id",grade_subjects:"id",grade_observations:"id",medical_reports:"id",medical_report_subjects:"id",permissions:"id",roles:"id",role_types:"id",role_type_permissions:"id",schools:"id",students:"id",student_observations:"id",student_grades:"id",subjects:"id",teachers:"id",teacher_requests:"id",topics:"id",topic_options:"id",users:"id"});var m=v;function h(t){return l()(t).forEach(function(e){null!==t[e]&&void 0!==t[e]&&(t[e].toString()===parseInt(t[e]).toString()?t[e]=parseInt(t[e]):t[e].toString()===parseFloat(t[e]).toString()?t[e]=parseFloat(t[e]):t[e]===!!t[e]&&(t[e]=t[e]?1:0))}),t}r.a.use(_.a);var p=void 0;p=-1!==location.href.indexOf("localhost")||-1!==location.href.indexOf("127.0.0.1")?"http://localhost/conselho-server/":"https://conselho-api.infomec.net.br/";var f=new _.a.Store({state:{councils:[],council_grades:[],council_topics:[],evaluations:[],grades:[],grade_subjects:[],grade_observations:[],medical_reports:[],medical_report_subjects:[],permissions:[],roles:[],role_types:[],role_type_permissions:[],schools:[],students:[],student_observations:[],student_grades:[],subjects:[],teachers:[],teacher_requests:[],topics:[],topic_options:[],users:[],db:m,api_url:p,token:{},logged_in:void 0},mutations:{checkAuth:function(t){t.token=JSON.parse(localStorage.getItem("token")),t.logged_in=t.token&&new Date(t.token.expires_at)>new Date},injectData:function(t,e){l()(e).forEach(function(s){t[s]=e[s]})},pushItem:function(t,e){var s=e.name,r=e.data;t[s].push(r)},updateItem:function(t,e){var s=e.name,i=e.data,n=t[s].findIndex(function(t){return t.id===i.id});if(n<0)throw new Error("Tried to update "+s+", but id "+i.id+" was not found.");r.a.set(t[s],n,i)},deleteItem:function(t,e){var s=e.name,i=e.id,n=t[s].findIndex(function(t){return t.id===i});if(n<0)throw new Error("Tried to delete "+s+", but id "+i+" was not found.");r.a.delete(t[s],n)}},actions:{loadData:function(t){var e=t.state.db,s={},r=[];return r.push(e.users.toArray().then(function(t){s.users=t.sort(function(t,e){return t.name.localeCompare(e.name,"pt-BR",{ignorePunctuation:!0})})})),r.push(e.grades.toArray().then(function(t){s.grades=t.sort(function(t,e){return t.name.localeCompare(e.name,"pt-BR",{ignorePunctuation:!0})})})),r.push(e.subjects.toArray().then(function(t){s.subjects=t.sort(function(t,e){return t.name.localeCompare(e.name,"pt-BR",{ignorePunctuation:!0})})})),r.push(e.topic_options.toArray().then(function(t){s.topic_options=t.sort(function(t,e){return u()(e.value-t.value)})})),r.push(e.councils.toArray().then(function(t){s.councils=t})),r.push(e.council_grades.toArray().then(function(t){s.council_grades=t})),r.push(e.council_topics.toArray().then(function(t){s.council_topics=t})),r.push(e.evaluations.toArray().then(function(t){s.evaluations=t})),r.push(e.grade_subjects.toArray().then(function(t){s.grade_subjects=t})),r.push(e.grade_observations.toArray().then(function(t){s.grade_observations=t})),r.push(e.medical_reports.toArray().then(function(t){s.medical_reports=t})),r.push(e.medical_report_subjects.toArray().then(function(t){s.medical_report_subjects=t})),r.push(e.permissions.toArray().then(function(t){s.permissions=t})),r.push(e.roles.toArray().then(function(t){s.roles=t})),r.push(e.role_types.toArray().then(function(t){s.role_types=t})),r.push(e.role_type_permissions.toArray().then(function(t){s.role_type_permissions=t})),r.push(e.schools.toArray().then(function(t){s.schools=t})),r.push(e.students.toArray().then(function(t){s.students=t})),r.push(e.student_observations.toArray().then(function(t){s.student_observations=t})),r.push(e.student_grades.toArray().then(function(t){s.student_grades=t})),r.push(e.teachers.toArray().then(function(t){s.teachers=t})),r.push(e.teacher_requests.toArray().then(function(t){s.teacher_requests=t})),r.push(e.topics.toArray().then(function(t){s.topics=t})),o.a.all(r).then(function(){t.commit("injectData",s)})},loadFromAPI:function(t){var e=t.state.db,s=[];return window.localStorage.removeItem("has_loaded_data"),e.tables.forEach(function(e){var r=e.name.slice(0,-1),i=t.dispatch("get_resource",r).then(function(t){return e.clear().then(function(){return e.bulkPut(t.map(function(t){return h(t)}))})});s.push(i)}),o.a.all(s).then(function(){window.localStorage.setItem("has_loaded_data","1")})},api_fetch:function(t,e){var s=e.path,r=e.method,i=e.body,a=e.headers;void 0===r&&(r="GET"),i?i.school_id=1:i={school_id:1},"GET"===r||"DELETE"===r?void 0!==i&&(s+="?"+function(t){var e=[];for(var s in t)t.hasOwnProperty(s)&&e.push(encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return e.join("&")}(i),i=void 0):(i=h(i),i=n()(i)),void 0===a&&(a={}),(a=new Headers(a)).set("Timezone","-03:00"),a.set("Accept","application/json; charset=UTF-8"),a.set("Content-Type","application/json"),!a.has("Token")&&t.state.token&&t.state.token.value&&a.set("Token",t.state.token.value);var o=t.state.api_url+s;return fetch(o,{headers:a,method:r,mode:"cors",body:i}).then(function(t){if(!t.ok)throw t;return t})},get_resource:function(t,e){return t.dispatch("api_fetch",{path:e}).then(function(t){return t.json()}).then(function(s){var r=s.results,i=parseInt(s.max_results_per_page),n=parseInt(s.total_results),a=Math.floor(n/i);if(n===i||!a)return r;for(var c=[],u=1;u<=a;u++)c.push(t.dispatch("api_fetch",{path:e,method:"GET",body:{page:u+1}}).then(function(t){return t.json()}));return o.a.all(c).then(function(t){return t.forEach(function(t){r=r.concat(t.results)}),r})})},db_put:function(t,e){var s=e.name,r=e.data;return t.state.db[s].put(r)},save_resource:function(t,e){var s=e.resource_name,r=e.data,i=e.save_to_db,n=e.update_view,a=e.headers;void 0!==i&&console.warn('The option "save_to_db" of the "save_resource" function is deprecated.'),void 0!==n&&console.warn('The option "update_view" of the "save_resource" function is deprecated.');var o=s,c="POST";return r.id?(o+="/"+r.id,c="PATCH"):delete r.id,t.dispatch("api_fetch",{path:o,method:c,body:r,headers:a}).then(function(t){return t.json()}).then(function(e){return e.id&&(r.id=parseInt(e.id)),e.created_at&&(r.created_at=e.created_at),e.updated_at&&(r.updated_at=e.updated_at),r=h(r),t.state.db[s+"s"].put(r)}).then(function(){var e="PATCH"===c?"updateItem":"pushItem";return t.commit(e,{name:s+"s",data:r}),r})},delete_resource:function(t,e){var s=e.resource_name,r=e.id,i=e.notification,n=e.reload_view;void 0!==i&&console.warn('The "notification" option of the "delete_resource" is deprecated'),void 0!==n&&console.warn('The "reload_view" option of the "delete_resource" is deprecated');var a={path:s+"/"+r,method:"DELETE"};return t.dispatch("api_fetch",a).then(function(){return t.state.db[s+"s"].delete(r)}).then(t.commit("deleteItem",{name:s+"s",id:r}))},login:function(t,e){var s={path:"user_token",method:"POST",body:{email:e.email,password:e.password}};return t.dispatch("api_fetch",s).then(function(t){return t.json()}).then(function(e){localStorage.setItem("token",n()(e)),t.commit("checkAuth")})},logout:function(t){localStorage.removeItem("token"),localStorage.removeItem("has_loaded_data"),t.commit("checkAuth");var e=[];return t.state.db.tables.forEach(function(t){e.push(t.clear())}),o.a.all(e)}}}),b=s("/ocq"),g={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("home")]),this._v("Página Inicial")])])])])}]},C=s("VU/8")({name:"Index"},g,!1,null,null,null).exports,y={name:"Login",methods:{login:function(t){var e=this;this.$emit("loading");var s=t.target,r={email:s.querySelector("[name=email]").value,password:s.querySelector("[name=password]").value};return this.$store.dispatch("login",r).then(function(){return e.$store.dispatch("loadFromAPI")}).then(function(){return e.$store.dispatch("loadData")}).then(function(){e.$emit("loaded"),e.$router.push("/")}).catch(function(t){e.$emit("loaded"),e.$emit("notify","Erro","Não foi possível fazer login. Tente novamente!","danger"),console.log("Error:",t)})}}},$={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-12 col-sm-10 col-md-8 col-lg-7 col-xlg-6"},[s("article",{staticClass:"box"},[s("div",{staticClass:"box-body"},[s("form",{attrs:{action:"#",method:"POST"},on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[s("br"),t._v(" "),t._m(1),s("br")])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("lock")]),this._v("Login")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-11"},[s("div",{staticClass:"input"},[s("input",{attrs:{name:"email",required:"",type:"email",id:"email"}}),t._v(" "),s("label",{attrs:{for:"email"}},[s("div",{staticClass:"material-icons"},[t._v("email")]),t._v(" E-mail\n                  ")])]),t._v(" "),s("div",{staticClass:"input"},[s("input",{attrs:{name:"password",required:"",type:"password",id:"password"}}),t._v(" "),s("label",{attrs:{for:"password"}},[s("div",{staticClass:"material-icons"},[t._v("vpn_key")]),t._v(" Senha\n                  ")])]),t._v(" "),s("div",{staticClass:"text-right"},[s("button",{staticClass:"btn-success btn-lg",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v(" Entrar\n                  ")])])])])}]},j=s("VU/8")(y,$,!1,null,null,null).exports,w={name:"TeacherRequest",data:function(){return{current_teacher_requests:[],current_user_teachers:[],current_user_id:void 0,current_grade_id:"",current_subject_id:"",current_subjects:[],current_teachers:[]}},watch:{current_grade_id:function(){var t=this;if(!this.current_grade_id)return this.current_subject_id="",this.current_subjects=[],void(this.current_teachers=[]);var e=this.$store.state.grade_subjects.filter(function(e){return e.grade_id===t.current_grade_id});this.current_subjects=this.$store.state.subjects.filter(function(t){return e.find(function(e){return e.subject_id===t.id})}),this.current_teachers=this.$store.state.teachers.filter(function(e){return e.grade_id===t.current_grade_id})}},methods:{teacher_request_save:function(t){var e=this;this.$emit("loading");var s=t.target,r={resource_name:"teacher_request",data:{grade_id:this.current_grade_id,subject_id:this.current_subject_id,user_id:this.current_user_id}};this.$store.dispatch("save_resource",r).then(function(t){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.current_teacher_requests.push(t),e.current_subject_id=""}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},teacher_request_delete:function(){var t=this;this.$emit("loading");var e={resource_name:"teacher_request",id:this.current_teacher_request_id};this.$store.dispatch("delete_resource",e).then(function(){t.$emit("notify","Sucesso!","Desvinculado da turma com sucesso.","success");var e=t.current_teacher_requests.findIndex(function(e){return e.id===t.current_teacher_request_id});t.$delete(t.current_teacher_requests,e)}).finally(function(){return t.$emit("loaded")})}},created:function(){var t=this;this.current_user_id=this.$store.state.token.user_id,this.current_teacher_requests=this.$store.state.teacher_requests.filter(function(e){return e.user_id===t.current_user_id}),this.current_user_teachers=this.$store.state.teachers.filter(function(e){return e.user_id===t.current_user_id}),this.current_grade_id="",this.current_subject_id="",this.current_subjects=[],this.current_teachers=[]}},x={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),t._v(" "),s("article",{staticClass:"box"},[s("div",{staticClass:"box-body"},[s("br"),t._v(" "),s("form",{attrs:{action:"#","data-success":"Aguardando a aprovação do supervisor!","data-error":"Não foi possível cadastrar"},on:{submit:function(e){return e.preventDefault(),t.teacher_request_save(e)}}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-12 col-md-9"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"input col-6 col-sm-4"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.current_grade_id,expression:"current_grade_id"}],attrs:{id:"current_grade_id",name:"grade_id",required:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_grade_id=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.$store.state.grades,function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),s("label",{attrs:{for:"current_grade_id"}},[t._v("Turma")])]),t._v(" "),s("div",{staticClass:"input col-6 col-sm-4"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.current_subject_id,expression:"current_subject_id"}],attrs:{id:"current_subject_id",name:"subject_id",required:"",disabled:!t.current_grade_id},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_subject_id=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v(t._s(t.current_grade_id?"Selecione...":"Selecione a turma..."))]),t._v(" "),t._l(t.current_subjects,function(e){return s("option",{key:e.id,attrs:{disabled:t.current_teachers.find(function(t){return t.subject_id===e.id})||t.current_teacher_requests.find(function(s){return s.grade_id===t.current_grade_id&&s.subject_id===e.id})},domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),s("label",{attrs:{for:"current_subject_id"}},[t._v("Disciplina")])]),t._v(" "),t._m(1)])])])]),s("br"),t._v(" "),t.current_user_teachers.length||t.current_teacher_requests.length?s("table",{staticClass:"table"},[t._m(2),t._v(" "),s("tbody",[t._l(t.current_teacher_requests,function(e){return s("tr",{key:"teacher_request-"+e.id},[s("td",[t._v(t._s(t.$store.state.grades.find(function(t){return t.id===e.grade_id}).name))]),t._v(" "),s("td",[t._v(t._s(t.$store.state.subjects.find(function(t){return t.id===e.subject_id}).name))]),t._v(" "),s("td",{staticClass:"text-muted"},[t._v("Aguardando aprovação")]),t._v(" "),s("td",{staticClass:"text-right no-wrap"},[s("a",{staticClass:"btn-danger btn-sm tooltip tooltip-end",attrs:{href:"#modal-delete-teacher_request",title:"Remover"},on:{click:function(s){t.current_teacher_request_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("delete")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Remover")])])])])}),t._v(" "),t._l(t.current_user_teachers,function(e){return s("tr",{key:"teacher-"+e.id},[s("td",[t._v(t._s(t.$store.state.grades.find(function(t){return t.id===e.grade_id}).name))]),t._v(" "),s("td",[t._v(t._s(t.$store.state.subjects.find(function(t){return t.id===e.subject_id}).name))]),t._v(" "),s("td"),t._v(" "),t._m(3,!0)])})],2)]):s("div",{staticClass:"text-center text-muted"},[s("br"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Você ainda não está vinculado à nenhuma turma.")]),t._v(" "),t._m(4),s("br")])])]),t._v(" "),s("prompt",{attrs:{title:"Fale com o supervisor",type:"danger",anchor:"modal-delete-teacher"}},[s("p",[t._v("Você não pode se desvincular desta turma, pois já recebeu a aprovação do supervisor.")]),t._v(" "),s("p",[t._v("Caso seja realmente necessário, solicite ao supervisor que te desvincule.")])]),t._v(" "),s("prompt",{attrs:{title:"Remover solicitação",type:"danger",anchor:"modal-delete-teacher_request",accept:"Remover"},on:{accept:t.teacher_request_delete}},[s("p",[t._v("Tem certeza que deseja remover esta solicitação?")])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("people")]),this._v("Turmas")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-12 col-sm-3"},[e("br",{staticClass:"d-none d-sm-inline"}),this._v(" "),e("button",{staticClass:"btn-success",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v(" Salvar\n                ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Turma")]),this._v(" "),e("th",[this._v("Disciplina")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("td",{staticClass:"text-right no-wrap"},[e("a",{staticClass:"btn-danger btn-sm tooltip tooltip-end",attrs:{href:"#modal-delete-teacher",title:"Remover"}},[e("div",{staticClass:"material-icons"},[this._v("delete")]),this._v(" "),e("span",{staticClass:"d-none d-md-inline"},[this._v("Remover")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Selecione uma turma e uma disciplina e clique em "),e("b",[this._v("salvar")]),this._v(" para poder avaliar.")])}]},E=s("VU/8")(w,x,!1,null,null,null).exports,S={name:"Subject",data:function(){return{current_subject_id:void 0,current_subject:{}}},watch:{current_subject_id:function(){var t=this;this.current_subject_id?this.current_subject=this.$store.state.subjects.find(function(e){return e.id===t.current_subject_id}):this.current_subject={}}},methods:{subject_save:function(t){var e=this;this.$emit("loading");var s=t.target,r={resource_name:"subject",data:{name:s.querySelector("[name=name]").value,active:!0}};return this.$store.dispatch("save_resource",r).then(function(){s.querySelector("[name=name]").value="",e.$emit("notify","Sucesso!",s.dataset.success,"success")}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t.stack)}).finally(function(){e.$emit("loaded")})},subject_update:function(t){var e=this;this.$emit("loading");var s=t.target,r={resource_name:"subject",data:{id:this.current_subject_id,name:s.querySelector("[name=name]").value,active:!!s.querySelector("[name=active]").checked}};return this.$store.dispatch("save_resource",r).then(function(t){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.$refs.modalEdit.close(),e.current_subject=t}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})}},created:function(){this.current_subject_id="",this.current_subject={}}},k={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),t._v(" "),s("article",{staticClass:"box"},[s("div",{staticClass:"box-body"},[t.$store.state.subjects.length?s("table",{staticClass:"table"},[t._m(1),t._v(" "),s("tbody",t._l(t.$store.state.subjects,function(e){return s("tr",{key:e.id},[s("td",{class:parseInt(e.active)?"":"text-muted"},[t._v("\n              "+t._s(e.name)+" "),parseInt(e.active)?t._e():s("span",{staticClass:"text-muted"},[t._v("(invisível)")])]),t._v(" "),s("td",{staticClass:"text-right no-wrap"},[s("a",{staticClass:"btn-warning btn-sm tooltip tooltip-end",attrs:{href:"#modal-edit",title:"Editar disciplina"},on:{click:function(s){t.current_subject_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("edit")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Editar")])])])])}))]):s("div",{staticClass:"text-center text-muted"},[s("br"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Ainda não há nenhuma disciplina cadastrada")]),s("br")])])]),t._v(" "),s("modal",{ref:"modalNew",attrs:{anchor:"modal-new",title:"Nova disciplina"}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-success":"Disciplina cadastrada com sucesso","data-error":"Não foi possível cadastrar a disciplina"},on:{submit:function(e){return e.preventDefault(),t.subject_save(e)}}},[s("input",{attrs:{type:"hidden",name:"active",value:"1"}}),s("br"),t._v(" "),s("div",{staticClass:"input"},[s("input",{attrs:{required:"",name:"name",placeholder:"Ex.: Matemática"}}),t._v(" "),s("label",[t._v("Nome")])]),t._v(" "),s("br"),t._v(" "),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v(" Cancelar\n          ")]),t._v(" "),s("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("  Salvar\n          ")]),t._v(" "),s("br")])])])]),t._v(" "),s("modal",{ref:"modalEdit",attrs:{anchor:"modal-edit",title:"Editar disciplina"}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-success":"Disciplina editada com sucesso","data-error":"Não foi possível editar a disciplina"},on:{submit:function(e){return e.preventDefault(),t.subject_update(e)}}},[s("br"),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"input col-12 col-sm-8"},[s("input",{attrs:{required:"",name:"name",placeholder:"Ex.: Matemática",minlength:"3"},domProps:{value:t.current_subject.name}}),t._v(" "),s("label",[t._v("Nome")])]),t._v(" "),s("div",{staticClass:"col-12 col-sm-4"},[s("label",[s("br"),t._v(" "),s("input",{attrs:{name:"active",type:"checkbox"},domProps:{value:1,checked:parseInt(t.current_subject.active)}}),t._v("Visível\n              ")])])]),t._v(" "),s("br"),t._v(" "),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v(" Cancelar\n          ")]),t._v(" "),s("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("  Salvar\n          ")]),s("br")])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("book")]),this._v("Disciplinas")])]),this._v(" "),e("div",{staticClass:"col text-right"},[e("a",{staticClass:"btn-success btn-sm no-wrap",attrs:{href:"#modal-new"}},[e("div",{staticClass:"material-icons"},[this._v("add")]),this._v(" Criar nova disciplina")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")])])])}]},q=s("VU/8")(S,k,!1,null,null,null).exports,N={name:"Topic",data:function(){return{current_topic_id:void 0,current_topic:{},current_topic_options:[],current_topic_option_index:void 0,new_topic_options:[{},{}]}},watch:{current_topic_id:function(){var t=this;if(!this.current_topic_id)return this.current_topic={},void(this.current_topic_options=[]);this.current_topic=JSON.parse(n()(this.$store.state.topics.find(function(e){return e.id===t.current_topic_id}))),this.current_topic_options=JSON.parse(n()(this.$store.state.topic_options.filter(function(e){return e.topic_id===t.current_topic_id})))}},methods:{topic_save:function(t){var e=this;this.$emit("loading");var s=t.target,r={name:s.querySelector("[name=name]").value,active:!0,topic_option_id:null},i=s.querySelectorAll('[name="option_name[]"]'),n=[].map.call(i,function(t){return t.value}),a=s.querySelectorAll('[name="option_value[]"]'),c=[].map.call(a,function(t){return t.value}),u=s.querySelectorAll('[name="option_default"]'),d=[].map.call(u,function(t){return t.checked}).indexOf(!0),l=[];n.forEach(function(t,e){l.push({name:t,value:c[e],active:!0})});var _={resource_name:"topic",data:r};return this.$store.dispatch("save_resource",_).then(function(t){r.id=t.id;var s=[];return l.forEach(function(r){r.topic_id=t.id;var i={resource_name:"topic_option",data:r},n=e.$store.dispatch("save_resource",i);s.push(n)}),o.a.all(s)}).then(function(t){if(-1!==d){r.topic_option_id=t[d].id;var s={resource_name:"topic",data:r};return e.$store.dispatch("save_resource",s)}}).then(function(){e.$emit("notify","Sucesso!",s.dataset.success,"success"),s.querySelector("[name=name]").value="",e.new_topic_options=[{},{}]}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},topic_update:function(t){var e=this;this.$emit("loading");var s=t.target,r={id:this.current_topic_id,name:s.querySelector("[name=name]").value,active:s.querySelector("[name=active]").checked,topic_option_id:this.current_topic.topic_option_id},i={resource_name:"topic",data:r};return this.$store.dispatch("save_resource",i).then(function(){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.$refs.modalEdit.close(),e.current_topic=r}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},topic_options_update:function(t){var e=this;this.$emit("loading");var s=t.target,r=[];return this.current_topic_options.forEach(function(t){var s={resource_name:"topic_option",data:t},i=e.$store.dispatch("save_resource",s);r.push(i)}),o.a.all(r).then(function(){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.current_topic_options=JSON.parse(n()(e.$store.state.topic_options.filter(function(t){return t.topic_id===e.current_topic_id})))}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},update_default_option:function(t){var e=this;this.$emit("loading");var s=event.target,r={id:this.current_topic_id,name:this.current_topic.name,active:this.current_topic.active,topic_option_id:t},i={resource_name:"topic",data:r};return this.$store.dispatch("save_resource",i).then(function(){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.current_topic=r}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},newTopicOption:function(){var t={topic_id:this.current_topic_id,active:!0};t.topic_id?this.current_topic_options.push(t):this.new_topic_options.push(t),this.$nextTick(function(){var t=document.querySelectorAll('input[name="option_name[]"]');t[t.length-1].focus()})}},created:function(){this.current_topic_id=void 0,this.current_topic={},this.current_topic_options=[],this.current_topic_option_index=void 0,this.new_topic_options=[{},{}]}},A={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),t._v(" "),s("article",{staticClass:"box"},[s("div",{staticClass:"box-body"},[t.$store.state.topics.length?s("table",{staticClass:"table"},[t._m(1),t._v(" "),s("tbody",t._l(t.$store.state.topics,function(e){return s("tr",{key:e.id},[s("td",{class:parseInt(e.active)?"":"text-muted"},[t._v("\n            "+t._s(e.name)+"\n            "),parseInt(e.active)?t._e():s("span",{staticClass:"text-muted"},[t._v("(invisível)")])]),t._v(" "),s("td",{staticClass:"text-right no-wrap"},[s("a",{staticClass:"btn-warning btn-sm tooltip tooltip-end",attrs:{href:"#modal-edit",title:"Editar tópico"},on:{click:function(s){t.current_topic_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("edit")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Editar")])]),t._v(" "),s("a",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{href:"#modal-topic_options",title:"Opções de resposta"},on:{click:function(s){t.current_topic_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("list")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Opções")])])])])}))]):s("div",{staticClass:"text-center text-muted"},[s("br"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Ainda não há nenhum tópico cadastrado")]),s("br")])])]),t._v(" "),s("modal",{ref:"modalNew",attrs:{anchor:"modal-new",title:"Criar novo tópico"}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-success":"Tópico cadastrado com sucesso","data-error":"Não foi possível cadastrar o tópico"},on:{submit:function(e){return e.preventDefault(),t.topic_save(e)}}},[s("br"),t._v(" "),s("div",{staticClass:"input"},[s("input",{attrs:{required:"",placeholder:"Ex.: Tarefas de casa",name:"name",minlength:"3"}}),t._v(" "),s("label",[t._v("Nome")])]),t._v(" "),s("hr"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Opções de resposta")]),t._v(" "),s("table",{staticClass:"table"},[s("thead",[s("tr",[s("th",[t._v("Nome")]),t._v(" "),s("th",{staticClass:"no-wrap"},[t._v("Valor (0-100)")]),t._v(" "),s("th",{staticClass:"text-center"},[t._v("Padrão")])])]),t._v(" "),s("tbody",t._l(t.new_topic_options,function(e,r){return s("tr",{key:e.id},[s("td",[s("div",{staticClass:"input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"topic_option.name"}],staticStyle:{margin:"0px"},attrs:{required:"",placeholder:"Ex.: Excelente",name:"option_name[]",minlength:"3"},domProps:{value:e.name},on:{input:function(s){s.target.composing||t.$set(e,"name",s.target.value)}}})])]),t._v(" "),s("td",[s("div",{staticClass:"input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"topic_option.value"}],staticStyle:{margin:"0px"},attrs:{required:"",type:"number",min:"0",max:"100",placeholder:"0 - 100",name:"option_value[]"},domProps:{value:e.value},on:{input:function(s){s.target.composing||t.$set(e,"value",s.target.value)}}})])]),t._v(" "),s("td",{staticClass:"text-center"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.default,expression:"topic_option.default"}],attrs:{type:"radio",name:"option_default",value:"1",required:""},domProps:{checked:t._q(e.default,"1")},on:{change:function(s){t.$set(e,"default","1")}}})]),t._v(" "),s("td",{staticClass:"text-right",staticStyle:{"margin-top":"-2px"}},[s("button",{staticClass:"btn-danger tooltip tooltip-end",staticStyle:{margin:"0px 2px"},attrs:{title:"Remover opção de resposta",disabled:t.new_topic_options.length<=2,type:"button"},on:{click:function(e){t.new_topic_options.splice(r,1)}}},[s("div",{staticClass:"material-icons"},[t._v("delete")]),s("span",{staticClass:"d-none d-md-inline"},[t._v(" Remover")])])])])}))]),t._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn-primary tooltip",attrs:{title:"Criar uma nova opção de resposta para este tópico",type:"button"},on:{click:t.newTopicOption}},[s("div",{staticClass:"material-icons"},[t._v("add")]),t._v("Criar nova opção\n            ")])]),s("br"),s("br"),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v("  Cancelar")]),t._v(" "),s("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("  Salvar\n          ")]),s("br")])])])]),t._v(" "),s("modal",{ref:"modalEdit",attrs:{anchor:"modal-edit",title:"Editar tópico"}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-success":"Tópico editado com sucesso","data-error":"Não foi possível editar o tópico"},on:{submit:function(e){return e.preventDefault(),t.topic_update(e)}}},[s("br"),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-8"},[s("div",{staticClass:"input"},[s("input",{attrs:{required:"",placeholder:"Ex.: Tarefas de casa",name:"name",minlength:"3"},domProps:{value:t.current_topic.name}}),t._v(" "),s("label",[t._v("Nome")])])]),t._v(" "),s("div",{staticClass:"col-4"},[s("br"),t._v(" "),s("label",[s("input",{attrs:{type:"checkbox",name:"active",value:"1"},domProps:{checked:parseInt(t.current_topic.active)}}),t._v(" Visível\n              ")])])]),t._v(" "),s("br"),s("br"),t._v(" "),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v("\n            Cancelar\n          ")]),t._v(" "),s("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("\n            Salvar\n          ")]),t._v(" "),s("br")])])])]),t._v(" "),s("modal",{ref:"modalTopicOptions",attrs:{anchor:"modal-topic_options",title:"Editar opções de resposta"}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-success":"Opções editadas com sucesso","data-error":"Não foi possível editar as opções de resposta"},on:{submit:function(e){return e.preventDefault(),t.topic_options_update(e)}}},[s("br"),t._v(" "),s("table",{staticClass:"table"},[s("thead",[s("tr",[s("th",[t._v("Nome")]),t._v(" "),s("th",[t._v("Valor (0-100)")]),t._v(" "),s("th",{staticClass:"text-center"},[t._v("Padrão")])])]),t._v(" "),s("tbody",t._l(t.current_topic_options,function(e){return s("tr",{key:e.id},[s("td",[s("div",{staticClass:"input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"topic_option.name"}],staticStyle:{margin:"0px"},attrs:{required:"",placeholder:"Ex.: Excelente",name:"option_name[]",minlength:"3"},domProps:{value:e.name},on:{input:function(s){s.target.composing||t.$set(e,"name",s.target.value)}}})])]),t._v(" "),s("td",[s("div",{staticClass:"input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"topic_option.value"}],staticStyle:{margin:"0px"},attrs:{required:"",type:"number",min:"0",max:"100",placeholder:"0 - 100",name:"option_value[]"},domProps:{value:e.value},on:{input:function(s){s.target.composing||t.$set(e,"value",s.target.value)}}})])]),t._v(" "),s("td",{staticClass:"text-center"},[e.id?[t.current_topic.topic_option_id===e.id?s("button",{staticClass:"btn btn-sm btn-success disabled tooltip tooltip-end",attrs:{type:"button",title:"Esta já é a opção padrão"}},[s("span",{staticClass:"material-icons"},[t._v("check")])]):s("button",{staticClass:"btn btn-sm btn-warning tooltip tooltip-end",attrs:{type:"button",title:"Tornar esta a opção padrão"},on:{click:function(s){t.update_default_option(e.id)}}},[s("span",{staticClass:"material-icons"},[t._v("close")])])]:t._e()],2)])}))]),t._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn-primary tooltip",attrs:{type:"button",title:"Criar uma nova opção de resposta para este tópico"},on:{click:t.newTopicOption}},[s("div",{staticClass:"material-icons"},[t._v("add")]),t._v("Criar nova opção\n            ")])]),t._v(" "),s("br"),s("br"),t._v(" "),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v("\n            Cancelar\n          ")]),t._v(" "),s("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("\n            Salvar\n          ")]),t._v(" "),s("br")])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("list")]),this._v("Tópicos")])]),this._v(" "),e("div",{staticClass:"col text-right"},[e("a",{staticClass:"btn-success btn-sm no-wrap",attrs:{href:"#modal-new"}},[e("div",{staticClass:"material-icons"},[this._v("add")]),this._v("\n        Criar novo tópico\n      ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")])])])}]},T=s("VU/8")(N,A,!1,null,null,null).exports,P={name:"Grade",data:function(){return{current_grade_id:void 0,current_grade:{},current_grade_subjects:[],current_student_grades:[],current_students:[],current_subjects:[]}},watch:{current_grade_id:function(){var t=this;if(!this.current_grade_id)return this.current_grade={},this.current_grade_subjects=[],this.current_student_grades=[],this.current_students=[],void(this.current_subjects=[]);this.current_grade=this.$store.state.grades.find(function(e){return e.id===t.current_grade_id}),this.current_grade_subjects=this.$store.state.grade_subjects.filter(function(e){return e.grade_id===t.current_grade_id}),this.current_subjects=this.$store.state.subjects.filter(function(e){return t.current_grade_subjects.find(function(t){return t.subject_id===e.id})}),this.current_student_grades=this.$store.state.student_grades.filter(function(e){return e.grade_id===t.current_grade_id}),this.current_students=this.$store.state.students.filter(function(e){return t.studentGrade(e.id)}).sort(function(e,s){return u()(t.studentGrade(e.id).number-t.studentGrade(s.id).number)})}},methods:{studentGrade:function(t){return this.current_student_grades.find(function(e){return e.student_id===t})},grade_save:function(t){var e=this;this.$emit("loading");var s=t.target,r=s.querySelectorAll('[name="grade_subject[]"]:checked'),i=[].map.call(r,function(t){return t.value}),n={resource_name:"grade",data:{name:s.querySelector("[name=name]").value,level:s.querySelector("[name=level]").value,active:!0}};return this.$store.dispatch("save_resource",n).then(function(t){var s=[];return i.forEach(function(r){var i={resource_name:"grade_subject",data:{subject_id:r,grade_id:t.id}},n=e.$store.dispatch("save_resource",i);s.push(n)}),o.a.all(s)}).then(function(){e.$emit("notify","Sucesso!",s.dataset.success,"success"),s.querySelector("[name=name]").value="",s.querySelector("[name=level]").value="",r.forEach(function(t){t.checked=!1}),e.$refs.modalNew.close()}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},grade_update:function(t){var e=this;this.$emit("loading");var s=t.target,r={resource_name:"grade",data:{id:this.current_grade_id,name:s.querySelector("[name=name]").value,level:s.querySelector("[name=level]").value,active:s.querySelector("[name=active]").checked}};return this.$store.dispatch("save_resource",r).then(function(t){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.$refs.modalEdit.close(),e.current_grade=t}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},student_save:function(t){var e=this;this.$emit("loading");var s=t.target,r={grade_id:this.current_grade_id,number:s.querySelector("[name=number]").value,start_date:"2018-01-01",end_date:"2018-12-31"},i={resource_name:"student",data:{name:s.querySelector("[name=name]").value,active:!0}};return this.$store.dispatch("save_resource",i).then(function(t){e.current_students.push(t),r.student_id=t.id;var s={resource_name:"student_grade",data:r};return e.$store.dispatch("save_resource",s)}).then(function(t){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.current_student_grades.push(t),e.current_students=e.current_students.sort(function(t,s){return u()(e.studentGrade(t.id).number-e.studentGrade(s.id).number)})}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},student_toggle:function(t){var e=this;this.$emit("loading");var s=this.studentGrade(t);s.end_date=new Date(s.end_date)<=new Date?"2018-12-31":(new Date).toISOString().slice(0,10);var r={resource_name:"student_grade",data:s};return this.$store.dispatch("save_resource",r).then(function(t){var s=void 0;s="2018-12-31"===t.end_date?"Estudante desativado com sucesso":"Estudante ativado com sucesso",e.$emit("notify","Sucesso!",s,"success");var r=e.current_student_grades.findIndex(function(e){return e.id===t.id});e.$set(e.current_student_grades,r,t)}).catch(function(t){var r=void 0;r="2018-12-31"===s.end_date?"Não foi possível desativar o estudante":"Não foi possível ativar o estudante",e.$emit("notify","Erro!",r,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},grade_subject_save:function(t){var e=this;this.$emit("loading");var s=t.target,r={resource_name:"grade_subject",data:{grade_id:this.current_grade_id,subject_id:s.querySelector("[name=subject_id]").value}};this.$store.dispatch("save_resource",r).then(function(t){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.current_grade_subjects.push(t);var r=e.$store.state.subjects.find(function(e){return e.id===t.subject_id});e.current_subjects.push(r),s.querySelector("[name=subject_id]").value=""}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},student_update:function(t){var e=this,s=document.querySelector('[data-student_id="'+t+'"]');this.$emit("loading");var r=[],i={resource_name:"student",data:{id:t,name:s.querySelector("[name=name]").value}};r.push(this.$store.dispatch("save_resource",i).then(function(t){var s=e.current_students.findIndex(function(e){return e.id===t.id});e.$set(e.current_students,s,t)})),i={resource_name:"student_grade",data:{id:this.studentGrade(t).id,student_id:t,grade_id:this.current_grade_id,number:s.querySelector("[name=number]").value}},r.push(this.$store.dispatch("save_resource",i).then(function(t){var s=e.current_student_grades.findIndex(function(e){return e.id===t.id});e.$set(e.current_student_grades,s,t)})),o.a.all(r).then(function(){e.$emit("notify","Sucesso!","Aluno editado com sucesso!","success"),e.current_students=e.current_students.sort(function(t,s){return u()(e.studentGrade(t.id).number-e.studentGrade(s.id).number)})}).catch(function(t){e.$emit("notify","Erro!","Não foi possível editar o aluno!","error"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})}},created:function(){this.current_grade_id=void 0,this.current_grade={},this.current_grade_subjects=[],this.current_student_grades=[],this.current_students=[],this.current_subjects=[]}},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),t._v(" "),s("article",{staticClass:"box"},[s("div",{staticClass:"box-body"},[t.$store.state.grades.length?s("table",{staticClass:"table"},[t._m(1),t._v(" "),s("tbody",t._l(t.$store.state.grades,function(e){return s("tr",{key:e.id},[s("td",{class:parseInt(e.active)?"":"text-muted"},[t._v("\n              "+t._s(e.name)+"\n              "),parseInt(e.active)?t._e():s("span",{staticClass:"text-muted"},[t._v("(invisível)")])]),t._v(" "),s("td",{staticClass:"text-right no-wrap"},[s("a",{staticClass:"btn-warning btn-sm tooltip tooltip-end",attrs:{href:"#modal-edit",title:"Editar informações da turma"},on:{click:function(s){t.current_grade_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("edit")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Editar")])]),t._v(" "),s("a",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{href:"#modal-students",title:"Estudantes"},on:{click:function(s){t.current_grade_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("person")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Estudantes")])]),t._v(" "),s("a",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{href:"#modal-subjects",title:"Disciplinas"},on:{click:function(s){t.current_grade_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("book")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Disciplinas")])])])])}))]):s("div",{staticClass:"text-center text-muted"},[s("br"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Ainda não há nenhuma turma cadastrada")]),s("br")])])]),t._v(" "),s("modal",{ref:"modalNew",attrs:{anchor:"modal-new",title:"Nova turma"}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-resource":"grade","data-success":"Turma cadastrada com sucesso","data-error":"Não foi possível cadastrar a turma"},on:{submit:function(e){return e.preventDefault(),t.grade_save(e)}}},[s("input",{attrs:{type:"hidden",name:"active",value:"1"}}),s("br"),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-8 input"},[s("input",{attrs:{required:"",placeholder:"Ex.: 1° Ano A",name:"name",minlength:"3"}}),t._v(" "),s("label",[t._v("Nome")])]),t._v(" "),s("div",{staticClass:"col-sm-4 input"},[s("input",{attrs:{type:"number",required:"",min:"1",placeholder:"Ex. 1° ano: 1",name:"level",step:"1"}}),t._v(" "),s("label",[t._v("\n                Nível\n\n                "),s("div",{staticClass:"material-icons tooltip tooltip-left tooltip-start",attrs:{"data-tooltip":"1° ano: nível 1;&#xa;2° ano: nível 2;&#xa;3° ano: nível 3;&#xa;etc"}},[t._v("info")])])])]),s("br"),t._v(" "),s("div",{staticClass:"row"},t._l(t.$store.state.subjects,function(e){return e.active?s("div",{key:e.id,staticClass:"col-6 col-md-4"},[s("label",[s("input",{attrs:{type:"checkbox",name:"grade_subject[]"},domProps:{value:e.id}}),t._v(" "+t._s(e.name)+"\n              ")])]):t._e()})),s("br"),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v("  Cancelar")]),t._v(" "),s("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("  Salvar\n          ")]),s("br")])])])]),t._v(" "),s("modal",{ref:"modalEdit",attrs:{anchor:"modal-edit",title:"Editar turma"}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-success":"Turma editada com sucesso","data-error":"Não foi possível editar a turma"},on:{submit:function(e){return e.preventDefault(),t.grade_update(e)}}},[s("br"),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-8 input"},[s("input",{attrs:{required:"",placeholder:"Ex.: 1° Ano A",name:"name",minlength:"3"},domProps:{value:t.current_grade.name}}),t._v(" "),s("label",[t._v("Nome")])]),t._v(" "),s("div",{staticClass:"col-sm-4 input"},[s("input",{attrs:{type:"number",required:"",min:"1",placeholder:"Ex.: 1",name:"level",step:"1"},domProps:{value:t.current_grade.level}}),t._v(" "),s("label",[t._v("\n                Nível\n\n                "),s("div",{staticClass:"material-icons tooltip tooltip-left tooltip-start",attrs:{"data-tooltip":"1° ano: nível 1;&#xa;2° ano: nível 2;&#xa;3° ano: nível 3;&#xa;etc"}},[t._v("info")])])])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-12 text-center"},[s("label",[s("br"),t._v(" "),s("input",{attrs:{name:"active",value:"1",type:"checkbox"},domProps:{checked:parseInt(t.current_grade.active)}}),t._v("Visível\n              ")])])]),s("br"),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v("  Cancelar")]),t._v(" "),s("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("  Salvar\n          ")]),s("br")])])])]),t._v(" "),s("modal",{ref:"modalStudents",attrs:{anchor:"modal-students",title:"Estudantes - "+(t.current_grade?t.current_grade.name:"")}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-resource":"grade","data-success":"Estudante cadastrado com sucesso","data-error":"Não foi possível cadastrar o estudante"},on:{submit:function(e){return e.preventDefault(),t.student_save(e)}}},[s("br"),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-8 input"},[s("input",{attrs:{required:"",placeholder:"Ex.: João da Silva",name:"name",minlength:"3"}}),t._v(" "),s("label",[t._v("Nome")])]),t._v(" "),s("div",{staticClass:"col-sm-4 input"},[s("input",{attrs:{type:"number",required:"",min:"1",placeholder:"Ex.: 5",name:"number",step:"1"}}),t._v(" "),s("label",[t._v("Número")])])]),t._v(" "),s("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("  Salvar\n          ")])]),s("br"),t._v(" "),t.current_students.length?s("table",{staticClass:"table"},[s("thead",[s("tr",[s("th",[t._v("Nome")]),t._v(" "),s("th",[t._v("Número")])])]),t._v(" "),s("tbody",t._l(t.current_students,function(e){return s("tr",{key:e.id,attrs:{"data-student_id":e.id}},[t.studentGrade(e.id).end_date<=(new Date).toISOString().slice(0,10)?[s("td",{staticClass:"text-striked"},[t._v(t._s(e.name))]),t._v(" "),s("td",{staticStyle:{"max-width":"75px"}},[t._v(t._s(t.studentGrade(e.id).number))]),t._v(" "),s("td",{staticClass:"text-right"},[s("button",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{title:"Ativar e Desativar"},on:{click:function(s){t.student_toggle(e.id)}}},[s("div",{staticClass:"material-icons"},[t._v("visibility_off")]),s("span",{staticClass:"d-none d-md-inline"},[t._v(" Ativar e Desativar")])])])]:[s("td",[s("input",{attrs:{name:"name",minlength:"3",required:""},domProps:{value:e.name}})]),t._v(" "),s("td",{staticStyle:{"max-width":"75px"}},[s("input",{attrs:{type:"number",min:"1",step:"1",name:"number",required:""},domProps:{value:t.studentGrade(e.id).number}})]),t._v(" "),s("td",{staticClass:"text-right no-wrap"},[s("button",{staticClass:"btn-success btn-sm tooltip tooltip-end",attrs:{title:"Salvar"},on:{click:function(s){t.student_update(e.id)}}},[s("div",{staticClass:"material-icons"},[t._v("save")]),s("span",{staticClass:"d-none d-md-inline"},[t._v(" Salvar")])]),t._v(" "),s("button",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{title:"Ativar e Desativar"},on:{click:function(s){t.student_toggle(e.id)}}},[s("div",{staticClass:"material-icons"},[t._v("visibility_off")]),s("span",{staticClass:"d-none d-md-inline"},[t._v(" Ativar e Desativar")])])])]],2)}))]):s("div",{staticClass:"text-center text-muted"},[s("br"),s("br"),s("br"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Ainda não há nenhum estudante cadastrado")]),t._v(" "),s("br"),s("br")]),t._v(" "),s("br"),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v("  Fechar")])])])]),t._v(" "),s("modal",{ref:"modalSubjects",attrs:{anchor:"modal-subjects",title:"Disciplinas - "+(t.current_grade?t.current_grade.name:"")}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-success":"Disciplina incluída com sucesso","data-error":"Não foi possível incluir a disciplina"},on:{submit:function(e){return e.preventDefault(),t.grade_subject_save(e)}}},[s("br"),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-12 col-sm-6 input"},[s("select",{attrs:{required:"",name:"subject_id"}},[s("option",{attrs:{value:"",disabled:"",hidden:"",selected:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.$store.state.subjects,function(e){return s("option",{key:e.id,attrs:{disabled:t.current_subjects.find(function(t){return t.id===e.id})},domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),s("label",[t._v("Disciplina")])]),t._v(" "),s("div",{staticClass:"col-12 col-sm-3"},[s("br",{staticClass:"d-none d-sm-inline"}),t._v(" "),s("button",{staticClass:"btn-success",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v(" Salvar\n              ")])])]),t._v(" "),s("div",{staticClass:"row"},t._l(t.current_subjects,function(e){return s("div",{key:e.id,staticClass:"col-6 col-md-4"},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v(" "+t._s(e.name)+"\n            ")])})),s("br"),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v("  Cancelar")]),s("br")])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("people")]),this._v("Turma")])]),this._v(" "),e("div",{staticClass:"col text-right"},[e("a",{staticClass:"btn-success btn-sm no-wrap",attrs:{href:"#modal-new"}},[e("div",{staticClass:"material-icons"},[this._v("add")]),this._v("\n        Criar nova turma\n      ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")])])])}]},D=s("VU/8")(P,I,!1,null,null,null).exports,R={name:"Council",data:function(){return{current_council_id:void 0,current_council:{},current_topics:[]}},watch:{current_council_id:function(){var t=this;if(!this.current_council_id)return this.current_council=[],void(this.current_topics=[]);this.current_council=this.$store.state.councils.find(function(e){return e.id===t.current_council_id}),this.current_topics=this.$store.state.topics.filter(function(e){return t.$store.state.council_topics.find(function(s){return s.topic_id===e.id&&s.council_id===t.current_council_id})})}},methods:{councilStatus:function(t){var e=this.$store.state.councils.find(function(e){return e.id===t}),s=new Date;return s>new Date(e.end_date)?"Finalizado":s<new Date(e.start_date)?"Aguardando início":e.active?"Acontecendo":"Pausado"},activeCouncil:function(t){var e=this.$store.state.councils.find(function(e){return e.id===t}),s=new Date;return e.active&&s>=new Date(e.start_date)&&s<=new Date(e.end_date)},council_save:function(t){var e=this;this.$emit("loading");var s=t.target,r=s.querySelectorAll('[name="council_topic[]"]:checked'),i=[].map.call(r,function(t){return t.value}),n={resource_name:"council",data:{name:s.querySelector("[name=name]").value,start_date:s.querySelector("[name=start_date]").value,end_date:s.querySelector("[name=end_date]").value,active:!0}};return this.$store.dispatch("save_resource",n).then(function(t){var s=[];return i.forEach(function(r){var i={resource_name:"council_topic",data:{topic_id:r,council_id:t.id}},n=e.$store.dispatch("save_resource",i);s.push(n)}),e.$store.state.grades.forEach(function(r){var i={resource_name:"council_grade",data:{grade_id:r.id,council_id:t.id}},n=e.$store.dispatch("save_resource",i);s.push(n)}),o.a.all(s)}).then(function(){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.$refs.modalNew.close(),s.querySelector("[name=name]").value="",s.querySelector("[name=start_date]").value="",s.querySelector("[name=end_date]").value="",r.forEach(function(t){t.checked=!1})}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},council_update:function(t){var e=this;this.$emit("loading");var s=t.target,r={resource_name:"council",data:{id:this.current_council_id,name:s.querySelector("[name=name]").value,start_date:s.querySelector("[name=start_date]").value,end_date:s.querySelector("[name=end_date]").value,active:!0}};return this.$store.dispatch("save_resource",r).then(function(t){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.current_council=t}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})}},created:function(){this.current_council_id=void 0,this.current_council={},this.current_topics=[]}},U={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),t._v(" "),s("article",{staticClass:"box"},[s("div",{staticClass:"box-body"},[t.$store.state.councils.length?s("table",{staticClass:"table"},[t._m(1),t._v(" "),s("tbody",t._l(t.$store.state.councils,function(e){return s("tr",{key:e.id,class:t.activeCouncil(e.id)?"text-bold":""},[s("td",[t._v(t._s(e.name))]),t._v(" "),s("td",{staticClass:"d-none d-sm-table-cell"},[t._v(t._s(new Date(e.start_date).toLocaleDateString("pt-BR"))+" - "+t._s(new Date(e.end_date).toLocaleDateString("pt-BR")))]),t._v(" "),s("td",{staticClass:"d-none d-lg-table-cell"},[t._v(t._s(t.councilStatus(e.id)))]),t._v(" "),s("td",{staticClass:"text-right no-wrap"},[s("router-link",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{to:{name:"Report",params:{id:e.id}},title:"Relatórios do conselho de classe"}},[s("div",{staticClass:"material-icons"},[t._v("search")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Relatórios")])]),t._v(" "),s("a",{staticClass:"btn-warning btn-sm tooltip tooltip-end",attrs:{href:"#modal-edit",title:"Editar informações do conselho"},on:{click:function(s){t.current_council_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("edit")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Editar")])])],1)])}))]):s("div",{staticClass:"text-center text-muted"},[s("br"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Ainda não há nenhum conselho de classe cadastrado")]),s("br")])])]),t._v(" "),s("modal",{ref:"modalNew",attrs:{anchor:"modal-new",title:"Novo conselho de classe"}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-success":"Conselho de classe criado com sucesso","data-error":"Não foi possível criar o conselho de classe"},on:{submit:function(e){return e.preventDefault(),t.council_save(e)}}},[s("br"),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-4 input"},[s("input",{attrs:{required:"",placeholder:"Ex.: "+(1+~~(((new Date).getMonth()+1)/4))+"° trimestre "+(new Date).getFullYear(),name:"name"}}),t._v(" "),s("label",[t._v("Nome")])]),t._v(" "),s("div",{staticClass:"col-sm-6 col-md-4 input"},[s("input",{attrs:{type:"date",required:"",name:"start_date"}}),t._v(" "),s("label",[t._v("\n                Data inicial\n\n                "),s("div",{staticClass:"material-icons tooltip",attrs:{"data-tooltip":"Primeiro dia disponível para avaliação"}},[t._v("help")])])]),t._v(" "),s("div",{staticClass:"col-sm-6 col-md-4 input"},[s("input",{attrs:{type:"date",required:"",name:"end_date"}}),t._v(" "),s("label",[t._v("\n                Data final\n\n                "),s("div",{staticClass:"material-icons tooltip",attrs:{"data-tooltip":"Último dia disponível para avaliação"}},[t._v("help")])])])]),s("br"),t._v(" "),s("div",{staticClass:"row"},t._l(t.$store.state.topics,function(e){return e.active?s("div",{key:e.id,staticClass:"col-6 col-md-4"},[s("label",[s("input",{attrs:{type:"checkbox",name:"council_topic[]"},domProps:{value:e.id}}),t._v(" "+t._s(e.name)+"\n              ")])]):t._e()})),s("br"),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v("  Cancelar")]),t._v(" "),s("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("  Salvar\n          ")]),s("br")])])])]),t._v(" "),s("modal",{ref:"modalEdit",attrs:{anchor:"modal-edit",title:"Editar conselho de classe"}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-success":"Conselho de classe editado com sucesso","data-error":"Não foi possível editar o conselho de classe"},on:{submit:function(e){return e.preventDefault(),t.council_update(e)}}},[s("br"),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-4 input"},[s("input",{attrs:{required:"",name:"name",placeholder:"Ex.: "+(1+~~(((new Date).getMonth()+1)/4))+"° trimestre "+(new Date).getFullYear()},domProps:{value:t.current_council.name}}),t._v(" "),s("label",[t._v("Nome")])]),t._v(" "),s("div",{staticClass:"col-sm-6 col-md-4 input"},[s("input",{attrs:{type:"date",required:"",name:"start_date",placeholder:"Primeiro dia disponível para avaliação"},domProps:{value:t.current_council.start_date}}),t._v(" "),s("label",[t._v("\n                Data inicial\n\n                "),s("div",{staticClass:"material-icons tooltip",attrs:{"data-tooltip":"Primeiro dia disponível para avaliação"}},[t._v("help")])])]),t._v(" "),s("div",{staticClass:"col-sm-6 col-md-4 input"},[s("input",{attrs:{type:"date",required:"",name:"end_date",placeholder:"Primeiro dia disponível para avaliação"},domProps:{value:t.current_council.end_date}}),t._v(" "),s("label",[t._v("\n                Data final\n\n                "),s("div",{staticClass:"material-icons tooltip",attrs:{"data-tooltip":"Último dia disponível para avaliação"}},[t._v("help")])])])]),s("br"),t._v(" "),s("div",{staticClass:"row"},t._l(t.current_topics,function(e){return s("div",{key:e.id,staticClass:"col-6 col-md-4"},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v(" "+t._s(e.name)+"\n            ")])})),t._v(" "),s("br"),t._v(" "),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v("\n            Cancelar\n          ")]),t._v(" "),s("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("\n            Salvar\n          ")]),t._v(" "),s("br")])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("edit")]),this._v("Conselhos de Classe")])]),this._v(" "),e("div",{staticClass:"col text-right"},[e("a",{staticClass:"btn-success btn-sm no-wrap",attrs:{href:"#modal-new"}},[e("div",{staticClass:"material-icons"},[this._v("add")]),this._v(" Criar novo conselho")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")]),this._v(" "),e("th",{staticClass:"d-none d-sm-table-cell"},[this._v("Período")]),this._v(" "),e("th",{staticClass:"d-none d-lg-table-cell"},[this._v("Status")])])])}]},G=s("VU/8")(R,U,!1,null,null,null).exports,O={name:"Role",data:function(){return{}},methods:{role_type:function(t){var e=this.$store.state.roles.find(function(e){return e.user_id===t&&parseInt(e.approved)});return e?this.$store.state.role_types.find(function(t){return t.id===e.role_type_id}):{}},user_save:function(t){var e=this,s=t.target,r={name:s.querySelector("[name=name]").value,email:s.querySelector("[name=email]").value,password:s.querySelector("[name=password]").value},i={role_type_id:s.querySelector("[name=role_type_id]").value};if(r.password===s.querySelector("[name=re_password]").value){this.$emit("loading");var n={resource_name:"user",data:r};this.$store.dispatch("save_resource",n).then(function(t){i.user_id=t.id;var s={path:"user_token",method:"POST",body:{email:t.email,password:t.password}};return e.$store.dispatch("api_fetch",s).then(function(t){return t.json()})}).then(function(t){var s={resource_name:"role",data:i,headers:{Token:t.value}};return e.$store.dispatch("save_resource",s)}).then(function(t){t.approved=!0;var s={resource_name:"role",data:t};return e.$store.dispatch("save_resource",s)}).then(function(){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.$refs.modalNew.close(),s.querySelector("[name=name]").value="",s.querySelector("[name=email]").value="",s.querySelector("[name=password]").value="",s.querySelector("[name=role_type_id]").value=""}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})}else this.$emit("notify","Erro!","As senhas informadas devem ser iguais!","danger")}}},H={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),t._v(" "),s("article",{staticClass:"box"},[s("div",{staticClass:"box-body"},[s("table",{staticClass:"table"},[t._m(1),t._v(" "),s("tbody",t._l(t.$store.state.users,function(e){return s("tr",{key:e.id},[s("td",[t._v(t._s(e.name))]),t._v(" "),s("td",[t._v(t._s(t.role_type(e.id).name))]),t._v(" "),s("td",[t._v(t._s(e.email))])])}))])])]),t._v(" "),s("modal",{ref:"modalNew",attrs:{anchor:"modal-new",title:"Novo usuário"}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-11"},[s("form",{attrs:{action:"#","data-success":"Usuário cadastrado com sucesso","data-error":"Não foi possível cadastrar o usuário"},on:{submit:function(e){return e.preventDefault(),t.user_save(e)}}},[s("br"),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-6 input"},[s("input",{attrs:{required:"",placeholder:"Ex.: João da Silva",name:"name",minlength:"3"}}),t._v(" "),s("label",[t._v("Nome")])]),t._v(" "),s("div",{staticClass:"col-sm-6 input"},[s("input",{attrs:{required:"",placeholder:"Ex.: joao@email.com",name:"email",type:"email",minlength:"3"}}),t._v(" "),s("label",[t._v("E-mail")])])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-6 input"},[s("input",{attrs:{required:"",placeholder:"Ao menos 5 caracteres",name:"password",type:"password",minlength:"5"}}),t._v(" "),s("label",[t._v("Senha")])]),t._v(" "),s("div",{staticClass:"col-sm-6 input"},[s("input",{attrs:{required:"",placeholder:"Igual à anterior",name:"re_password",type:"password",minlength:"5"}}),t._v(" "),s("label",[t._v("Repita a senha")])])]),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-sm-6 input"},[s("select",{attrs:{required:"",name:"role_type_id"}},[s("option",{attrs:{value:"",selected:"",disabled:"",hidden:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.$store.state.role_types,function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),s("label",[t._v("Tipo de usuário")])])]),s("br"),s("br"),s("a",{staticClass:"btn-danger",attrs:{href:"#"}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v("  Cancelar")]),t._v(" "),s("button",{staticClass:"btn-success pull-right",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("  Salvar\n          ")]),s("br")])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto"},[e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("people")]),this._v("Usuários")])]),this._v(" "),e("div",{staticClass:"col text-right"},[e("a",{staticClass:"btn-success btn-sm no-wrap",attrs:{href:"#modal-new"}},[e("div",{staticClass:"material-icons"},[this._v("add")]),this._v(" Criar novo usuário")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")]),this._v(" "),e("th",[this._v("Tipo")]),this._v(" "),e("th",[this._v("E-mail")])])])}]},L=s("VU/8")(O,H,!1,null,null,null).exports,F={name:"Teacher",data:function(){return{current_user_id:void 0,current_user:{},current_teachers:[],current_grade_id:"",current_subject_id:"",current_subjects:[],current_teacher_request_id:void 0,current_teacher_id:void 0}},computed:{usersWhoEvaluate:function(){var t=this;return this.$store.state.users.filter(function(e){return t.userHasPermission("evaluate",e.id)})}},watch:{current_user_id:function(){var t=this;if(this.current_subjects=[],this.current_grade_id="",this.current_subject_id="",!this.current_user_id)return this.current_user={},void(this.current_teachers=[]);this.current_user=this.$store.state.users.find(function(e){return e.id===t.current_user_id}),this.current_teachers=this.$store.state.teachers.filter(function(e){return e.user_id===t.current_user_id})},current_grade_id:function(){var t=this;(this.current_subjects=[],this.current_subject_id="",this.current_grade_id)&&this.$store.state.grade_subjects.filter(function(e){return e.grade_id===t.current_grade_id}).forEach(function(e){var s=t.$store.state.subjects.find(function(t){return t.id===e.subject_id});t.current_subjects.push(s)})}},methods:{role_type:function(t){var e=this.$store.state.roles.find(function(e){return e.user_id===t&&parseInt(e.approved)});return e?this.$store.state.role_types.find(function(t){return t.id===e.role_type_id}):{}},userHasPermission:function(t,e){var s=this.role_type(e);if(!s.id)return!1;var r=this.$store.state.permissions.find(function(e){return e.reference===t});return!!this.$store.state.role_type_permissions.find(function(t){return t.permission_id===r.id&&t.role_type_id===s.id})},teacher_save:function(t){var e=this;this.$emit("loading");var s=t.target,r={resource_name:"teacher",data:{grade_id:this.current_grade_id,subject_id:this.current_subject_id,user_id:this.current_user_id,start_date:"2018-01-01",end_date:"2018-12-31"}};this.$store.dispatch("save_resource",r).then(function(t){e.$emit("notify","Sucesso!",s.dataset.success,"success"),e.current_teachers.push(t),e.current_subject_id=""}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},accept_teacher_request:function(){var t=this;this.$emit("loading");var e=this.$store.state.teacher_requests.find(function(e){return e.id===t.current_teacher_request_id}),s={resource_name:"teacher",data:{user_id:e.user_id,grade_id:e.grade_id,subject_id:e.subject_id,start_date:"2018-01-01",end_date:"2018-12-31"}};this.$store.dispatch("save_resource",s).then(function(){var e={resource_name:"teacher_request",id:t.current_teacher_request_id};return t.$store.dispatch("delete_resource",e)}).then(function(){t.$emit("notify","Sucesso!","Professor aceitado com sucesso","success")}).catch(function(e){t.$emit("notify","Erro!","Não foi possível aceitar o professor","danger"),console.log("Error:",e)}).finally(function(){t.$emit("loaded")})},deny_teacher_request:function(){var t=this;this.$emit("loading");var e={resource_name:"teacher_request",id:this.current_teacher_request_id};this.$store.dispatch("delete_resource",e).then(function(){t.$emit("notify","Sucesso!","Professor negado com sucesso","success")}).catch(function(e){t.$emit("notify","Erro!","Não foi possível negar o professor","danger"),console.log("Error:",e)}).finally(function(){t.$emit("loaded")})},remove_teacher:function(){var t=this;this.$emit("loading");var e={resource_name:"teacher",id:this.current_teacher_id};this.$store.dispatch("delete_resource",e).then(function(){t.$emit("notify","Sucesso!","Professor removido com sucesso","success");var e=t.current_teachers.findIndex(function(e){return e.id===t.current_teacher_id});t.$delete(t.current_teachers,e)}).catch(function(e){t.$emit("notify","Erro!","Não foi possível remover o professor","danger"),console.log("Error:",e)}).finally(function(){t.$emit("loaded"),t.$refs.modalGrades.open()})}},created:function(){this.current_subjects=[],this.current_teachers=[],this.current_grade_id="",this.current_teacher_request_id=void 0,this.current_teacher_id=void 0,this.current_user_id=void 0,this.current_subject_id="",this.current_user={}}},V={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),t._v(" "),s("article",{staticClass:"box"},[s("div",{staticClass:"box-header"},[t._v("Aguardando aprovação")]),t._v(" "),s("div",{staticClass:"box-body"},[t.$store.state.teacher_requests.length?s("table",{staticClass:"table"},[t._m(1),t._v(" "),s("tbody",t._l(t.$store.state.teacher_requests,function(e){return s("tr",{key:e.id},[s("td",[t._v(t._s(t.$store.state.users.find(function(t){return t.id===e.user_id}).name))]),t._v(" "),s("td",[t._v(t._s(t.$store.state.grades.find(function(t){return t.id===e.grade_id}).name))]),t._v(" "),s("td",[t._v(t._s(t.$store.state.subjects.find(function(t){return t.id===e.subject_id}).name))]),t._v(" "),s("td",{staticClass:"text-right no-wrap"},[s("a",{staticClass:"btn-success btn-sm tooltip tooltip-end",attrs:{href:"#modal-accept",title:"Aceitar professor"},on:{click:function(s){t.current_teacher_request_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Aceitar professor")])]),t._v(" "),s("a",{staticClass:"btn-danger btn-sm tooltip tooltip-end",attrs:{href:"#modal-deny",title:"Negar professor"},on:{click:function(s){t.current_teacher_request_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("close")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Negar professor")])])])])}))]):s("div",{staticClass:"text-center text-muted"},[s("br"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Nenhum professor esperando aprovação")]),s("br")])])]),t._v(" "),s("article",{staticClass:"box"},[s("div",{staticClass:"box-header"},[t._v("Todos")]),t._v(" "),s("div",{staticClass:"box-body"},[s("table",{staticClass:"table"},[t._m(2),t._v(" "),s("tbody",t._l(t.usersWhoEvaluate,function(e){return s("tr",{key:e.id},[s("td",[t._v(t._s(e.name))]),t._v(" "),s("td",{staticClass:"text-right no-wrap"},[s("a",{staticClass:"btn-primary btn-sm tooltip tooltip-end",attrs:{href:"#modal-grades",title:"Turmas"},on:{click:function(s){t.current_user_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("people")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Turmas")])])])])}))])])]),t._v(" "),s("modal",{ref:"modalGrades",attrs:{anchor:"modal-grades",title:"Turmas de "+t.current_user.name}},[s("br"),t._v(" "),s("form",{attrs:{action:"#","data-success":"Professor salvo com sucesso!","data-error":"Não foi possível cadastrar"},on:{submit:function(e){return e.preventDefault(),t.teacher_save(e)}}},[s("input",{attrs:{type:"hidden",name:"user_id"},domProps:{value:t.current_user_id}}),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-12 col-md-9"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"input col-6 col-sm-4"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.current_grade_id,expression:"current_grade_id"}],attrs:{id:"current_grade_id",name:"grade_id",required:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_grade_id=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.$store.state.grades,function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),s("label",{attrs:{for:"current_grade_id"}},[t._v("Turma")])]),t._v(" "),s("div",{staticClass:"input col-6 col-sm-4"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.current_subject_id,expression:"current_subject_id"}],attrs:{id:"current_subject_id",name:"subject_id",required:"",disabled:!t.current_grade_id},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_subject_id=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v(t._s(t.current_grade_id?"Selecione...":"Selecione a turma..."))]),t._v(" "),t._l(t.$store.state.subjects,function(e){return t.current_grade_id&&t.$store.state.grade_subjects.find(function(s){return s.subject_id===e.id&&s.grade_id===t.current_grade_id})?s("option",{key:e.id,attrs:{disabled:t.$store.state.teachers.find(function(s){return s.grade_id===t.current_grade_id&&s.subject_id===e.id})},domProps:{value:e.id}},[t._v("\n                  "+t._s(e.name)+" "+t._s(t.$store.state.teachers.find(function(s){return s.grade_id===t.current_grade_id&&s.subject_id===e.id})?" - "+t.$store.state.users.find(function(s){return t.$store.state.teachers.find(function(s){return s.grade_id===t.current_grade_id&&s.subject_id===e.id}).user_id===s.id}).name:"")+"\n                ")]):t._e()})],2),t._v(" "),s("label",{attrs:{for:"current_subject_id"}},[t._v("Disciplina")])]),t._v(" "),s("div",{staticClass:"col-12 col-sm-3"},[s("br",{staticClass:"d-none d-sm-inline"}),t._v(" "),s("button",{staticClass:"btn-success",attrs:{type:"submit"}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v(" Salvar\n              ")])])])])])]),s("br"),t._v(" "),t.current_user&&t.current_teachers.length?s("table",{staticClass:"table"},[s("thead",[s("tr",[s("th",[t._v("Turma")]),t._v(" "),s("th",[t._v("Disciplina")])])]),t._v(" "),s("tbody",t._l(t.current_teachers,function(e){return s("tr",{key:e.id},[s("td",[t._v(t._s(t.$store.state.grades.find(function(t){return t.id===e.grade_id}).name))]),t._v(" "),s("td",[t._v(t._s(t.$store.state.subjects.find(function(t){return t.id===e.subject_id}).name))]),t._v(" "),s("td",{staticClass:"text-right"},[s("a",{staticClass:"btn-danger btn-sm tooltip tooltip-end",attrs:{href:"#modal-remove",title:"Remover"},on:{click:function(s){t.current_teacher_id=e.id}}},[s("div",{staticClass:"material-icons"},[t._v("delete")]),t._v(" "),s("span",{staticClass:"d-none d-md-inline"},[t._v("Remover")])])])])}))]):s("div",{staticClass:"text-center text-muted"},[s("br"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Nenhuma turma aprovada")]),s("br")])]),t._v(" "),s("prompt",{ref:"promptAccept",attrs:{title:"Aceitar professor",type:"success",anchor:"modal-accept",accept:"Aceitar"},on:{accept:t.accept_teacher_request}},[s("p",[t._v("Tem certeza que deseja aceitar este professor?")])]),t._v(" "),s("prompt",{ref:"promptDeny",attrs:{title:"Negar professor",type:"danger",anchor:"modal-deny",accept:"Negar"},on:{accept:t.deny_teacher_request}},[s("p",[t._v("Tem certeza que deseja negar este professor?")])]),t._v(" "),s("prompt",{ref:"promptRemove",attrs:{title:"Remover professor",type:"danger",anchor:"modal-remove",accept:"Remover"},on:{accept:t.remove_teacher}},[s("p",[t._v("Tem certeza que deseja remover este professor?")])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("people")]),this._v("Professores")])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")]),this._v(" "),e("th",[this._v("Turma")]),this._v(" "),e("th",[this._v("Disciplina")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nome")])])])}]},z=s("VU/8")(F,V,!1,null,null,null).exports,B={name:"User",data:function(){return{user:{}}},methods:{user_update:function(t){var e=this,s=t.target,r={id:this.user.id,name:s.querySelector("[name=name]").value,email:s.querySelector("[name=email]").value},i=s.querySelector("#password").value;if(i===s.querySelector("#re_password").value){i&&(r.password=i),this.$emit("loading");var n={path:"user",method:"PATCH",body:r};return this.$store.dispatch("api_fetch",n).then(function(){return delete r.password,e.$store.dispatch("db_put",{name:"users",data:r})}).then(function(){e.$store.commit("updateItem",{name:"users",data:r}),e.$emit("notify","Sucesso!",s.dataset.success,"success")}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})}this.$emit("notify","Erro!","Os dois campos de senha devem ser iguais!","danger")}},created:function(){var t=parseInt(this.$store.state.token.user_id);this.user=this.$store.state.users.find(function(e){return e.id===t})}},J={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-md-10 col-lg-8 col-xlg-6"},[s("article",{staticClass:"box"},[s("div",{staticClass:"box-body"},[s("form",{attrs:{action:"#","data-success":"Usuário editado com sucesso","data-error":"Não foi possível editar o usuário"},on:{submit:function(e){return e.preventDefault(),t.user_update(e)}}},[s("div",{staticClass:"row"},[s("div",{staticClass:"input col-sm-6"},[s("input",{attrs:{id:"user_name",name:"name",minlength:"3",required:""},domProps:{value:t.user.name}}),t._v(" "),s("label",{attrs:{for:"user_name"}},[t._v("Nome completo")])]),t._v(" "),s("div",{staticClass:"input col-sm-6"},[s("input",{attrs:{id:"user_email",name:"email",type:"email",minlength:"3",required:""},domProps:{value:t.user.email}}),t._v(" "),s("label",{attrs:{for:"user_email"}},[t._v("E-mail")])])]),t._v(" "),t._m(1),t._v(" "),t._m(2)])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{staticClass:"content-title"},[e("i",{staticClass:"material-icons"},[this._v("person")]),this._v("Usuário")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"input col-sm-6"},[e("input",{attrs:{id:"password",type:"password",minlength:"5",placeholder:"Apenas caso queira alterar"}}),this._v(" "),e("label",{attrs:{for:"password"}},[this._v("Nova senha")])]),this._v(" "),e("div",{staticClass:"input col-sm-6"},[e("input",{attrs:{id:"re_password",type:"password",minlength:"5",placeholder:"Para conferir se digitou corretamente"}}),this._v(" "),e("label",{attrs:{for:"re_password"}},[this._v("Repita a senha")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-right"},[e("button",{staticClass:"btn-success"},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v(" Salvar\n              ")])])}]},M=s("VU/8")(B,J,!1,null,null,null).exports,W={name:"Report",data:function(){return{current_council:{},current_grades:[],current_topics:[],current_topic_options:[],current_grade_id:"",current_subject_id:"",current_subjects:[],current_students:[],current_student_grades:[],current_evaluations:[],current_student_observations:[],current_grade_observations:[],current_student_id:void 0,current_student:{}}},watch:{current_grade_id:function(){var t=this;if(this.current_student_id=void 0,!this.current_grade_id)return this.current_subject_id="",this.current_subjects=[],this.current_student_grades=[],this.current_students=[],void this.load_evaluations();var e=this.$store.state.grade_subjects.filter(function(e){return e.grade_id===t.current_grade_id});this.current_subjects=this.$store.state.subjects.filter(function(t){return e.find(function(e){return e.subject_id===t.id})}),this.current_student_grades=this.$store.state.student_grades.filter(function(e){return e.grade_id===t.current_grade_id}),this.current_students=this.$store.state.students.filter(function(e){return t.current_student_grades.find(function(t){return t.student_id===e.id})}),this.current_subject_id?this.current_subject_id="":this.load_evaluations()},current_subject_id:function(){this.load_evaluations()},current_student_id:function(){var t=this;this.current_student_id?this.current_student=this.current_students.find(function(e){return e.id===t.current_student_id}):this.current_student={}}},methods:{load_evaluations:function(){var t=this;if(!this.current_grade_id)return this.current_evaluations=[],this.current_grade_observations=[],void(this.current_student_observations=[]);this.current_evaluations=this.$store.state.evaluations.filter(function(e){return e.council_id===t.current_council.id&&e.grade_id===t.current_grade_id&&(!t.current_subject_id||t.current_subject_id===e.subject_id)}),this.current_student_observations=this.$store.state.student_observations.filter(function(e){return e.council_id===t.current_council.id&&e.grade_id===t.current_grade_id&&(!t.current_subject_id||t.current_subject_id===e.subject_id)}),this.current_grade_observations=this.$store.state.grade_observations.filter(function(e){return e.council_id===t.current_council.id&&e.grade_id===t.current_grade_id&&(!t.current_subject_id||t.current_subject_id===e.subject_id)})},reportStudentTopic:function(t,e){var s=this.current_topic_options.filter(function(t){return t.topic_id===e}),r=this.current_evaluations.filter(function(e){return e.student_id===t&&s.find(function(t){return t.id===e.topic_option_id})});if(!r.length)return"-";var i=r.map(function(t){return s.find(function(e){return e.id===t.topic_option_id}).value}),n=i.reduce(function(t,e){return t+e}),a=parseInt(n/i.length),o=s.map(function(t){return t.value}).reduce(function(t,e){return Math.abs(e-a)<Math.abs(t-a)?e:t}),c=s.find(function(t){return t.value===o}).name;return this.current_subject_id?c:c+" ("+a+"%)"},reportSubjectTopic:function(t,e){var s=this,r=this.current_topic_options.filter(function(t){return t.topic_id===e}),i=this.current_evaluations.find(function(i){return i.student_id===s.current_student_id&&i.subject_id===t&&r.find(function(t){return t.id===i.topic_option_id&&t.topic_id===e})});return i?r.find(function(t){return t.id===i.topic_option_id}).name:"-"},studentGrade:function(t){return this.current_student_grades.find(function(e){return e.student_id===t})},studentHasEvaluation:function(t){return!!this.current_evaluations.find(function(e){return e.student_id===t})}},computed:{studentsInGrade:function(){var t=this;if(this.current_grade_id)return this.$store.state.students.filter(function(e){return t.studentGrade(e.id)}).sort(function(e,s){return u()(t.studentGrade(e.id).number-t.studentGrade(s.id).number)})},currentGrade:function(){var t=this;if(this.current_grade_id)return this.current_grades.find(function(e){return e.id===t.current_grade_id})},subjectsInGrade:function(){var t=this;if(this.current_grade_id)return this.$store.state.subjects.filter(function(e){return t.$store.state.grade_subjects.find(function(s){return s.subject_id===e.id&&s.grade_id===t.current_grade_id})})},gradeObservations:function(){var t=this;if(this.current_grade_id)return this.$store.state.grade_observations.filter(function(e){return e.grade_id===t.current_grade_id&&e.council_id===t.current_council.id&&(!t.current_subject_id||e.subject_id===t.current_subject_id)})}},created:function(){var t=this,e=parseInt(this.$route.params.id);this.current_council=this.$store.state.councils.find(function(t){return t.id===e}),this.current_grades=this.$store.state.grades.filter(function(s){return t.$store.state.council_grades.find(function(t){return t.grade_id===s.id&&t.council_id===e})}),this.current_topics=this.$store.state.topics.filter(function(s){return t.$store.state.council_topics.find(function(t){return t.topic_id===s.id&&t.council_id===e})}),this.current_topic_options=this.$store.state.topic_options,this.current_grade_id="",this.current_subject_id="",this.current_subjects=[],this.current_students=[],this.current_evaluations=[],this.current_student_observations=[],this.current_grade_observations=[],this.current_student_id=void 0,this.current_student={}}},Y={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("h1",{staticClass:"content-title"},[s("i",{staticClass:"material-icons"},[t._v("edit")]),t._v("Relatórios - "+t._s(t.current_council.name))]),t._v(" "),s("article",{staticClass:"box"},[s("div",{staticClass:"box-body"},[s("br"),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-12 col-md-8 col-lg-6"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"input col-12 col-sm-6"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.current_grade_id,expression:"current_grade_id"}],attrs:{id:"current_grade_id",name:"current_grade_id",required:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_grade_id=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.current_grades,function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),s("label",{attrs:{for:"current_grade_id"}},[t._v("Turma")])]),t._v(" "),s("div",{staticClass:"input col-12 col-sm-6"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.current_subject_id,expression:"current_subject_id"}],attrs:{id:"current_subject_id",name:"current_subject_id",required:"",disabled:!t.current_grade_id},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_subject_id=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",selected:""}},[t._v(t._s(t.current_grade_id?"Todas":"Selecione a turma..."))]),t._v(" "),t._l(t.current_subjects,function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),s("label",{attrs:{for:"current_subject_id"}},[t._v("Disciplina")])])])])]),s("br"),t._v(" "),t.current_grade_id?t.current_evaluations.length?s("div",[t.current_student_id?[s("p",[s("button",{staticClass:"btn-sm btn-primary",on:{click:function(e){t.current_student_id=void 0}}},[s("span",{staticClass:"material-icons"},[t._v("arrow_back")]),t._v("\n              Voltar para a turma\n            ")])]),t._v(" "),s("p",[s("b",[t._v(t._s(t.current_student.id?t.studentGrade(t.current_student.id).number:"")+" - "+t._s(t.current_student.name))])]),t._v(" "),s("super-table",[s("thead",[s("tr",[s("th",{staticStyle:{"max-width":"33vw"}},[t._v("Matéria")]),t._v(" "),t._l(t.current_topics,function(e){return s("th",{key:e.id,staticStyle:{"min-width":"150px"}},[t._v(t._s(e.name))])})],2)]),t._v(" "),s("tbody",t._l(t.current_subjects,function(e){return s("tr",{key:e.id},[s("td",[t._v(t._s(e.name))]),t._v(" "),t._l(t.current_topics,function(r){return s("td",{key:r.id,staticStyle:{"min-width":"150px"}},[t._v(t._s(t.reportSubjectTopic(e.id,r.id)))])})],2)}))]),t._v(" "),t._l(t.current_student_observations.filter(function(e){return e.student_id===t.current_student_id}),function(e){return s("p",{key:e.id},[s("b",[t._v(t._s(t.$store.state.users.find(function(t){return t.id===e.user_id}).name)+t._s(t.current_subject_id?"":" - "+t.current_subjects.find(function(t){return t.id===e.subject_id}).name)+":")]),t._v(" "+t._s(e.description))])})]:[s("super-table",[s("thead",[s("tr",[s("th",{staticStyle:{"max-width":"33vw"}},[t._v("Aluno")]),t._v(" "),t._l(t.current_topics,function(e){return s("th",{key:e.id,staticStyle:{"min-width":"150px"}},[t._v(t._s(e.name))])}),t._v(" "),s("th",{staticClass:"no-wrap"},[t._v("Observações Gerais")])],2)]),t._v(" "),s("tbody",t._l(t.current_students,function(e){return s("tr",{key:e.id,attrs:{"data-student_id":e.id}},[s("td",{staticStyle:{"max-width":"33vw"}},[s("a",{attrs:{href:"#"},on:{click:function(s){s.preventDefault(),t.current_student_id=e.id}}},[t._v(t._s(t.studentGrade(e.id).number)+" - "+t._s(e.name))])]),t._v(" "),t._l(t.current_topics,function(r){return s("td",{key:r.id},[t._v(t._s(t.reportStudentTopic(e.id,r.id)))])}),t._v(" "),s("td",t._l(t.current_student_observations.filter(function(t){return t.student_id===e.id}),function(e){return s("p",{key:e.id,staticStyle:{"min-width":"250px"}},[s("b",[t._v(t._s(t.$store.state.users.find(function(t){return t.id===e.user_id}).name)+t._s(t.current_subject_id?"":" - "+t.current_subjects.find(function(t){return t.id===e.subject_id}).name)+":")]),t._v(" "+t._s(e.description))])}))],2)}))]),t._v(" "),s("br"),t._v(" "),t._l(t.current_grade_observations,function(e){return s("p",{key:e.id},[s("b",[t._v(t._s(t.$store.state.users.find(function(t){return t.id===e.user_id}).name)+t._s(t.current_subject_id?"":" - "+t.current_subjects.find(function(t){return t.id===e.subject_id}).name)+":")]),t._v(" "+t._s(e.description))])})]],2):s("div",{staticClass:"text-center text-muted"},[s("br"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Esta turma ainda não recebeu avaliações"),t.current_subject_id?s("span",[t._v(" nesta disciplina")]):t._e(),t._v(".")]),s("br")]):s("div",{staticClass:"text-center text-muted"},[s("br"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Selecione uma turma para ver o relatório.")]),s("br")])])])])},staticRenderFns:[]},Q=s("VU/8")(W,Y,!1,null,null,null).exports,X={name:"Evaluate",data:function(){return{hide_evaluated_students:!1,current_council:{},current_topics_options:[],current_topics:[],current_grades:[],current_user_subjects:[],current_teachers:[],current_user_student_grades:[],current_user_students:[],current_user_evaluations:[],current_user_student_observations:[],current_user_grade_observations:[],current_user_id:void 0,current_grade_id:"",current_subject_id:"",current_student_grades:[],current_students:[],current_subjects:[],current_evaluations:[],current_student_observations:[],current_grade_observation:void 0}},watch:{current_grade_id:function(){var t=this;if(this.current_subject_id="",!this.current_grade_id)return this.current_student_grades=[],this.current_students=[],void(this.current_subjects=[]);this.current_student_grades=this.current_user_student_grades.filter(function(e){return e.grade_id===t.current_grade_id}),this.current_students=this.current_user_students.filter(function(e){return t.current_student_grades.find(function(t){return t.student_id===e.id})}),this.current_subjects=this.current_user_subjects.filter(function(e){return t.current_teachers.find(function(s){return s.grade_id===t.current_grade_id&&s.subject_id===e.id})}),1===this.current_subjects.length&&(this.current_subject_id=this.current_subjects[0].id)},current_subject_id:function(){var t=this;if(!this.current_subject_id)return this.current_evaluations=[],this.current_student_observations=[],void(this.current_grade_observation=void 0);var e=this.current_user_evaluations.filter(function(e){return e.grade_id===t.current_grade_id&&e.subject_id===t.current_subject_id}).map(function(e){return e.topic_id=t.current_topics.find(function(s){return t.current_topic_options.find(function(t){return t.id===e.topic_option_id&&t.topic_id===s.id})}).id,e});this.current_students.forEach(function(s){t.current_topics.forEach(function(r){e.find(function(t){return t.student_id===s.id&&t.topic_id===r.id})||e.push({user_id:t.current_user_id,grade_id:t.current_grade_id,subject_id:t.current_subject_id,council_id:t.current_council.id,topic_id:r.id,student_id:s.id,topic_option_id:r.topic_option_id})})}),this.current_evaluations=e,this.current_student_observations=this.current_user_student_observations.filter(function(e){return e.grade_id===t.current_grade_id&&e.subject_id===t.current_subject_id}),this.current_grade_observation=this.current_user_grade_observations.find(function(e){return e.grade_id===t.current_grade_id&&e.subject_id===t.current_subject_id})}},computed:{currentGrade:function(){var t=this;if(this.current_grade_id)return this.current_grades.find(function(e){return e.id===t.current_grade_id})}},methods:{set_confirm_redirect:function(){window.onbeforeunload=function(t){var e="Tem certeza que deseja sair da página? Você perderá o que não foi salvo";return t.returnValue=e,e}},studentGrade:function(t){return this.current_student_grades.find(function(e){return e.student_id===t})},studentHasEvaluation:function(t){return!!this.current_evaluations.find(function(e){return e.id&&e.student_id===t})},studentIsActive:function(t){return this.studentGrade(t).end_date>(new Date).toISOString().slice(0,10)},topicOptions:function(t){return this.current_topic_options.filter(function(e){return e.topic_id===t})},student_evaluation_save:function(t){var e=this;this.$emit("loading");var s=[];this.current_evaluations.filter(function(e){return e.student_id===t}).forEach(function(t){var r=t,i={resource_name:"evaluation",data:t};s.push(e.$store.dispatch("save_resource",i).then(function(t){var s=e.current_evaluations.findIndex(function(t){return r.id&&t.id===r.id||t.topic_id===r.topic_id&&t.student_id===r.student_id});if(e.$set(e.current_evaluations,s,t),r.id){var i=e.current_user_evaluations.findIndex(function(t){return t.id===r.id});e.$set(e.current_user_evaluations,i,t)}else e.current_user_evaluations.push(t)}))});var r=document.querySelector('tr[data-student_id="'+t+'"] textarea').value;if(r.length){var i=this.current_student_observations.find(function(e){return e.student_id===t});if(!i||i.description!==r){var n={resource_name:"student_observation",data:{council_id:this.current_council.id,grade_id:this.current_grade_id,subject_id:this.current_subject_id,user_id:this.current_user_id,student_id:t,description:r,id:i?i.id:null}};s.push(this.$store.dispatch("save_resource",n).then(function(t){if(!i)return e.current_user_student_observations.push(t),void e.current_student_observations.push(t);var s=e.current_user_student_observations.findIndex(function(t){return t.id===i.id});e.$set(e.current_user_student_observations,s,t);var r=e.current_student_observations.findIndex(function(t){return t.id===i.id});e.$set(e.current_student_observations,r,t)}))}}return o.a.all(s).then(function(){e.$emit("notify","Sucesso!","A avaliação do aluno foi salva com sucesso!","success")}).catch(function(t){e.$emit("notify","Erro!","Não foi possível salvar a avaliação do aluno","danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})},evaluation_save:function(t){var e=this;this.$emit("loading");var s=t.target,r=[];s.querySelectorAll("[data-student_id]").forEach(function(t){var s=t.querySelector("textarea");if(s&&s.value){s=s.value;var i=e.current_student_observations.find(function(e){return e.student_id===parseInt(t.dataset.student_id)});if(!i||i.description!==s){var n={resource_name:"student_observation",data:{council_id:e.current_council.id,grade_id:e.current_grade_id,subject_id:e.current_subject_id,user_id:e.current_user_id,student_id:parseInt(t.dataset.student_id),description:s,id:i?i.id:null}};r.push(e.$store.dispatch("save_resource",n).then(function(t){if(!i)return e.current_user_student_observations.push(t),void e.current_student_observations.push(t);var s=e.current_user_student_observations.findIndex(function(t){return t.id===i.id});e.$set(e.current_user_student_observations,s,t);var r=e.current_student_observations.findIndex(function(t){return t.id===i.id});e.$set(e.current_student_observations,r,t)}))}}});var i=s.querySelector("[name=grade_observation]").value;if(i.length){var n={resource_name:"grade_observation",data:{council_id:this.current_council.id,grade_id:this.current_grade_id,subject_id:this.current_subject_id,user_id:this.current_user_id,description:i,id:this.current_grade_observation?this.current_grade_observation.id:null}};r.push(this.$store.dispatch("save_resource",n).then(function(t){if(e.current_grade_observation){var s=e.current_user_grade_observations.findIndex(function(t){return t.id===e.current_grade_observation.id});e.$set(e.current_user_grade_observations,s,t)}else e.current_user_grade_observations.push(t);e.current_grade_observation=t}))}return this.current_evaluations.forEach(function(t){var s=t,i={resource_name:"evaluation",data:t};r.push(e.$store.dispatch("save_resource",i).then(function(t){var r=e.current_evaluations.findIndex(function(t){return s.id&&t.id===s.id||t.topic_id===s.topic_id&&t.student_id===s.student_id});if(e.$set(e.current_evaluations,r,t),s.id){var i=e.current_user_evaluations.findIndex(function(t){return t.id===s.id});e.$set(e.current_user_evaluations,i,t)}else e.current_user_evaluations.push(t)}))}),o.a.all(r).then(function(){e.$emit("notify","Sucesso!",s.dataset.success,"success"),window.onbeforeunload=void 0}).catch(function(t){e.$emit("notify","Erro!",s.dataset.error,"danger"),console.log("Error:",t)}).finally(function(){e.$emit("loaded")})}},created:function(){var t=this,e=parseInt(this.$route.params.id);this.current_user_id=this.$store.state.token.user_id,this.current_council=this.$store.state.councils.find(function(t){return t.id===e}),this.hide_evaluated_students=!1,this.current_topics=this.$store.state.topics.filter(function(s){return t.$store.state.council_topics.find(function(t){return t.topic_id===s.id&&t.council_id===e})}),this.current_topic_options=this.$store.state.topic_options.filter(function(e){return t.current_topics.find(function(t){return t.id===e.topic_id})}),this.current_teachers=this.$store.state.teachers.filter(function(e){return e.user_id===t.current_user_id}),this.current_grades=this.$store.state.grades.filter(function(s){return t.current_teachers.find(function(t){return t.grade_id===s.id})&&t.$store.state.council_grades.find(function(t){return t.grade_id===s.id&&t.council_id===e})}),this.current_user_subjects=this.$store.state.subjects.filter(function(e){return t.current_teachers.find(function(t){return t.subject_id===e.id})}),this.current_user_student_grades=this.$store.state.student_grades.filter(function(e){return t.current_grades.find(function(t){return t.id===e.grade_id})}),this.current_user_students=this.$store.state.students.filter(function(e){return t.current_user_student_grades.find(function(t){return t.student_id===e.id})}).map(function(e){var s=t.current_user_student_grades.find(function(t){return t.student_id===e.id});return e.grade_id=s.grade_id,e.number=s.number,e}).sort(function(t,e){return u()(t.number-e.number)}),this.current_user_evaluations=this.$store.state.evaluations.filter(function(s){return s.council_id===e&&s.user_id===t.current_user_id}),this.current_user_student_observations=this.$store.state.student_observations.filter(function(s){return s.council_id===e&&s.user_id===t.current_user_id}),this.current_user_grade_observations=this.$store.state.grade_observations.filter(function(s){return s.council_id===e&&s.user_id===t.current_user_id}),this.current_grade_id="",this.current_subject_id="",this.current_student_grades=[],this.current_students=[],this.current_subjects=[],this.current_evaluations=[],this.current_student_observations=[],this.current_grade_observation=void 0}},Z={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("h1",{staticClass:"content-title"},[s("i",{staticClass:"material-icons"},[t._v("edit")]),t._v("Avaliar - "+t._s(t.current_council.name))]),t._v(" "),s("article",{staticClass:"box"},[s("div",{staticClass:"box-body"},[s("form",{attrs:{action:"#","data-success":"Avaliação salva com sucesso","data-error":"Não foi possível salvar a avaliação"},on:{submit:function(e){return e.preventDefault(),t.evaluation_save(e)}}},[s("br"),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-12 col-md-8 col-lg-6"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"input col-12 col-sm-6"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.current_grade_id,expression:"current_grade_id"}],attrs:{id:"current_grade_id",name:"current_grade_id",required:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_grade_id=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",selected:"",hidden:"",disabled:""}},[t._v("Selecione...")]),t._v(" "),t._l(t.current_grades,function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),s("label",{attrs:{for:"current_grade_id"}},[t._v("Turma")])]),t._v(" "),s("div",{staticClass:"input col-12 col-sm-6"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.current_subject_id,expression:"current_subject_id"}],attrs:{id:"current_subject_id",name:"current_subject_id",required:"",disabled:!t.current_grade_id},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.current_subject_id=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",hidden:"",disabled:""}},[t._v(t._s(t.current_grade_id?"Selecione...":"Selecione a turma..."))]),t._v(" "),t._l(t.current_subjects,function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2),t._v(" "),s("label",{attrs:{for:"current_subject_id"}},[t._v("Disciplina")])])])])]),s("br"),t._v(" "),t.current_subject_id?s("div",[s("div",{staticClass:"text-center"},[s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.hide_evaluated_students,expression:"hide_evaluated_students"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.hide_evaluated_students)?t._i(t.hide_evaluated_students,null)>-1:t.hide_evaluated_students},on:{change:function(e){var s=t.hide_evaluated_students,r=e.target,i=!!r.checked;if(Array.isArray(s)){var n=t._i(s,null);r.checked?n<0&&(t.hide_evaluated_students=s.concat([null])):n>-1&&(t.hide_evaluated_students=s.slice(0,n).concat(s.slice(n+1)))}else t.hide_evaluated_students=i}}}),t._v(" Mostrar apenas alunos não avaliados\n            ")])]),s("br"),t._v(" "),s("super-table",[s("thead",[s("tr",[s("th",{staticStyle:{"max-width":"33vw"}},[t._v("Aluno")]),t._v(" "),t._l(t.current_topics,function(e){return s("th",{key:e.id},[t._v(t._s(e.name))])}),t._v(" "),s("th",[t._v("Observações Gerais")]),t._v(" "),s("th")],2)]),t._v(" "),t.current_evaluations.length?s("tbody",t._l(t.current_students,function(e){return t.hide_evaluated_students&&t.studentHasEvaluation(e.id)?t._e():s("tr",{key:e.id,attrs:{"data-student_id":e.id}},[t.hide_evaluated_students||t.studentIsActive(e.id)?t.studentIsActive(e.id)?[s("td",[t._v("\n                    "+t._s(t.studentGrade(e.id).number)+" - "+t._s(e.name)+"\n                    "),t.studentHasEvaluation(e.id)?t._e():s("span",{staticClass:"text-muted"},[t._v(" (não avaliado)")])]),t._v(" "),t._l(t.current_topics,function(r){return s("td",{key:r.id},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.current_evaluations.find(function(t){return t.student_id===e.id&&t.topic_id===r.id}).topic_option_id,expression:"current_evaluations.find(evaluation => evaluation.student_id === student.id && evaluation.topic_id === topic.id).topic_option_id"}],attrs:{required:"","data-topic_id":r.id},on:{change:[function(s){var i=Array.prototype.filter.call(s.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.current_evaluations.find(function(t){return t.student_id===e.id&&t.topic_id===r.id}),"topic_option_id",s.target.multiple?i:i[0])},t.set_confirm_redirect]}},t._l(t.topicOptions(r.id),function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])}))])}),t._v(" "),s("td",[t.current_student_observations.find(function(t){return t.student_id===e.id})?s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.current_student_observations.find(function(t){return t.student_id===e.id}).description,expression:"current_student_observations.find(student_observation => student_observation.student_id === student.id).description"}],staticClass:"resize-v",staticStyle:{"min-width":"250px","min-height":"70px"},domProps:{value:t.current_student_observations.find(function(t){return t.student_id===e.id}).description},on:{input:function(s){s.target.composing||t.$set(t.current_student_observations.find(function(t){return t.student_id===e.id}),"description",s.target.value)}}}):s("textarea",{staticClass:"resize-v",staticStyle:{"min-width":"250px","min-height":"70px"},attrs:{placeholder:"Conteúdos não assimilados e ações efetivadas"}})]),t._v(" "),s("td",[s("a",{staticClass:"btn-success btn-sm tooltip tooltip-end",attrs:{type:"button",title:"Salvar avaliação do aluno"},on:{click:function(s){t.student_evaluation_save(e.id)}}},[s("div",{staticClass:"material-icons"},[t._v("check")])])])]:t._e():[s("td",{staticClass:"text-striked"},[t._v(t._s(t.studentGrade(e.id).number)+" - "+t._s(e.name))]),t._v(" "),t._l(t.current_topics,function(e){return s("td",{key:e.id},[t._v("-")])}),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("-")])]],2)})):t._e()]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-8"},[t.current_grade_observation?s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.current_grade_observation.description,expression:"current_grade_observation.description"}],staticClass:"resize-v",staticStyle:{"min-width":"300px"},attrs:{name:"grade_observation",minlength:"3",placeholder:"Observações da turma"},domProps:{value:t.current_grade_observation.description},on:{input:function(e){e.target.composing||t.$set(t.current_grade_observation,"description",e.target.value)}}}):s("textarea",{staticClass:"resize-v",staticStyle:{"min-width":"300px"},attrs:{name:"grade_observation",minlength:"3",placeholder:"Observações da turma"}})]),t._v(" "),t._m(0)])],1):s("div",{staticClass:"text-center text-muted"},[s("br"),t._v(" "),s("div",{staticClass:"h4"},[t._v("Selecione uma "),s("b",[t._v(t._s(t.current_grade_id?"disciplina":"turma"))]),t._v(" para avaliar.")]),s("br")])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-4 text-right"},[e("button",{staticClass:"btn-lg btn-success",attrs:{type:"submit"}},[e("div",{staticClass:"material-icons"},[this._v("check")]),this._v(" Salvar\n              ")])])}]},K=s("VU/8")(X,Z,!1,null,null,null).exports;r.a.use(b.a);var tt=new b.a({routes:[{path:"/login",name:"Login",component:j,meta:{title:"Login"}},{path:"/subject",name:"Subject",component:q,meta:{title:"Disciplinas"}},{path:"/topic",name:"Topic",component:T,meta:{title:"Tópicos"}},{path:"/grade",name:"Grade",component:D,meta:{title:"Turmas"}},{path:"/teacher_request",name:"TeacherRequest",component:E,meta:{title:"Turmas"}},{path:"/council",name:"Council",component:G,meta:{title:"Conselhos de Classe"}},{path:"/role",name:"Role",component:L,meta:{title:"Usuários"}},{path:"/teacher",name:"Teacher",component:z,meta:{title:"Professores"}},{path:"/user",name:"User",component:M,meta:{title:"Usuário"}},{path:"/report/:id",name:"Report",component:Q,meta:{title:"Relatórios"}},{path:"/evaluate/:id",name:"Evaluate",component:K,meta:{title:"Avaliar"}},{path:"/",name:"Index",component:C}]});tt.beforeEach(function(t,e,s){var r="Conselho";t.meta.title&&(r+=" - "+t.meta.title),document.title=r,document.location.hash="",s()});var et=tt,st={name:"App",data:function(){return{notification:{},loading:!0}},computed:{currentUser:function(){var t=this;return this.$store.state.users.find(function(e){return e.id===t.$store.state.token.user_id})||{}},currentRole:function(){var t=this;return this.$store.state.roles.find(function(e){return e.user_id===t.$store.state.token.user_id})||{}},currentRoleType:function(){var t=this;return this.$store.state.role_types.find(function(e){return e.id===t.currentRole.role_type_id})||{}},currentRoleTypePermissions:function(){var t=this;return this.$store.state.role_type_permissions.filter(function(e){return e.role_type_id===t.currentRoleType.id})},currentPermissions:function(){var t=this;return this.$store.state.permissions.filter(function(e){return t.currentRoleTypePermissions.find(function(t){return t.permission_id===e.id})})},activeCouncils:function(){return this.$store.state.councils.filter(function(t){return t.active&&new Date(t.start_date)<=new Date&&new Date(t.end_date)>=new Date})}},methods:{notify:function(t,e,s,r){var i=this;void 0===r&&(r=5e3),void 0===s&&(s="info");var n=void 0;"success"===s?n="check":"danger"===s?n="close":"warning"===s?n="warning":"info"!==s&&"primary"!==s||(n="info");var a=Date.now().toString();document.getElementById("no-notification").checked=!0;var o=l()(this.notification).length>0?500:0;setTimeout(function(){i.notification={style:s,icon:n,title:t,message:e,timestamp:a},document.getElementById("notification-shown").checked=!0,setTimeout(function(){i.notification.timestamp===a&&(document.getElementById("no-notification").checked=!0,setTimeout(function(){i.notification.timestamp===a&&(i.notification={})},500))},r)},o)},logout:function(){var t=this;this.loading=!0,this.$store.dispatch("logout").then(function(){t.$router.push("/login"),t.loading=!1})},userHasPermission:function(t){return!!this.currentUser&&!!this.currentPermissions.find(function(e){return e.reference===t})},sync:function(){var t=this;this.loading=!0,this.$store.dispatch("loadFromAPI").then(function(){return t.$store.dispatch("loadData")}).catch(function(e){t.notify("Erro","Ocorreu um erro durante a atualização. Tente novamente!","danger"),console.log(e)}).finally(function(){t.loading=!1})}},created:function(){var t=this;this.$store.commit("checkAuth"),this.$store.state.logged_in||"Login"===this.$route.name?"Login"!==this.$route.name?this.$store.dispatch("loadData").then(function(){t.loading=!1}):this.loading=!1:this.logout()}},rt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[t._m(0),t._v(" "),s("header",{staticClass:"header"},[s("router-link",{staticClass:"header-button main-button",attrs:{to:{name:"Index"}}},[t._v("Conselho")]),t._v(" "),t.$store.state.logged_in?[t.$store.state.logged_in?s("a",{staticClass:"header-button menu-toggle material-icons",attrs:{href:"#menu"}},[t._v("menu")]):t._e(),t._v(" "),s("button",{staticClass:"header-button material-icons",attrs:{type:"button"},on:{click:t.sync}},[t._v("sync")]),t._v(" "),t.userHasPermission("role")?s("div",{staticClass:"header-pane"},[s("button",{staticClass:"header-button material-icons",attrs:{type:"button"}},[t._v("\n          notifications\n          "),t.$store.state.teacher_requests.length?s("span",{staticClass:"header-button-label-red"},[t._v(t._s(t.$store.state.teacher_requests.length))]):t._e()]),t._v(" "),s("div",{staticClass:"header-pane-popup"},[t._m(1),t._v(" "),s("div",{staticClass:"header-pane-body"},[t._l(t.$store.state.teacher_requests,function(e,r){return s("div",{key:e.id},[r?s("hr",{staticClass:"margin-h-15"}):t._e(),t._v(" "),s("router-link",{staticClass:"no-link",attrs:{to:{name:"Teacher"}}},[s("div",{staticClass:"header-notification-title"},[s("b",[t._v(t._s(t.$store.state.users.find(function(t){return t.id===e.user_id}).name))]),t._v(" aguarda sua aprovação")]),t._v(" "),s("div",{staticClass:"header-notification-description"},[t._v(t._s(t.$store.state.grades.find(function(t){return t.id===e.grade_id}).name)+" - "+t._s(t.$store.state.subjects.find(function(t){return t.id===e.subject_id}).name)+"\n                  "),s("div",{staticClass:"text-muted"},[t._v(t._s(new Date(e.created_at).toLocaleDateString("pt-BR")))])])])],1)}),t._v(" "),t.$store.state.teacher_requests.length?t._e():s("div",{staticClass:"text-center text-muted"},[s("br"),s("br"),t._v(" "),s("div",{staticClass:"h5"},[t._v("Não há notificações")]),s("br"),s("br")])],2)])]):t._e(),t._v(" "),s("div",{staticClass:"header-pane"},[s("button",{staticClass:"header-button",attrs:{type:"button"}},[t._v(t._s(t.currentUser?t.currentUser.name:""))]),t._v(" "),s("div",{staticClass:"header-pane-popup"},[s("div",{staticClass:"header-pane-body text-center bg-primary text-white"},[s("br"),t._v(" "),t._m(2),t._v(" "),s("div",{staticClass:"text-20"},[t._v(t._s(t.currentUser?t.currentUser.name:""))]),s("br"),s("br")]),t._v(" "),s("div",{staticClass:"header-pane-footer"},[s("router-link",{staticClass:"btn-default btn-sm",attrs:{to:{name:"User"}}},[t._v("Usuário")]),t._v(" "),s("button",{staticClass:"btn-default btn-sm pull-right",attrs:{type:"button"},on:{click:t.logout}},[t._v("Sair")])],1)])])]:t._e()],2),t._v(" "),s("div",{staticClass:"container"},[t.$store.state.logged_in?s("nav",{staticClass:"menu",attrs:{id:"menu"}},[s("a",{staticClass:"menu-close header-button material-icons",attrs:{href:"#"+t.$route.path}},[t._v("menu")]),t._v(" "),s("router-link",{staticClass:"menu-link",attrs:{to:{name:"Index"},"active-class":"menu-active",exact:""}},[s("i",{staticClass:"material-icons"},[t._v("home")]),t._v(" Página Inicial\n      ")]),t._v(" "),t.userHasPermission("subject")?s("router-link",{staticClass:"menu-link",attrs:{to:{name:"Subject"},"active-class":"menu-active"}},[s("i",{staticClass:"material-icons"},[t._v("book")]),t._v(" Disciplinas\n      ")]):t._e(),t._v(" "),t.userHasPermission("topic")?s("router-link",{staticClass:"menu-link",attrs:{to:{name:"Topic"},"active-class":"menu-active"}},[s("i",{staticClass:"material-icons"},[t._v("list")]),t._v(" Tópicos\n      ")]):t._e(),t._v(" "),t.userHasPermission("grade")?s("router-link",{staticClass:"menu-link",attrs:{to:{name:"Grade"},"active-class":"menu-active"}},[s("i",{staticClass:"material-icons"},[t._v("people")]),t._v(" Turmas\n      ")]):t._e(),t._v(" "),t.userHasPermission("council")?s("router-link",{staticClass:"menu-link",attrs:{to:{name:"Council"},"active-class":"menu-active"}},[s("i",{staticClass:"material-icons"},[t._v("edit")]),t._v(" Conselhos de Classe\n      ")]):t._e(),t._v(" "),t.userHasPermission("role")?s("router-link",{staticClass:"menu-link",attrs:{to:{name:"Role"},"active-class":"menu-active"}},[s("i",{staticClass:"material-icons"},[t._v("supervisor_account")]),t._v(" Usuários\n      ")]):t._e(),t._v(" "),t.userHasPermission("teacher")?s("router-link",{staticClass:"menu-link",attrs:{to:{name:"Teacher"},"active-class":"menu-active"}},[s("i",{staticClass:"material-icons"},[t._v("supervisor_account")]),t._v(" Professores\n      ")]):t._e(),t._v(" "),t.userHasPermission("evaluate")?[s("router-link",{staticClass:"menu-link",attrs:{to:{name:"TeacherRequest"},"active-class":"menu-active"}},[s("i",{staticClass:"material-icons"},[t._v("people")]),t._v(" Turmas\n        ")]),t._v(" "),t._l(t.activeCouncils,function(e){return s("router-link",{key:e.id,staticClass:"menu-link",attrs:{to:{name:"Evaluate",params:{id:e.id}},"active-class":"menu-active"}},[s("i",{staticClass:"material-icons"},[t._v("edit")]),t._v(" "+t._s(e.name)+"\n        ")])})]:t._e()],2):t._e(),t._v(" "),s("main",{staticClass:"content mark-required selection-primary"},[s("router-view",{on:{notify:t.notify,loading:function(e){t.loading=!0},loaded:function(e){t.loading=!1}}})],1)]),t._v(" "),s("input",{staticClass:"notification-toggle notification-start-hidden",attrs:{type:"radio",name:"notification-toggle",checked:""}}),t._v(" "),s("input",{staticClass:"notification-toggle",attrs:{type:"radio",name:"notification-toggle",id:"no-notification"}}),t._v(" "),s("input",{staticClass:"notification-toggle",attrs:{type:"radio",name:"notification-toggle",id:"notification-shown"}}),t._v(" "),Object.keys(t.notification).length>0?s("div",{staticClass:"notification",class:"notification-"+t.notification.style},[s("label",{staticClass:"notification-dismiss material-icons",attrs:{for:"no-notification"}},[t._v("close")]),t._v(" "),void 0!==t.notification.icon?s("div",{staticClass:"notification-icon material-icons"},[t._v(t._s(t.notification.icon))]):t._e(),t._v(" "),s("div",{staticClass:"notification-title"},[t._v(t._s(t.notification.title))]),t._v(t._s(t.notification.message)+"\n  ")]):t._e(),t._v(" "),t.loading?s("div",{attrs:{id:"loading"}},[s("div",{staticClass:"material-icons"},[t._v("sync")])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("form",{attrs:{id:"form-valid-support-helper"}},[e("input",{attrs:{required:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header-pane-header"},[e("i",{staticClass:"material-icons"},[this._v("notifications")]),this._v("Notificações")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-80"},[e("i",{staticClass:"material-icons user-icon"},[this._v("account_circle")])])}]};var it=s("VU/8")(st,rt,!1,function(t){s("/HwJ"),s("uFkJ"),s("JUU2")},"data-v-4590a5af",null).exports,nt={name:"Modal",props:["title","anchor"],methods:{open:function(){document.location.hash=this.anchor},close:function(){document.location.hash=this.$route.path}}},at={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"modal",attrs:{id:t.anchor}},[s("div",{staticClass:"modal-header"},[t._v(t._s(t.title))]),t._v(" "),s("div",{staticClass:"modal-body"},[t._t("default")],2)]),t._v(" "),s("a",{staticClass:"modal-close",attrs:{href:"#"+t.$route.path}})])},staticRenderFns:[]},ot=s("VU/8")(nt,at,!1,null,null,null).exports,ct={name:"Prompt",props:["title","anchor","type","accept"],methods:{open:function(){document.location.hash=this.anchor},close:function(){document.location.hash=this.$route.path}}},ut={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{class:"modal modal-xs modal-"+t.type,attrs:{id:t.anchor}},[s("div",{staticClass:"modal-header"},[t._v(t._s(t.title))]),t._v(" "),s("div",{staticClass:"modal-body"},[t._t("default")],2),t._v(" "),s("div",{staticClass:"modal-footer"},[t._m(0),t._v(" "),t.accept?s("a",{staticClass:"btn-success btn-sm pull-right",attrs:{href:"#"},on:{click:function(e){t.$emit("accept")}}},[s("div",{staticClass:"material-icons"},[t._v("check")]),t._v("\n        "+t._s(t.accept)+"\n      ")]):t._e()])]),t._v(" "),s("a",{staticClass:"modal-close",attrs:{href:"#"+t.$route.path}})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn-primary btn-sm",attrs:{href:"#"}},[e("div",{staticClass:"material-icons"},[this._v("close")]),this._v("\n        Cancelar\n      ")])}]},dt=s("VU/8")(ct,ut,!1,null,null,null).exports,lt=void 0,_t=void 0,vt=void 0,mt=void 0,ht=void 0,pt=void 0,ft=void 0,bt=!1,gt=void 0;function Ct(t){var e=vt.getBoundingClientRect().left,s=vt.offsetWidth,r=t.clientX;r<e+100?(pt&&(clearInterval(pt),pt=void 0),!ft&&vt.scrollLeft&&(ft=setInterval(function(){vt.scrollBy({left:-100,behavior:"smooth"}),vt.scrollLeft||yt()},100),vt.style.cursor="w-resize")):e+s-r<100?(ft&&(clearInterval(ft),ft=void 0),!pt&&vt.scrollLeft+vt.offsetWidth<lt.offsetWidth&&(pt=setInterval(function(){vt.scrollBy({left:100,behavior:"smooth"}),vt.scrollLeft+vt.offsetWidth===lt.offsetWidth&&yt()},100),vt.style.cursor="e-resize")):(ft&&(clearInterval(ft),ft=void 0,vt.style.cursor="auto"),pt&&(clearInterval(pt),pt=void 0,vt.style.cursor="auto"))}function yt(){ft&&(clearInterval(ft),ft=void 0,vt.style.cursor="auto"),pt&&(clearInterval(pt),pt=void 0,vt.style.cursor="auto")}function $t(){var t=lt.getBoundingClientRect().top;t>0?mt.style.display="none":(mt.style.display="table",mt.style.marginTop=-t+"px")}function jt(){if(ht){var t=vt.scrollLeft;t?(ht.style.display="table",ht.style.marginLeft=t+"px"):ht.style.display="none"}}function wt(){_t.querySelectorAll("th").forEach(function(t,e){var s=e+1,r=t.offsetWidth+"px";mt.querySelector("th:nth-child("+s+")").style.minWidth=r,mt.querySelector("th:nth-child("+s+")").style.maxWidth=r})}function xt(){var t=document.querySelector("[data-fixed_column]");t&&vt.removeChild(t),(ht=mt.cloneNode(!1)).style.top="10px",ht.style.marginTop="0px",ht.style.borderRight="1px solid darkgray",ht.dataset.fixed_column="fixed_column",ht.style.zIndex=10;var e=lt.querySelector("tbody");if(e){e=e.cloneNode();var s=mt.querySelector("thead").cloneNode(),r=mt.querySelector("tr").cloneNode(),i=mt.querySelector("th").cloneNode(!0),n=lt.querySelector("th");ht.style.width=n.offsetWidth+"px";var a=n.offsetHeight+"px";i.style.height=a,i.style.minHeight=a,i.style.maxHeight=a,r.appendChild(i),s.appendChild(r),ht.appendChild(s).cloneNode(),lt.querySelectorAll("tbody>tr").forEach(function(t,s){var r=s+1,i=t.cloneNode(),n=t.querySelector("td").cloneNode(!0),a=lt.querySelector("tbody>tr:nth-child("+r+")>td").offsetHeight+"px";n.style.height=a,n.style.minHeight=a,n.style.maxHeight=a,i.appendChild(n),e.appendChild(i)}),ht.appendChild(e),vt.appendChild(ht)}}function Et(){if(lt=document.querySelector("table:not([data-fixed_table])"),vt=document.querySelector(".table"),gt&&gt.disconnect(),lt&&vt){var t=vt.querySelector("table[data-fixed_table=fixed_table]");t&&vt.removeChild(t),_t=lt.querySelector("thead"),(mt=document.createElement("table")).style.position="absolute",mt.style.backgroundColor="white",mt.style.display="none",mt.style.top="0px",mt.style.left="0px",mt.style.zIndex=11,mt.dataset.fixed_table="fixed_table",mt.appendChild(_t.cloneNode(!0)),wt(),xt(),lt.style.position="relative",vt.removeEventListener("mouseout",yt),vt.removeEventListener("mousemove",Ct),window.removeEventListener("scroll",$t),window.removeEventListener("resize",$t),vt.removeEventListener("scroll",jt),bt||(vt.addEventListener("mousemove",Ct),vt.addEventListener("mouseout",yt)),window.addEventListener("scroll",$t),window.addEventListener("resize",$t),vt.addEventListener("scroll",jt),vt.appendChild(mt);var e={attributes:!1,childList:!0,subtree:!0};(gt=new MutationObserver(function(){gt.disconnect(),wt(),xt(),gt.observe(vt,e)})).observe(vt,e)}}window.addEventListener("touchstart",function t(){bt=!0,window.removeEventListener("touchstart",t)});var St={name:"SuperTable",created:function(){setTimeout(Et,1e3)}},kt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"table"},[e("table",[this._t("default")],2)])},staticRenderFns:[]};var qt=s("VU/8")(St,kt,!1,function(t){s("9GqY")},"data-v-602e73db",null).exports;r.a.config.productionTip=!1,r.a.component("modal",ot),r.a.component("prompt",dt),r.a.component("super-table",qt);new r.a({el:"#app",router:et,store:f,components:{App:it},template:"<App/>"})},uFkJ:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.87351eeef359e419f78e.js.map